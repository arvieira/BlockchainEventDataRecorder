{"version":3,"file":"vega-functions.min.js","sources":["../src/functions/data.js","../src/functions/encode.js","../src/functions/format.js","../src/constants.js","../src/visitors.js","../src/scales.js","../../../node_modules/d3-array/src/fsum.js","../../../node_modules/d3-geo/src/math.js","../../../node_modules/d3-geo/src/noop.js","../../../node_modules/d3-geo/src/stream.js","../../../node_modules/d3-geo/src/area.js","../../../node_modules/d3-geo/src/bounds.js","../../../node_modules/d3-geo/src/cartesian.js","../../../node_modules/d3-geo/src/centroid.js","../src/functions/geo.js","../src/functions/inscope.js","../src/functions/log.js","../../../node_modules/d3-color/src/define.js","../../../node_modules/d3-color/src/color.js","../../../node_modules/d3-color/src/math.js","../../../node_modules/d3-color/src/lab.js","../src/functions/luminance.js","../src/functions/merge.js","../src/functions/modify.js","../src/functions/pinch.js","../src/functions/pluck.js","../src/functions/sequence.js","../src/functions/scale.js","../src/functions/scale-gradient.js","../src/functions/shape.js","../src/functions/tree.js","../src/functions/window.js","../src/functions/intersect.js","../src/codegen.js","../../../node_modules/d3-array/src/range.js","../src/functions/lasso.js","../src/parser.js"],"sourcesContent":["import {truthy} from 'vega-util';\n\nexport function data(name) {\n  const data = this.context.data[name];\n  return data ? data.values.value : [];\n}\n\nexport function indata(name, field, value) {\n  const index = this.context.data[name]['index:' + field],\n        entry = index ? index.value.get(value) : undefined;\n  return entry ? entry.count : entry;\n}\n\nexport function setdata(name, tuples) {\n  const df = this.context.dataflow,\n        data = this.context.data[name],\n        input = data.input;\n\n  df.pulse(input, df.changeset().remove(truthy).insert(tuples));\n  return 1;\n}\n","export default function(item, name, retval) {\n  if (item) {\n    const df = this.context.dataflow,\n          target = item.mark.source;\n    df.pulse(target, df.changeset().encode(item, name));\n  }\n  return retval !== undefined ? retval : item;\n}\n","const wrap = method => function(value, spec) {\n  const locale = this.context.dataflow.locale();\n  return locale[method](spec)(value);\n};\n\nexport const format = wrap('format');\nexport const timeFormat = wrap('timeFormat');\nexport const utcFormat = wrap('utcFormat');\nexport const timeParse = wrap('timeParse');\nexport const utcParse = wrap('utcParse');\n\nconst dateObj = new Date(2000, 0, 1);\n\nfunction time(month, day, specifier) {\n  if (!Number.isInteger(month) || !Number.isInteger(day)) return '';\n  dateObj.setYear(2000);\n  dateObj.setMonth(month);\n  dateObj.setDate(day);\n  return timeFormat.call(this, dateObj, specifier);\n}\n\nexport function monthFormat(month) {\n  return time.call(this, month, 1, '%B');\n}\n\nexport function monthAbbrevFormat(month) {\n  return time.call(this, month, 1, '%b');\n}\n\nexport function dayFormat(day) {\n  return time.call(this, 0, 2 + day, '%A');\n}\n\nexport function dayAbbrevFormat(day) {\n  return time.call(this, 0, 2 + day, '%a');\n}\n","export const DataPrefix   = ':';\nexport const IndexPrefix  = '@';\nexport const ScalePrefix  = '%';\nexport const SignalPrefix = '$';\n","import {DataPrefix, IndexPrefix, ScalePrefix} from './constants';\nimport {Literal} from 'vega-expression';\nimport {error, hasOwnProperty} from 'vega-util';\n\nexport function dataVisitor(name, args, scope, params) {\n  if (args[0].type !== Literal) {\n    error('First argument to data functions must be a string literal.');\n  }\n\n  const data = args[0].value,\n        dataName = DataPrefix + data;\n\n  if (!hasOwnProperty(dataName, params)) {\n    try {\n      params[dataName] = scope.getData(data).tuplesRef();\n    } catch (err) {\n      // if data set does not exist, there's nothing to track\n    }\n  }\n}\n\nexport function indataVisitor(name, args, scope, params) {\n  if (args[0].type !== Literal) error('First argument to indata must be a string literal.');\n  if (args[1].type !== Literal) error('Second argument to indata must be a string literal.');\n\n  const data = args[0].value,\n        field = args[1].value,\n        indexName = IndexPrefix + field;\n\n  if (!hasOwnProperty(indexName, params)) {\n    params[indexName] = scope.getData(data).indataRef(scope, field);\n  }\n}\n\nexport function scaleVisitor(name, args, scope, params) {\n  if (args[0].type === Literal) {\n    // add scale dependency\n    addScaleDependency(scope, params, args[0].value);\n  } else {\n    // indirect scale lookup; add all scales as parameters\n    for (name in scope.scales) {\n      addScaleDependency(scope, params, name);\n    }\n  }\n}\n\nfunction addScaleDependency(scope, params, name) {\n  const scaleName = ScalePrefix + name;\n  if (!hasOwnProperty(params, scaleName)) {\n    try {\n      params[scaleName] = scope.scaleRef(name);\n    } catch (err) {\n      // TODO: error handling? warning?\n    }\n  }\n}\n","import {ScalePrefix} from './constants';\nimport {scaleVisitor} from './visitors';\nimport {Literal} from 'vega-expression';\nimport {isFunction, isString, stringValue} from 'vega-util';\n\nexport function getScale(name, ctx) {\n  let s;\n  return isFunction(name) ? name\n    : isString(name) ? (s = ctx.scales[name]) && s.value\n    : undefined;\n}\n\nexport function internalScaleFunctions(codegen, fnctx, visitors) {\n  // add helper method to the 'this' expression function context\n  fnctx.__bandwidth = s => s && s.bandwidth ? s.bandwidth() : 0;\n\n  // register AST visitors for internal scale functions\n  visitors._bandwidth = scaleVisitor;\n  visitors._range = scaleVisitor;\n  visitors._scale = scaleVisitor;\n\n  // resolve scale reference directly to the signal hash argument\n  const ref = arg => '_[' + (\n    arg.type === Literal\n      ? stringValue(ScalePrefix + arg.value)\n      : stringValue(ScalePrefix) + '+' + codegen(arg)\n  ) + ']';\n\n  // define and return internal scale function code generators\n  // these internal functions are called by mark encoders\n  return {\n    _bandwidth: args => `this.__bandwidth(${ref(args[0])})`,\n    _range: args => `${ref(args[0])}.range()`,\n    _scale: args => `${ref(args[0])}(${codegen(args[1])})`\n  };\n}\n","// https://github.com/python/cpython/blob/a74eea238f5baba15797e2e8b570d153bc8690a7/Modules/mathmodule.c#L1423\nexport class Adder {\n  constructor() {\n    this._partials = new Float64Array(32);\n    this._n = 0;\n  }\n  add(x) {\n    const p = this._partials;\n    let i = 0;\n    for (let j = 0; j < this._n && j < 32; j++) {\n      const y = p[j],\n        hi = x + y,\n        lo = Math.abs(x) < Math.abs(y) ? x - (hi - y) : y - (hi - x);\n      if (lo) p[i++] = lo;\n      x = hi;\n    }\n    p[i] = x;\n    this._n = i + 1;\n    return this;\n  }\n  valueOf() {\n    const p = this._partials;\n    let n = this._n, x, y, lo, hi = 0;\n    if (n > 0) {\n      hi = p[--n];\n      while (n > 0) {\n        x = hi;\n        y = p[--n];\n        hi = x + y;\n        lo = y - (hi - x);\n        if (lo) break;\n      }\n      if (n > 0 && ((lo < 0 && p[n - 1] < 0) || (lo > 0 && p[n - 1] > 0))) {\n        y = lo * 2;\n        x = hi + y;\n        if (y == x - hi) hi = x;\n      }\n    }\n    return hi;\n  }\n}\n\nexport function fsum(values, valueof) {\n  const adder = new Adder();\n  if (valueof === undefined) {\n    for (let value of values) {\n      if (value = +value) {\n        adder.add(value);\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if (value = +valueof(value, ++index, values)) {\n        adder.add(value);\n      }\n    }\n  }\n  return +adder;\n}\n\nexport function fcumsum(values, valueof) {\n  const adder = new Adder();\n  let index = -1;\n  return Float64Array.from(values, valueof === undefined\n      ? v => adder.add(+v || 0)\n      : v => adder.add(+valueof(v, ++index, values) || 0)\n  );\n}\n","export var epsilon = 1e-6;\nexport var epsilon2 = 1e-12;\nexport var pi = Math.PI;\nexport var halfPi = pi / 2;\nexport var quarterPi = pi / 4;\nexport var tau = pi * 2;\n\nexport var degrees = 180 / pi;\nexport var radians = pi / 180;\n\nexport var abs = Math.abs;\nexport var atan = Math.atan;\nexport var atan2 = Math.atan2;\nexport var cos = Math.cos;\nexport var ceil = Math.ceil;\nexport var exp = Math.exp;\nexport var floor = Math.floor;\nexport var hypot = Math.hypot;\nexport var log = Math.log;\nexport var pow = Math.pow;\nexport var sin = Math.sin;\nexport var sign = Math.sign || function(x) { return x > 0 ? 1 : x < 0 ? -1 : 0; };\nexport var sqrt = Math.sqrt;\nexport var tan = Math.tan;\n\nexport function acos(x) {\n  return x > 1 ? 0 : x < -1 ? pi : Math.acos(x);\n}\n\nexport function asin(x) {\n  return x > 1 ? halfPi : x < -1 ? -halfPi : Math.asin(x);\n}\n\nexport function haversin(x) {\n  return (x = sin(x / 2)) * x;\n}\n","export default function noop() {}\n","function streamGeometry(geometry, stream) {\n  if (geometry && streamGeometryType.hasOwnProperty(geometry.type)) {\n    streamGeometryType[geometry.type](geometry, stream);\n  }\n}\n\nvar streamObjectType = {\n  Feature: function(object, stream) {\n    streamGeometry(object.geometry, stream);\n  },\n  FeatureCollection: function(object, stream) {\n    var features = object.features, i = -1, n = features.length;\n    while (++i < n) streamGeometry(features[i].geometry, stream);\n  }\n};\n\nvar streamGeometryType = {\n  Sphere: function(object, stream) {\n    stream.sphere();\n  },\n  Point: function(object, stream) {\n    object = object.coordinates;\n    stream.point(object[0], object[1], object[2]);\n  },\n  MultiPoint: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) object = coordinates[i], stream.point(object[0], object[1], object[2]);\n  },\n  LineString: function(object, stream) {\n    streamLine(object.coordinates, stream, 0);\n  },\n  MultiLineString: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) streamLine(coordinates[i], stream, 0);\n  },\n  Polygon: function(object, stream) {\n    streamPolygon(object.coordinates, stream);\n  },\n  MultiPolygon: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) streamPolygon(coordinates[i], stream);\n  },\n  GeometryCollection: function(object, stream) {\n    var geometries = object.geometries, i = -1, n = geometries.length;\n    while (++i < n) streamGeometry(geometries[i], stream);\n  }\n};\n\nfunction streamLine(coordinates, stream, closed) {\n  var i = -1, n = coordinates.length - closed, coordinate;\n  stream.lineStart();\n  while (++i < n) coordinate = coordinates[i], stream.point(coordinate[0], coordinate[1], coordinate[2]);\n  stream.lineEnd();\n}\n\nfunction streamPolygon(coordinates, stream) {\n  var i = -1, n = coordinates.length;\n  stream.polygonStart();\n  while (++i < n) streamLine(coordinates[i], stream, 1);\n  stream.polygonEnd();\n}\n\nexport default function(object, stream) {\n  if (object && streamObjectType.hasOwnProperty(object.type)) {\n    streamObjectType[object.type](object, stream);\n  } else {\n    streamGeometry(object, stream);\n  }\n}\n","import {Adder} from \"d3-array\";\nimport {atan2, cos, quarterPi, radians, sin, tau} from \"./math.js\";\nimport noop from \"./noop.js\";\nimport stream from \"./stream.js\";\n\nexport var areaRingSum = new Adder();\n\n// hello?\n\nvar areaSum = new Adder(),\n    lambda00,\n    phi00,\n    lambda0,\n    cosPhi0,\n    sinPhi0;\n\nexport var areaStream = {\n  point: noop,\n  lineStart: noop,\n  lineEnd: noop,\n  polygonStart: function() {\n    areaRingSum = new Adder();\n    areaStream.lineStart = areaRingStart;\n    areaStream.lineEnd = areaRingEnd;\n  },\n  polygonEnd: function() {\n    var areaRing = +areaRingSum;\n    areaSum.add(areaRing < 0 ? tau + areaRing : areaRing);\n    this.lineStart = this.lineEnd = this.point = noop;\n  },\n  sphere: function() {\n    areaSum.add(tau);\n  }\n};\n\nfunction areaRingStart() {\n  areaStream.point = areaPointFirst;\n}\n\nfunction areaRingEnd() {\n  areaPoint(lambda00, phi00);\n}\n\nfunction areaPointFirst(lambda, phi) {\n  areaStream.point = areaPoint;\n  lambda00 = lambda, phi00 = phi;\n  lambda *= radians, phi *= radians;\n  lambda0 = lambda, cosPhi0 = cos(phi = phi / 2 + quarterPi), sinPhi0 = sin(phi);\n}\n\nfunction areaPoint(lambda, phi) {\n  lambda *= radians, phi *= radians;\n  phi = phi / 2 + quarterPi; // half the angular distance from south pole\n\n  // Spherical excess E for a spherical triangle with vertices: south pole,\n  // previous point, current point.  Uses a formula derived from Cagnoli’s\n  // theorem.  See Todhunter, Spherical Trig. (1871), Sec. 103, Eq. (2).\n  var dLambda = lambda - lambda0,\n      sdLambda = dLambda >= 0 ? 1 : -1,\n      adLambda = sdLambda * dLambda,\n      cosPhi = cos(phi),\n      sinPhi = sin(phi),\n      k = sinPhi0 * sinPhi,\n      u = cosPhi0 * cosPhi + k * cos(adLambda),\n      v = k * sdLambda * sin(adLambda);\n  areaRingSum.add(atan2(v, u));\n\n  // Advance the previous points.\n  lambda0 = lambda, cosPhi0 = cosPhi, sinPhi0 = sinPhi;\n}\n\nexport default function(object) {\n  areaSum = new Adder();\n  stream(object, areaStream);\n  return areaSum * 2;\n}\n","import {Adder} from \"d3-array\";\nimport {areaStream, areaRingSum} from \"./area.js\";\nimport {cartesian, cartesianCross, cartesianNormalizeInPlace, spherical} from \"./cartesian.js\";\nimport {abs, degrees, epsilon, radians} from \"./math.js\";\nimport stream from \"./stream.js\";\n\nvar lambda0, phi0, lambda1, phi1, // bounds\n    lambda2, // previous lambda-coordinate\n    lambda00, phi00, // first point\n    p0, // previous 3D point\n    deltaSum,\n    ranges,\n    range;\n\nvar boundsStream = {\n  point: boundsPoint,\n  lineStart: boundsLineStart,\n  lineEnd: boundsLineEnd,\n  polygonStart: function() {\n    boundsStream.point = boundsRingPoint;\n    boundsStream.lineStart = boundsRingStart;\n    boundsStream.lineEnd = boundsRingEnd;\n    deltaSum = new Adder();\n    areaStream.polygonStart();\n  },\n  polygonEnd: function() {\n    areaStream.polygonEnd();\n    boundsStream.point = boundsPoint;\n    boundsStream.lineStart = boundsLineStart;\n    boundsStream.lineEnd = boundsLineEnd;\n    if (areaRingSum < 0) lambda0 = -(lambda1 = 180), phi0 = -(phi1 = 90);\n    else if (deltaSum > epsilon) phi1 = 90;\n    else if (deltaSum < -epsilon) phi0 = -90;\n    range[0] = lambda0, range[1] = lambda1;\n  },\n  sphere: function() {\n    lambda0 = -(lambda1 = 180), phi0 = -(phi1 = 90);\n  }\n};\n\nfunction boundsPoint(lambda, phi) {\n  ranges.push(range = [lambda0 = lambda, lambda1 = lambda]);\n  if (phi < phi0) phi0 = phi;\n  if (phi > phi1) phi1 = phi;\n}\n\nfunction linePoint(lambda, phi) {\n  var p = cartesian([lambda * radians, phi * radians]);\n  if (p0) {\n    var normal = cartesianCross(p0, p),\n        equatorial = [normal[1], -normal[0], 0],\n        inflection = cartesianCross(equatorial, normal);\n    cartesianNormalizeInPlace(inflection);\n    inflection = spherical(inflection);\n    var delta = lambda - lambda2,\n        sign = delta > 0 ? 1 : -1,\n        lambdai = inflection[0] * degrees * sign,\n        phii,\n        antimeridian = abs(delta) > 180;\n    if (antimeridian ^ (sign * lambda2 < lambdai && lambdai < sign * lambda)) {\n      phii = inflection[1] * degrees;\n      if (phii > phi1) phi1 = phii;\n    } else if (lambdai = (lambdai + 360) % 360 - 180, antimeridian ^ (sign * lambda2 < lambdai && lambdai < sign * lambda)) {\n      phii = -inflection[1] * degrees;\n      if (phii < phi0) phi0 = phii;\n    } else {\n      if (phi < phi0) phi0 = phi;\n      if (phi > phi1) phi1 = phi;\n    }\n    if (antimeridian) {\n      if (lambda < lambda2) {\n        if (angle(lambda0, lambda) > angle(lambda0, lambda1)) lambda1 = lambda;\n      } else {\n        if (angle(lambda, lambda1) > angle(lambda0, lambda1)) lambda0 = lambda;\n      }\n    } else {\n      if (lambda1 >= lambda0) {\n        if (lambda < lambda0) lambda0 = lambda;\n        if (lambda > lambda1) lambda1 = lambda;\n      } else {\n        if (lambda > lambda2) {\n          if (angle(lambda0, lambda) > angle(lambda0, lambda1)) lambda1 = lambda;\n        } else {\n          if (angle(lambda, lambda1) > angle(lambda0, lambda1)) lambda0 = lambda;\n        }\n      }\n    }\n  } else {\n    ranges.push(range = [lambda0 = lambda, lambda1 = lambda]);\n  }\n  if (phi < phi0) phi0 = phi;\n  if (phi > phi1) phi1 = phi;\n  p0 = p, lambda2 = lambda;\n}\n\nfunction boundsLineStart() {\n  boundsStream.point = linePoint;\n}\n\nfunction boundsLineEnd() {\n  range[0] = lambda0, range[1] = lambda1;\n  boundsStream.point = boundsPoint;\n  p0 = null;\n}\n\nfunction boundsRingPoint(lambda, phi) {\n  if (p0) {\n    var delta = lambda - lambda2;\n    deltaSum.add(abs(delta) > 180 ? delta + (delta > 0 ? 360 : -360) : delta);\n  } else {\n    lambda00 = lambda, phi00 = phi;\n  }\n  areaStream.point(lambda, phi);\n  linePoint(lambda, phi);\n}\n\nfunction boundsRingStart() {\n  areaStream.lineStart();\n}\n\nfunction boundsRingEnd() {\n  boundsRingPoint(lambda00, phi00);\n  areaStream.lineEnd();\n  if (abs(deltaSum) > epsilon) lambda0 = -(lambda1 = 180);\n  range[0] = lambda0, range[1] = lambda1;\n  p0 = null;\n}\n\n// Finds the left-right distance between two longitudes.\n// This is almost the same as (lambda1 - lambda0 + 360°) % 360°, except that we want\n// the distance between ±180° to be 360°.\nfunction angle(lambda0, lambda1) {\n  return (lambda1 -= lambda0) < 0 ? lambda1 + 360 : lambda1;\n}\n\nfunction rangeCompare(a, b) {\n  return a[0] - b[0];\n}\n\nfunction rangeContains(range, x) {\n  return range[0] <= range[1] ? range[0] <= x && x <= range[1] : x < range[0] || range[1] < x;\n}\n\nexport default function(feature) {\n  var i, n, a, b, merged, deltaMax, delta;\n\n  phi1 = lambda1 = -(lambda0 = phi0 = Infinity);\n  ranges = [];\n  stream(feature, boundsStream);\n\n  // First, sort ranges by their minimum longitudes.\n  if (n = ranges.length) {\n    ranges.sort(rangeCompare);\n\n    // Then, merge any ranges that overlap.\n    for (i = 1, a = ranges[0], merged = [a]; i < n; ++i) {\n      b = ranges[i];\n      if (rangeContains(a, b[0]) || rangeContains(a, b[1])) {\n        if (angle(a[0], b[1]) > angle(a[0], a[1])) a[1] = b[1];\n        if (angle(b[0], a[1]) > angle(a[0], a[1])) a[0] = b[0];\n      } else {\n        merged.push(a = b);\n      }\n    }\n\n    // Finally, find the largest gap between the merged ranges.\n    // The final bounding box will be the inverse of this gap.\n    for (deltaMax = -Infinity, n = merged.length - 1, i = 0, a = merged[n]; i <= n; a = b, ++i) {\n      b = merged[i];\n      if ((delta = angle(a[1], b[0])) > deltaMax) deltaMax = delta, lambda0 = b[0], lambda1 = a[1];\n    }\n  }\n\n  ranges = range = null;\n\n  return lambda0 === Infinity || phi0 === Infinity\n      ? [[NaN, NaN], [NaN, NaN]]\n      : [[lambda0, phi0], [lambda1, phi1]];\n}\n","import {asin, atan2, cos, sin, sqrt} from \"./math.js\";\n\nexport function spherical(cartesian) {\n  return [atan2(cartesian[1], cartesian[0]), asin(cartesian[2])];\n}\n\nexport function cartesian(spherical) {\n  var lambda = spherical[0], phi = spherical[1], cosPhi = cos(phi);\n  return [cosPhi * cos(lambda), cosPhi * sin(lambda), sin(phi)];\n}\n\nexport function cartesianDot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\nexport function cartesianCross(a, b) {\n  return [a[1] * b[2] - a[2] * b[1], a[2] * b[0] - a[0] * b[2], a[0] * b[1] - a[1] * b[0]];\n}\n\n// TODO return a\nexport function cartesianAddInPlace(a, b) {\n  a[0] += b[0], a[1] += b[1], a[2] += b[2];\n}\n\nexport function cartesianScale(vector, k) {\n  return [vector[0] * k, vector[1] * k, vector[2] * k];\n}\n\n// TODO return d\nexport function cartesianNormalizeInPlace(d) {\n  var l = sqrt(d[0] * d[0] + d[1] * d[1] + d[2] * d[2]);\n  d[0] /= l, d[1] /= l, d[2] /= l;\n}\n","import {Adder} from \"d3-array\";\nimport {asin, atan2, cos, degrees, epsilon, epsilon2, hypot, radians, sin, sqrt} from \"./math.js\";\nimport noop from \"./noop.js\";\nimport stream from \"./stream.js\";\n\nvar W0, W1,\n    X0, Y0, Z0,\n    X1, Y1, Z1,\n    X2, Y2, Z2,\n    lambda00, phi00, // first point\n    x0, y0, z0; // previous point\n\nvar centroidStream = {\n  sphere: noop,\n  point: centroidPoint,\n  lineStart: centroidLineStart,\n  lineEnd: centroidLineEnd,\n  polygonStart: function() {\n    centroidStream.lineStart = centroidRingStart;\n    centroidStream.lineEnd = centroidRingEnd;\n  },\n  polygonEnd: function() {\n    centroidStream.lineStart = centroidLineStart;\n    centroidStream.lineEnd = centroidLineEnd;\n  }\n};\n\n// Arithmetic mean of Cartesian vectors.\nfunction centroidPoint(lambda, phi) {\n  lambda *= radians, phi *= radians;\n  var cosPhi = cos(phi);\n  centroidPointCartesian(cosPhi * cos(lambda), cosPhi * sin(lambda), sin(phi));\n}\n\nfunction centroidPointCartesian(x, y, z) {\n  ++W0;\n  X0 += (x - X0) / W0;\n  Y0 += (y - Y0) / W0;\n  Z0 += (z - Z0) / W0;\n}\n\nfunction centroidLineStart() {\n  centroidStream.point = centroidLinePointFirst;\n}\n\nfunction centroidLinePointFirst(lambda, phi) {\n  lambda *= radians, phi *= radians;\n  var cosPhi = cos(phi);\n  x0 = cosPhi * cos(lambda);\n  y0 = cosPhi * sin(lambda);\n  z0 = sin(phi);\n  centroidStream.point = centroidLinePoint;\n  centroidPointCartesian(x0, y0, z0);\n}\n\nfunction centroidLinePoint(lambda, phi) {\n  lambda *= radians, phi *= radians;\n  var cosPhi = cos(phi),\n      x = cosPhi * cos(lambda),\n      y = cosPhi * sin(lambda),\n      z = sin(phi),\n      w = atan2(sqrt((w = y0 * z - z0 * y) * w + (w = z0 * x - x0 * z) * w + (w = x0 * y - y0 * x) * w), x0 * x + y0 * y + z0 * z);\n  W1 += w;\n  X1 += w * (x0 + (x0 = x));\n  Y1 += w * (y0 + (y0 = y));\n  Z1 += w * (z0 + (z0 = z));\n  centroidPointCartesian(x0, y0, z0);\n}\n\nfunction centroidLineEnd() {\n  centroidStream.point = centroidPoint;\n}\n\n// See J. E. Brock, The Inertia Tensor for a Spherical Triangle,\n// J. Applied Mechanics 42, 239 (1975).\nfunction centroidRingStart() {\n  centroidStream.point = centroidRingPointFirst;\n}\n\nfunction centroidRingEnd() {\n  centroidRingPoint(lambda00, phi00);\n  centroidStream.point = centroidPoint;\n}\n\nfunction centroidRingPointFirst(lambda, phi) {\n  lambda00 = lambda, phi00 = phi;\n  lambda *= radians, phi *= radians;\n  centroidStream.point = centroidRingPoint;\n  var cosPhi = cos(phi);\n  x0 = cosPhi * cos(lambda);\n  y0 = cosPhi * sin(lambda);\n  z0 = sin(phi);\n  centroidPointCartesian(x0, y0, z0);\n}\n\nfunction centroidRingPoint(lambda, phi) {\n  lambda *= radians, phi *= radians;\n  var cosPhi = cos(phi),\n      x = cosPhi * cos(lambda),\n      y = cosPhi * sin(lambda),\n      z = sin(phi),\n      cx = y0 * z - z0 * y,\n      cy = z0 * x - x0 * z,\n      cz = x0 * y - y0 * x,\n      m = hypot(cx, cy, cz),\n      w = asin(m), // line weight = angle\n      v = m && -w / m; // area weight multiplier\n  X2.add(v * cx);\n  Y2.add(v * cy);\n  Z2.add(v * cz);\n  W1 += w;\n  X1 += w * (x0 + (x0 = x));\n  Y1 += w * (y0 + (y0 = y));\n  Z1 += w * (z0 + (z0 = z));\n  centroidPointCartesian(x0, y0, z0);\n}\n\nexport default function(object) {\n  W0 = W1 =\n  X0 = Y0 = Z0 =\n  X1 = Y1 = Z1 = 0;\n  X2 = new Adder();\n  Y2 = new Adder();\n  Z2 = new Adder();\n  stream(object, centroidStream);\n\n  var x = +X2,\n      y = +Y2,\n      z = +Z2,\n      m = hypot(x, y, z);\n\n  // If the area-weighted ccentroid is undefined, fall back to length-weighted ccentroid.\n  if (m < epsilon2) {\n    x = X1, y = Y1, z = Z1;\n    // If the feature has zero length, fall back to arithmetic mean of point vectors.\n    if (W1 < epsilon) x = X0, y = Y0, z = Z0;\n    m = hypot(x, y, z);\n    // If the feature still has an undefined ccentroid, then return.\n    if (m < epsilon2) return [NaN, NaN];\n  }\n\n  return [atan2(y, x) * degrees, asin(z / m) * degrees];\n}\n","import {getScale} from '../scales';\nimport {\n  geoArea as area,\n  geoBounds as bounds,\n  geoCentroid as centroid\n} from 'd3-geo';\n\nfunction geoMethod(methodName, globalMethod) {\n  return function(projection, geojson, group) {\n    if (projection) {\n      // projection defined, use it\n      const p = getScale(projection, (group || this).context);\n      return p && p.path[methodName](geojson);\n    } else {\n      // projection undefined, use global method\n      return globalMethod(geojson);\n    }\n  };\n}\n\nexport const geoArea = geoMethod('area', area);\nexport const geoBounds = geoMethod('bounds', bounds);\nexport const geoCentroid = geoMethod('centroid', centroid);\n","export default function(item) {\n  const group = this.context.group;\n  let value = false;\n\n  if (group) while (item) {\n    if (item === group) { value = true; break; }\n    item = item.mark.group;\n  }\n  return value;\n}\n","function log(df, method, args) {\n  try {\n    df[method].apply(df, ['EXPRESSION'].concat([].slice.call(args)));\n  } catch (err) {\n    df.warn(err);\n  }\n  return args[args.length-1];\n}\n\nexport function warn() {\n  return log(this.context.dataflow, 'warn', arguments);\n}\n\nexport function info() {\n  return log(this.context.dataflow, 'info', arguments);\n}\n\nexport function debug() {\n  return log(this.context.dataflow, 'debug', arguments);\n}\n","export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n","import define, {extend} from \"./define.js\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex = /^#([0-9a-f]{3,8})$/,\n    reRgbInteger = new RegExp(\"^rgb\\\\(\" + [reI, reI, reI] + \"\\\\)$\"),\n    reRgbPercent = new RegExp(\"^rgb\\\\(\" + [reP, reP, reP] + \"\\\\)$\"),\n    reRgbaInteger = new RegExp(\"^rgba\\\\(\" + [reI, reI, reI, reN] + \"\\\\)$\"),\n    reRgbaPercent = new RegExp(\"^rgba\\\\(\" + [reP, reP, reP, reN] + \"\\\\)$\"),\n    reHslPercent = new RegExp(\"^hsl\\\\(\" + [reN, reP, reP] + \"\\\\)$\"),\n    reHslaPercent = new RegExp(\"^hsla\\\\(\" + [reN, reP, reP, reN] + \"\\\\)$\");\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy: function(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable: function() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m, l;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000\n      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00\n      : l === 8 ? rgba(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000\n      : l === 4 ? rgba((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000\n      : null) // invalid hex\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb: function() {\n    return this;\n  },\n  displayable: function() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return \"#\" + hex(this.r) + hex(this.g) + hex(this.b);\n}\n\nfunction rgb_formatRgb() {\n  var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n  return (a === 1 ? \"rgb(\" : \"rgba(\")\n      + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.b) || 0))\n      + (a === 1 ? \")\" : \", \" + a + \")\");\n}\n\nfunction hex(value) {\n  value = Math.max(0, Math.min(255, Math.round(value) || 0));\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  displayable: function() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl: function() {\n    var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n    return (a === 1 ? \"hsl(\" : \"hsla(\")\n        + (this.h || 0) + \", \"\n        + (this.s || 0) * 100 + \"%, \"\n        + (this.l || 0) * 100 + \"%\"\n        + (a === 1 ? \")\" : \", \" + a + \")\");\n  }\n}));\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n","export const radians = Math.PI / 180;\nexport const degrees = 180 / Math.PI;\n","import define, {extend} from \"./define.js\";\nimport {Color, rgbConvert, Rgb} from \"./color.js\";\nimport {degrees, radians} from \"./math.js\";\n\n// https://observablehq.com/@mbostock/lab-and-rgb\nconst K = 18,\n    Xn = 0.96422,\n    Yn = 1,\n    Zn = 0.82521,\n    t0 = 4 / 29,\n    t1 = 6 / 29,\n    t2 = 3 * t1 * t1,\n    t3 = t1 * t1 * t1;\n\nfunction labConvert(o) {\n  if (o instanceof Lab) return new Lab(o.l, o.a, o.b, o.opacity);\n  if (o instanceof Hcl) return hcl2lab(o);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = rgb2lrgb(o.r),\n      g = rgb2lrgb(o.g),\n      b = rgb2lrgb(o.b),\n      y = xyz2lab((0.2225045 * r + 0.7168786 * g + 0.0606169 * b) / Yn), x, z;\n  if (r === g && g === b) x = z = y; else {\n    x = xyz2lab((0.4360747 * r + 0.3850649 * g + 0.1430804 * b) / Xn);\n    z = xyz2lab((0.0139322 * r + 0.0971045 * g + 0.7141733 * b) / Zn);\n  }\n  return new Lab(116 * y - 16, 500 * (x - y), 200 * (y - z), o.opacity);\n}\n\nexport function gray(l, opacity) {\n  return new Lab(l, 0, 0, opacity == null ? 1 : opacity);\n}\n\nexport default function lab(l, a, b, opacity) {\n  return arguments.length === 1 ? labConvert(l) : new Lab(l, a, b, opacity == null ? 1 : opacity);\n}\n\nexport function Lab(l, a, b, opacity) {\n  this.l = +l;\n  this.a = +a;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Lab, lab, extend(Color, {\n  brighter: function(k) {\n    return new Lab(this.l + K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  darker: function(k) {\n    return new Lab(this.l - K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  rgb: function() {\n    var y = (this.l + 16) / 116,\n        x = isNaN(this.a) ? y : y + this.a / 500,\n        z = isNaN(this.b) ? y : y - this.b / 200;\n    x = Xn * lab2xyz(x);\n    y = Yn * lab2xyz(y);\n    z = Zn * lab2xyz(z);\n    return new Rgb(\n      lrgb2rgb( 3.1338561 * x - 1.6168667 * y - 0.4906146 * z),\n      lrgb2rgb(-0.9787684 * x + 1.9161415 * y + 0.0334540 * z),\n      lrgb2rgb( 0.0719453 * x - 0.2289914 * y + 1.4052427 * z),\n      this.opacity\n    );\n  }\n}));\n\nfunction xyz2lab(t) {\n  return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0;\n}\n\nfunction lab2xyz(t) {\n  return t > t1 ? t * t * t : t2 * (t - t0);\n}\n\nfunction lrgb2rgb(x) {\n  return 255 * (x <= 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);\n}\n\nfunction rgb2lrgb(x) {\n  return (x /= 255) <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);\n}\n\nfunction hclConvert(o) {\n  if (o instanceof Hcl) return new Hcl(o.h, o.c, o.l, o.opacity);\n  if (!(o instanceof Lab)) o = labConvert(o);\n  if (o.a === 0 && o.b === 0) return new Hcl(NaN, 0 < o.l && o.l < 100 ? 0 : NaN, o.l, o.opacity);\n  var h = Math.atan2(o.b, o.a) * degrees;\n  return new Hcl(h < 0 ? h + 360 : h, Math.sqrt(o.a * o.a + o.b * o.b), o.l, o.opacity);\n}\n\nexport function lch(l, c, h, opacity) {\n  return arguments.length === 1 ? hclConvert(l) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function hcl(h, c, l, opacity) {\n  return arguments.length === 1 ? hclConvert(h) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function Hcl(h, c, l, opacity) {\n  this.h = +h;\n  this.c = +c;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\nfunction hcl2lab(o) {\n  if (isNaN(o.h)) return new Lab(o.l, 0, 0, o.opacity);\n  var h = o.h * radians;\n  return new Lab(o.l, Math.cos(h) * o.c, Math.sin(h) * o.c, o.opacity);\n}\n\ndefine(Hcl, hcl, extend(Color, {\n  brighter: function(k) {\n    return new Hcl(this.h, this.c, this.l + K * (k == null ? 1 : k), this.opacity);\n  },\n  darker: function(k) {\n    return new Hcl(this.h, this.c, this.l - K * (k == null ? 1 : k), this.opacity);\n  },\n  rgb: function() {\n    return hcl2lab(this).rgb();\n  }\n}));\n","import {rgb} from 'd3-color';\n\n// https://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\nfunction channel_luminance_value(channelValue) {\n  const val = channelValue / 255;\n  if (val <= 0.03928) {\n    return val / 12.92;\n  }\n  return Math.pow((val + 0.055) / 1.055, 2.4);\n}\n\nexport function luminance(color) {\n  const c = rgb(color),\n        r = channel_luminance_value(c.r),\n        g = channel_luminance_value(c.g),\n        b = channel_luminance_value(c.b);\n  return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n}\n\n// https://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef\nexport function contrast(color1, color2) {\n  const lum1 = luminance(color1),\n        lum2 = luminance(color2),\n        lumL = Math.max(lum1, lum2),\n        lumD = Math.min(lum1, lum2);\n  return (lumL + 0.05) / (lumD + 0.05);\n}\n","import {extend} from 'vega-util';\n\nexport default function() {\n  const args = [].slice.call(arguments);\n  args.unshift({});\n  return extend(...args);\n}\n","import {isTuple} from 'vega-dataflow';\nimport {isArray, isObject, truthy} from 'vega-util';\n\nfunction equal(a, b) {\n  return a === b || a !== a && b !== b ? true\n    : isArray(a) ? (\n        isArray(b) && a.length === b.length ? equalArray(a, b) : false\n      )\n    : isObject(a) && isObject(b) ? equalObject(a, b)\n    : false;\n}\n\nfunction equalArray(a, b) {\n  for (let i=0, n=a.length; i<n; ++i) {\n    if (!equal(a[i], b[i])) return false;\n  }\n  return true;\n}\n\nfunction equalObject(a, b) {\n  for (const key in a) {\n    if (!equal(a[key], b[key])) return false;\n  }\n  return true;\n}\n\nfunction removePredicate(props) {\n  return _ => equalObject(props, _);\n}\n\nexport default function(name, insert, remove, toggle, modify, values) {\n  const df = this.context.dataflow,\n        data = this.context.data[name],\n        input = data.input,\n        stamp = df.stamp();\n\n  let changes = data.changes,\n      predicate, key;\n\n  if (df._trigger === false || !(input.value.length || insert || toggle)) {\n    // nothing to do!\n    return 0;\n  }\n\n  if (!changes || changes.stamp < stamp) {\n    data.changes = (changes = df.changeset());\n    changes.stamp = stamp;\n    df.runAfter(() => {\n      data.modified = true;\n      df.pulse(input, changes).run();\n    }, true, 1);\n  }\n\n  if (remove) {\n    predicate = remove === true ? truthy\n      : (isArray(remove) || isTuple(remove)) ? remove\n      : removePredicate(remove);\n    changes.remove(predicate);\n  }\n\n  if (insert) {\n    changes.insert(insert);\n  }\n\n  if (toggle) {\n    predicate = removePredicate(toggle);\n    if (input.value.some(predicate)) {\n      changes.remove(predicate);\n    } else {\n      changes.insert(toggle);\n    }\n  }\n\n  if (modify) {\n    for (key in values) {\n      changes.modify(modify, key, values[key]);\n    }\n  }\n\n  return 1;\n}\n","export function pinchDistance(event) {\n  const t = event.touches,\n        dx = t[0].clientX - t[1].clientX,\n        dy = t[0].clientY - t[1].clientY;\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nexport function pinchAngle(event) {\n  const t = event.touches;\n  return Math.atan2(\n    t[0].clientY - t[1].clientY,\n    t[0].clientX - t[1].clientX\n  );\n}\n","import {field, isArray} from 'vega-util';\n\n// memoize accessor functions\nconst accessors = {};\n\nexport default function(data, name) {\n  const accessor = accessors[name] || (accessors[name] = field(name));\n  return isArray(data) ? data.map(accessor) : accessor(data);\n}\n","import {error, isArray, isFunction, isString} from 'vega-util';\n\nfunction array(seq) {\n  return isArray(seq) || ArrayBuffer.isView(seq) ? seq : null;\n}\n\nfunction sequence(seq) {\n  return array(seq) || (isString(seq) ? seq : null);\n}\n\nexport function join(seq, ...args) {\n  return array(seq).join(...args);\n}\n\nexport function indexof(seq, ...args) {\n  return sequence(seq).indexOf(...args);\n}\n\nexport function lastindexof(seq, ...args) {\n  return sequence(seq).lastIndexOf(...args);\n}\n\nexport function slice(seq, ...args) {\n  return sequence(seq).slice(...args);\n}\n\nexport function replace(str, pattern, repl) {\n  if (isFunction(repl)) error('Function argument passed to replace.');\n  return String(str).replace(pattern, repl);\n}\nexport function reverse(seq) {\n  return array(seq).slice().reverse();\n}\n","import {getScale} from '../scales';\nimport {bandSpace} from 'vega-scale';\nimport {isArray} from 'vega-util';\n\nexport function bandspace(count, paddingInner, paddingOuter) {\n  return bandSpace(count || 0, paddingInner || 0, paddingOuter || 0);\n}\n\nexport function bandwidth(name, group) {\n  const s = getScale(name, (group || this).context);\n  return s && s.bandwidth ? s.bandwidth() : 0;\n}\n\nexport function copy(name, group) {\n  const s = getScale(name, (group || this).context);\n  return s ? s.copy() : undefined;\n}\n\nexport function domain(name, group) {\n  const s = getScale(name, (group || this).context);\n  return s ? s.domain() : [];\n}\n\nexport function invert(name, range, group) {\n  const s = getScale(name, (group || this).context);\n  return !s ? undefined\n    : isArray(range) ? (s.invertRange || s.invert)(range)\n    : (s.invert || s.invertExtent)(range);\n}\n\nexport function range(name, group) {\n  const s = getScale(name, (group || this).context);\n  return s && s.range ? s.range() : [];\n}\n\nexport function scale(name, value, group) {\n  const s = getScale(name, (group || this).context);\n  return s ? s(value) : undefined;\n}\n","import {getScale} from '../scales';\nimport {scale as get, scaleFraction} from 'vega-scale';\nimport {Gradient} from 'vega-scenegraph';\nimport {identity, peek} from 'vega-util';\n\nexport default function(scale, p0, p1, count, group) {\n  scale = getScale(scale, (group || this).context);\n\n  const gradient = Gradient(p0, p1);\n\n  let stops = scale.domain(),\n      min = stops[0],\n      max = peek(stops),\n      fraction = identity;\n\n  if (!(max - min)) {\n    // expand scale if domain has zero span, fix #1479\n    scale = (scale.interpolator\n      ? get('sequential')().interpolator(scale.interpolator())\n      : get('linear')().interpolate(scale.interpolate()).range(scale.range())\n    ).domain([min=0, max=1]);\n  } else {\n    fraction = scaleFraction(scale, min, max);\n  }\n\n  if (scale.ticks) {\n    stops = scale.ticks(+count || 15);\n    if (min !== stops[0]) stops.unshift(min);\n    if (max !== peek(stops)) stops.push(max);\n  }\n\n  stops.forEach(_ => gradient.stop(fraction(_), scale(_)));\n\n  return gradient;\n}\n","import {getScale} from '../scales';\nimport {pathParse, pathRender} from 'vega-scenegraph';\n\nexport function geoShape(projection, geojson, group) {\n  const p = getScale(projection, (group || this).context);\n  return function(context) {\n    return p ? p.path.context(context)(geojson) : '';\n  };\n}\n\nexport function pathShape(path) {\n  let p = null;\n  return function(context) {\n    return context\n      ? pathRender(context, (p = p || pathParse(path)))\n      : path;\n  };\n}\n","import {data} from './data';\n\nconst datum = d => d.data;\n\nfunction treeNodes(name, context) {\n  const tree = data.call(context, name);\n  return tree.root && tree.root.lookup || {};\n}\n\nexport function treePath(name, source, target) {\n  const nodes = treeNodes(name, this),\n        s = nodes[source],\n        t = nodes[target];\n  return s && t ? s.path(t).map(datum) : undefined;\n}\n\nexport function treeAncestors(name, node) {\n  const n = treeNodes(name, this)[node];\n  return n ? n.ancestors().map(datum) : undefined;\n}\n","const _window = () => (typeof window !== 'undefined' && window) || null;\n\nexport function screen() {\n  const w = _window();\n  return w ? w.screen : {};\n}\n\nexport function windowSize() {\n  const w = _window();\n  return w\n    ? [w.innerWidth, w.innerHeight]\n    : [undefined, undefined];\n}\n\nexport function containerSize() {\n  const view = this.context.dataflow,\n        el = view.container && view.container();\n  return el\n    ? [el.clientWidth, el.clientHeight]\n    : [undefined, undefined];\n}\n","import {Bounds, intersect} from 'vega-scenegraph';\nimport {array} from 'vega-util';\n\nexport default function(b, opt, group) {\n  if (!b) return [];\n\n  const [u, v] = b,\n        box = new Bounds().set(u[0], u[1], v[0], v[1]),\n        scene = group || this.context.dataflow.scenegraph().root;\n\n  return intersect(scene, box, filter(opt));\n}\n\nfunction filter(opt) {\n  let p = null;\n\n  if (opt) {\n    const types = array(opt.marktype),\n          names = array(opt.markname);\n    p = _ => (!types.length || types.some(t => _.marktype === t))\n          && (!names.length || names.some(s => _.name === s));\n  }\n\n  return p;\n}","import {\n  codegenExpression,\n  constants,\n  functions\n} from 'vega-expression';\n\nimport {\n  isTuple\n} from 'vega-dataflow';\n\nimport {\n  selectionIdTest,\n  selectionResolve,\n  selectionTest,\n  selectionTuples,\n  selectionVisitor\n} from 'vega-selections';\n\nimport {\n  cumulativeLogNormal,\n  cumulativeNormal,\n  cumulativeUniform,\n  densityLogNormal,\n  densityNormal,\n  densityUniform,\n  quantileLogNormal,\n  quantileNormal,\n  quantileUniform,\n  random,\n  sampleLogNormal,\n  sampleNormal,\n  sampleUniform\n} from 'vega-statistics';\n\nimport {\n  dayofyear,\n  timeOffset,\n  timeSequence,\n  timeUnitSpecifier,\n  utcOffset,\n  utcSequence,\n  utcdayofyear,\n  utcweek,\n  week\n} from 'vega-time';\n\nimport {\n  clampRange,\n  extend,\n  extent,\n  flush,\n  inrange,\n  isArray,\n  isBoolean,\n  isDate,\n  isNumber,\n  isObject,\n  isRegExp,\n  isString,\n  lerp,\n  pad,\n  panLinear,\n  panLog,\n  panPow,\n  panSymlog,\n  peek,\n  quarter,\n  span,\n  stringValue,\n  toBoolean,\n  toDate,\n  toNumber,\n  toString,\n  truncate,\n  utcquarter,\n  zoomLinear,\n  zoomLog,\n  zoomPow,\n  zoomSymlog\n} from 'vega-util';\n\nimport {\n  range as sequence\n} from 'd3-array';\n\nimport {\n  hcl,\n  hsl,\n  lab,\n  rgb\n} from 'd3-color';\n\nimport {\n  contrast,\n  luminance\n} from './functions/luminance';\n\nimport {\n  data,\n  indata,\n  setdata\n} from './functions/data';\n\nimport encode from './functions/encode';\n\nimport {\n  dayAbbrevFormat,\n  dayFormat,\n  format,\n  monthAbbrevFormat,\n  monthFormat,\n  timeFormat,\n  timeParse,\n  utcFormat,\n  utcParse\n} from './functions/format';\n\nimport {\n  geoArea,\n  geoBounds,\n  geoCentroid\n} from './functions/geo';\n\nimport inScope from './functions/inscope';\n\nimport intersect from './functions/intersect';\n\nimport {\n  debug,\n  info,\n  warn\n} from './functions/log';\n\nimport merge from './functions/merge';\n\nimport modify from './functions/modify';\n\nimport {\n  pinchAngle,\n  pinchDistance\n} from './functions/pinch';\n\nimport pluck from './functions/pluck';\n\nimport {\n  indexof,\n  join,\n  lastindexof,\n  replace,\n  reverse,\n  slice\n} from './functions/sequence';\n\nimport {\n  intersectLasso,\n  lassoAppend,\n  lassoPath\n} from './functions/lasso';\n\nimport {\n  bandspace,\n  bandwidth,\n  copy,\n  domain,\n  invert,\n  range,\n  scale\n} from './functions/scale';\n\nimport scaleGradient from './functions/scale-gradient';\n\nimport {\n  geoShape,\n  pathShape\n} from './functions/shape';\n\nimport {\n  treeAncestors,\n  treePath\n} from './functions/tree';\n\nimport {\n  containerSize,\n  screen,\n  windowSize\n} from './functions/window';\n\nimport {\n  SignalPrefix\n} from './constants';\n\nimport {\n  internalScaleFunctions\n} from './scales';\n\nimport {\n  dataVisitor,\n  indataVisitor,\n  scaleVisitor\n} from './visitors';\n\n// Expression function context object\nexport const functionContext = {\n  random() { return random(); }, // override default\n  cumulativeNormal,\n  cumulativeLogNormal,\n  cumulativeUniform,\n  densityNormal,\n  densityLogNormal,\n  densityUniform,\n  quantileNormal,\n  quantileLogNormal,\n  quantileUniform,\n  sampleNormal,\n  sampleLogNormal,\n  sampleUniform,\n  isArray,\n  isBoolean,\n  isDate,\n  isDefined(_) { return _ !== undefined; },\n  isNumber,\n  isObject,\n  isRegExp,\n  isString,\n  isTuple,\n  isValid(_) { return _ != null && _ === _; },\n  toBoolean,\n  toDate(_) { return toDate(_); }, // suppress extra arguments\n  toNumber,\n  toString,\n  indexof,\n  join,\n  lastindexof,\n  replace,\n  reverse,\n  slice,\n  flush,\n  lerp,\n  merge,\n  pad,\n  peek,\n  pluck,\n  span,\n  inrange,\n  truncate,\n  rgb,\n  lab,\n  hcl,\n  hsl,\n  luminance,\n  contrast,\n  sequence,\n  format,\n  utcFormat,\n  utcParse,\n  utcOffset,\n  utcSequence,\n  timeFormat,\n  timeParse,\n  timeOffset,\n  timeSequence,\n  timeUnitSpecifier,\n  monthFormat,\n  monthAbbrevFormat,\n  dayFormat,\n  dayAbbrevFormat,\n  quarter,\n  utcquarter,\n  week,\n  utcweek,\n  dayofyear,\n  utcdayofyear,\n  warn,\n  info,\n  debug,\n  extent(_) { return extent(_); }, // suppress extra arguments\n  inScope,\n  intersect,\n  clampRange,\n  pinchDistance,\n  pinchAngle,\n  screen,\n  containerSize,\n  windowSize,\n  bandspace,\n  setdata,\n  pathShape,\n  panLinear,\n  panLog,\n  panPow,\n  panSymlog,\n  zoomLinear,\n  zoomLog,\n  zoomPow,\n  zoomSymlog,\n  encode,\n  modify,\n  lassoAppend,\n  lassoPath,\n  intersectLasso\n};\n\nconst eventFunctions = ['view', 'item', 'group', 'xy', 'x', 'y'], // event functions\n      eventPrefix = 'event.vega.', // event function prefix\n      thisPrefix = 'this.', // function context prefix\n      astVisitors = {}; // AST visitors for dependency analysis\n\n// export code generator parameters\nexport const codegenParams = {\n  forbidden:  ['_'],\n  allowed:    ['datum', 'event', 'item'],\n  fieldvar:   'datum',\n  globalvar:  id => `_[${stringValue(SignalPrefix + id)}]`,\n  functions:  buildFunctions,\n  constants:  constants,\n  visitors:   astVisitors\n};\n\n// export code generator\nexport const codeGenerator = codegenExpression(codegenParams);\n\n// Build expression function registry\nfunction buildFunctions(codegen) {\n  const fn = functions(codegen);\n  eventFunctions.forEach(name => fn[name] = eventPrefix + name);\n  for (const name in functionContext) { fn[name] = thisPrefix + name; }\n  extend(fn, internalScaleFunctions(codegen, functionContext, astVisitors));\n  return fn;\n}\n\n// Register an expression function\nexport function expressionFunction(name, fn, visitor) {\n  if (arguments.length === 1) {\n    return functionContext[name];\n  }\n\n  // register with the functionContext\n  functionContext[name] = fn;\n\n  // if there is an astVisitor register that, too\n  if (visitor) astVisitors[name] = visitor;\n\n  // if the code generator has already been initialized,\n  // we need to also register the function with it\n  if (codeGenerator) codeGenerator.functions[name] = thisPrefix + name;\n  return this;\n}\n\n// register expression functions with ast visitors\nexpressionFunction('bandwidth', bandwidth, scaleVisitor);\nexpressionFunction('copy', copy, scaleVisitor);\nexpressionFunction('domain', domain, scaleVisitor);\nexpressionFunction('range', range, scaleVisitor);\nexpressionFunction('invert', invert, scaleVisitor);\nexpressionFunction('scale', scale, scaleVisitor);\nexpressionFunction('gradient', scaleGradient, scaleVisitor);\nexpressionFunction('geoArea', geoArea, scaleVisitor);\nexpressionFunction('geoBounds', geoBounds, scaleVisitor);\nexpressionFunction('geoCentroid', geoCentroid, scaleVisitor);\nexpressionFunction('geoShape', geoShape, scaleVisitor);\nexpressionFunction('indata', indata, indataVisitor);\nexpressionFunction('data', data, dataVisitor);\nexpressionFunction('treePath', treePath, dataVisitor);\nexpressionFunction('treeAncestors', treeAncestors, dataVisitor);\n\n// register Vega-Lite selection functions\nexpressionFunction('vlSelectionTest', selectionTest, selectionVisitor);\nexpressionFunction('vlSelectionIdTest', selectionIdTest, selectionVisitor);\nexpressionFunction('vlSelectionResolve', selectionResolve, selectionVisitor);\nexpressionFunction('vlSelectionTuples', selectionTuples);\n","export default function range(start, stop, step) {\n  start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;\n\n  var i = -1,\n      n = Math.max(0, Math.ceil((stop - start) / step)) | 0,\n      range = new Array(n);\n\n  while (++i < n) {\n    range[i] = start + i * step;\n  }\n\n  return range;\n}\n","import intersect from './intersect';\nimport { Bounds } from 'vega-scenegraph';\n\n/**\n * Appends a new point to the lasso\n * \n * @param {*} lasso the lasso in pixel space\n * @param {*} x the x coordinate in pixel space\n * @param {*} y the y coordinate in pixel space\n * @param {*} minDist the minimum distance, in pixels, that thenew point needs to be apart from the last point\n * @returns a new array containing the lasso with the new point\n */\nexport function lassoAppend(lasso, x, y, minDist = 5) {\n    const last = lasso[lasso.length - 1];\n\n    // Add point to lasso if distance to last point exceed minDist or its the first point\n    if (last === undefined || Math.sqrt(((last[0] - x) ** 2) + ((last[1] - y) ** 2)) > minDist) {\n        lasso.push([x, y]);\n\n        return [...lasso];\n    }\n\n    return lasso;\n}\n\n\n/**\n * Generates a svg path command which draws a lasso\n * \n * @param {*} lasso the lasso in pixel space in the form [[x,y], [x,y], ...]\n * @returns the svg path command that draws the lasso\n */\nexport function lassoPath(lasso) {\n    return (lasso ?? []).reduce((svg, [x, y], i) => {\n        return svg += i == 0\n            ? `M ${x},${y} `\n            : i === lasso.length - 1\n                ? ' Z'\n                : `L ${x},${y} `;\n    }, '');\n}\n\n\n\n/**\n * Inverts the lasso from pixel space to an array of vega scenegraph tuples\n * \n * @param {*} data the dataset\n * @param {*} pixelLasso the lasso in pixel space, [[x,y], [x,y], ...]\n * @param {*} unit the unit where the lasso is defined\n * \n * @returns an array of vega scenegraph tuples\n */\nexport function intersectLasso(markname, pixelLasso, unit) {\n    const { x, y, mark } = unit;\n\n    const bb = new Bounds().set(\n        Number.MAX_SAFE_INTEGER,\n        Number.MAX_SAFE_INTEGER,\n        Number.MIN_SAFE_INTEGER,\n        Number.MIN_SAFE_INTEGER\n    );\n\n    // Get bounding box around lasso\n    for (const [px, py] of pixelLasso) {\n        if (px < bb.x1) bb.x1 = px;\n        if (px > bb.x2) bb.x2 = px;\n        if (py < bb.y1) bb.y1 = py;\n        if (py > bb.y2) bb.y2 = py;\n    }\n\n    // Translate bb against unit coordinates\n    bb.translate(x, y);\n\n    const intersection = intersect([[bb.x1, bb.y1], [bb.x2, bb.y2]],\n        markname,\n        mark);\n\n    // Check every point against the lasso\n    return intersection.filter(tuple => pointInPolygon(tuple.x, tuple.y, pixelLasso));\n}\n\n\n\n/**\n * Performs a test if a point is inside a polygon based on the idea from\n * https://wrf.ecse.rpi.edu/Research/Short_Notes/pnpoly.html\n * \n * This method will not need the same start/end point since it wraps around the edges of the array\n * \n * @param {*} test a point to test against\n * @param {*} polygon a polygon in the form [[x,y], [x,y], ...]\n * @returns true if the point lies inside the polygon, false otherwise\n */\nfunction pointInPolygon(testx, testy, polygon) {\n    let intersections = 0;\n\n    for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {\n        const [prevX, prevY] = polygon[j];\n        const [x, y] = polygon[i];\n\n        // count intersections\n        if (((y > testy) != (prevY > testy)) && (testx < (prevX - x) * (testy - y) / (prevY - y) + x)) {\n            intersections++;\n        }\n    }\n\n    // point is in polygon if intersection count is odd\n    return intersections & 1;\n}\n","import {codeGenerator, codegenParams} from './codegen';\nimport {SignalPrefix} from './constants';\nimport {CallExpression, parseExpression} from 'vega-expression';\nimport {error, extend, hasOwnProperty, isString, stringValue} from 'vega-util';\n\nexport default function(expr, scope) {\n  const params = {};\n\n  // parse the expression to an abstract syntax tree (ast)\n  let ast;\n  try {\n    expr = isString(expr) ? expr : (stringValue(expr) + '');\n    ast = parseExpression(expr);\n  } catch (err) {\n    error('Expression parse error: ' + expr);\n  }\n\n  // analyze ast function calls for dependencies\n  ast.visit(node => {\n    if (node.type !== CallExpression) return;\n    const name = node.callee.name,\n          visit = codegenParams.visitors[name];\n    if (visit) visit(name, node.arguments, scope, params);\n  });\n\n  // perform code generation\n  const gen = codeGenerator(ast);\n\n  // collect signal dependencies\n  gen.globals.forEach(name => {\n    const signalName = SignalPrefix + name;\n    if (!hasOwnProperty(params, signalName) && scope.getSignal(name)) {\n      params[signalName] = scope.signalRef(name);\n    }\n  });\n\n  // return generated expression code and dependencies\n  return {\n    $expr:   extend({code: gen.code}, scope.options.ast ? {ast} : null),\n    $fields: gen.fields,\n    $params: params\n  };\n}\n"],"names":["data","name","this","context","values","value","indata","field","index","entry","get","undefined","count","setdata","tuples","df","dataflow","input","pulse","changeset","remove","truthy","insert","encode","item","retval","target","mark","source","wrap","method","spec","locale","format","timeFormat","utcFormat","timeParse","utcParse","dateObj","Date","time","month","day","specifier","Number","isInteger","setYear","setMonth","setDate","call","monthFormat","monthAbbrevFormat","dayFormat","dayAbbrevFormat","DataPrefix","ScalePrefix","dataVisitor","args","scope","params","type","Literal","error","dataName","hasOwnProperty","getData","tuplesRef","err","indataVisitor","indexName","indataRef","scaleVisitor","addScaleDependency","scales","scaleName","scaleRef","getScale","ctx","s","isFunction","isString","internalScaleFunctions","codegen","fnctx","visitors","__bandwidth","bandwidth","_bandwidth","_range","_scale","ref","arg","stringValue","Adder","constructor","_partials","Float64Array","_n","add","x","p","i","j","y","hi","lo","Math","abs","valueOf","n","epsilon","pi","PI","halfPi","quarterPi","tau","degrees","radians","atan2","cos","hypot","sin","sqrt","asin","noop","streamGeometry","geometry","stream","streamGeometryType","streamObjectType","Feature","object","FeatureCollection","features","length","Sphere","sphere","Point","coordinates","point","MultiPoint","LineString","streamLine","MultiLineString","Polygon","streamPolygon","MultiPolygon","GeometryCollection","geometries","closed","coordinate","lineStart","lineEnd","polygonStart","polygonEnd","geoStream","lambda00","phi00","lambda0","cosPhi0","sinPhi0","phi0","lambda1","phi1","lambda2","p0","deltaSum","ranges","range","areaRingSum","areaSum","areaStream","areaRingStart","areaRingEnd","areaRing","areaPointFirst","areaPoint","lambda","phi","dLambda","sdLambda","adLambda","cosPhi","sinPhi","k","u","v","cartesianCross","a","b","W0","W1","X0","Y0","Z0","X1","Y1","Z1","X2","Y2","Z2","x0","y0","z0","boundsStream","boundsPoint","boundsLineStart","boundsLineEnd","boundsRingPoint","boundsRingStart","boundsRingEnd","push","linePoint","d","l","spherical","cartesian","normal","inflection","phii","delta","sign","lambdai","antimeridian","angle","rangeCompare","rangeContains","centroidStream","centroidPoint","centroidLineStart","centroidLineEnd","centroidRingStart","centroidRingEnd","centroidPointCartesian","z","centroidLinePointFirst","centroidLinePoint","w","centroidRingPointFirst","centroidRingPoint","cx","cy","cz","m","geoMethod","methodName","globalMethod","projection","geojson","group","path","geoArea","geoBounds","feature","merged","deltaMax","Infinity","sort","NaN","geoCentroid","inScope","log","apply","concat","slice","warn","arguments","info","debug","define","factory","prototype","extend","parent","definition","Object","create","key","Color","darker","brighter","reI","reN","reP","reHex","reRgbInteger","RegExp","reRgbPercent","reRgbaInteger","reRgbaPercent","reHslPercent","reHslaPercent","named","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","color_formatHex","rgb","formatHex","color_formatRgb","formatRgb","color","trim","toLowerCase","exec","parseInt","rgbn","Rgb","rgba","hsla","r","g","rgbConvert","o","opacity","rgb_formatHex","hex","rgb_formatRgb","isNaN","max","min","round","toString","h","Hsl","hslConvert","hsl","hsl2rgb","m1","m2","copy","channels","assign","displayable","formatHsl","pow","Xn","Zn","t0","t1","t2","labConvert","Lab","Hcl","hcl2lab","rgb2lrgb","xyz2lab","lab","t","lab2xyz","lrgb2rgb","hclConvert","c","hcl","channel_luminance_value","channelValue","val","luminance","contrast","color1","color2","lum1","lum2","merge","unshift","equal","isArray","equalArray","isObject","equalObject","removePredicate","props","_","modify","toggle","stamp","predicate","changes","_trigger","runAfter","modified","run","isTuple","some","pinchDistance","event","touches","dx","clientX","dy","clientY","pinchAngle","accessors","pluck","accessor","map","array","seq","ArrayBuffer","isView","sequence","join","_len","Array","_key","indexof","_len2","_key2","indexOf","lastindexof","_len3","_key3","lastIndexOf","_len4","_key4","replace","str","pattern","repl","String","reverse","bandspace","paddingInner","paddingOuter","bandSpace","domain","invert","invertRange","invertExtent","scale","scaleGradient","p1","gradient","Gradient","stops","peek","fraction","identity","scaleFraction","interpolator","interpolate","ticks","forEach","stop","geoShape","pathShape","pathRender","pathParse","datum","treeNodes","tree","root","lookup","treePath","nodes","treeAncestors","node","ancestors","_window","window","screen","windowSize","innerWidth","innerHeight","containerSize","view","el","container","clientWidth","clientHeight","intersect","opt","box","Bounds","set","scene","scenegraph","types","marktype","names","markname","filter","functionContext","random","cumulativeNormal","cumulativeLogNormal","cumulativeUniform","densityNormal","densityLogNormal","densityUniform","quantileNormal","quantileLogNormal","quantileUniform","sampleNormal","sampleLogNormal","sampleUniform","isBoolean","isDate","isDefined","isNumber","isRegExp","isValid","toBoolean","toDate","toNumber","flush","lerp","pad","span","inrange","truncate","start","step","ceil","utcOffset","utcSequence","timeOffset","timeSequence","timeUnitSpecifier","quarter","utcquarter","week","utcweek","dayofyear","utcdayofyear","extent","clampRange","panLinear","panLog","panPow","panSymlog","zoomLinear","zoomLog","zoomPow","zoomSymlog","lassoAppend","lasso","minDist","last","lassoPath","reduce","svg","_ref","intersectLasso","pixelLasso","unit","bb","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","px","py","x1","x2","y1","y2","translate","tuple","testx","testy","polygon","intersections","prevX","prevY","pointInPolygon","eventFunctions","thisPrefix","astVisitors","codegenParams","forbidden","allowed","fieldvar","globalvar","id","functions","fn","constants","codeGenerator","codegenExpression","expressionFunction","visitor","selectionTest","selectionVisitor","selectionIdTest","selectionResolve","selectionTuples","expr","ast","parseExpression","visit","CallExpression","callee","gen","globals","signalName","getSignal","signalRef","$expr","code","options","$fields","fields","$params"],"mappings":"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"}