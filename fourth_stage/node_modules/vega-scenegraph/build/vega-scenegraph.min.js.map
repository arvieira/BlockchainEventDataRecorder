{"version":3,"file":"vega-scenegraph.min.js","sources":["../src/Gradient.js","../../../node_modules/d3-path/src/path.js","../../../node_modules/d3-shape/src/constant.js","../../../node_modules/d3-shape/src/math.js","../../../node_modules/d3-shape/src/arc.js","../../../node_modules/d3-shape/src/array.js","../../../node_modules/d3-shape/src/curve/linear.js","../../../node_modules/d3-shape/src/point.js","../../../node_modules/d3-shape/src/line.js","../../../node_modules/d3-shape/src/area.js","../../../node_modules/d3-shape/src/symbol/circle.js","../../../node_modules/d3-shape/src/noop.js","../../../node_modules/d3-shape/src/curve/basis.js","../../../node_modules/d3-shape/src/curve/basisClosed.js","../../../node_modules/d3-shape/src/curve/basisOpen.js","../../../node_modules/d3-shape/src/curve/bundle.js","../../../node_modules/d3-shape/src/curve/cardinal.js","../../../node_modules/d3-shape/src/curve/cardinalClosed.js","../../../node_modules/d3-shape/src/curve/cardinalOpen.js","../../../node_modules/d3-shape/src/curve/catmullRom.js","../../../node_modules/d3-shape/src/curve/catmullRomClosed.js","../../../node_modules/d3-shape/src/curve/catmullRomOpen.js","../../../node_modules/d3-shape/src/curve/linearClosed.js","../../../node_modules/d3-shape/src/curve/monotone.js","../../../node_modules/d3-shape/src/curve/natural.js","../../../node_modules/d3-shape/src/curve/step.js","../src/path/curves.js","../src/path/parse.js","../src/util/constants.js","../src/path/arc.js","../src/path/render.js","../src/path/symbols.js","../src/path/rectangle.js","../src/path/trail.js","../src/path/shapes.js","../../../node_modules/d3-shape/src/symbol.js","../src/util/svg/clip.js","../src/Bounds.js","../src/Item.js","../src/GroupItem.js","../src/ResourceLoader.js","../src/bound/boundStroke.js","../src/bound/boundContext.js","../src/util/canvas/context.js","../src/util/intersect.js","../src/util/canvas/blend.js","../src/util/value.js","../src/util/canvas/gradient.js","../src/util/canvas/color.js","../src/util/canvas/fill.js","../src/util/canvas/stroke.js","../src/util/visit.js","../src/util/canvas/draw.js","../src/util/canvas/pick.js","../src/util/svg/transform.js","../src/marks/markItemPath.js","../src/marks/arc.js","../src/marks/markMultiItemPath.js","../src/marks/area.js","../src/util/pickPath.js","../src/util/canvas/clip.js","../src/marks/group.js","../src/util/svg/metadata.js","../src/marks/image.js","../src/marks/line.js","../src/marks/path.js","../src/marks/rect.js","../src/marks/rule.js","../src/marks/shape.js","../src/marks/symbol.js","../src/util/text.js","../src/marks/text.js","../src/marks/trail.js","../src/marks/index.js","../src/bound/boundItem.js","../src/bound/boundMark.js","../src/util/serialize.js","../src/Scenegraph.js","../src/util/dom.js","../src/util/point.js","../src/Handler.js","../src/Renderer.js","../src/util/resolveItem.js","../src/util/events.js","../src/CanvasHandler.js","../src/util/canvas/resize.js","../src/CanvasRenderer.js","../src/SVGHandler.js","../src/util/aria.js","../src/util/markup.js","../src/util/svg/styles.js","../src/SVGRenderer.js","../src/SVGStringRenderer.js","../src/modules.js","../src/intersect.js","../src/bound/boundClip.js","../src/util/equal.js","../index.js"],"sourcesContent":["let gradient_id = 0;\n\nexport function resetSVGGradientId() {\n  gradient_id = 0;\n}\n\nexport const patternPrefix = 'p_';\n\nexport function isGradient(value) {\n  return value && value.gradient;\n}\n\nexport function gradientRef(g, defs, base) {\n  const type = g.gradient;\n\n  let id = g.id,\n      prefix = type === 'radial' ? patternPrefix : '';\n\n  // check id, assign default values as needed\n  if (!id) {\n    id = g.id = 'gradient_' + (gradient_id++);\n    if (type === 'radial') {\n      g.x1 = get(g.x1, 0.5);\n      g.y1 = get(g.y1, 0.5);\n      g.r1 = get(g.r1, 0);\n      g.x2 = get(g.x2, 0.5);\n      g.y2 = get(g.y2, 0.5);\n      g.r2 = get(g.r2, 0.5);\n      prefix = patternPrefix;\n    } else {\n      g.x1 = get(g.x1, 0);\n      g.y1 = get(g.y1, 0);\n      g.x2 = get(g.x2, 1);\n      g.y2 = get(g.y2, 0);\n    }\n  }\n\n  // register definition\n  defs[id] = g;\n\n  // return url reference\n  return 'url(' + (base || '') + '#' + prefix + id + ')';\n}\n\nfunction get(val, def) {\n  return val != null ? val : def;\n}\n\nexport default function(p0, p1) {\n  var stops = [], gradient;\n  return gradient = {\n    gradient: 'linear',\n    x1: p0 ? p0[0] : 0,\n    y1: p0 ? p0[1] : 0,\n    x2: p1 ? p1[0] : 1,\n    y2: p1 ? p1[1] : 0,\n    stops: stops,\n    stop: function(offset, color) {\n      stops.push({offset: offset, color: color});\n      return gradient;\n    }\n  };\n}\n","const pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction Path() {\n  this._x0 = this._y0 = // start of current subpath\n  this._x1 = this._y1 = null; // end of current subpath\n  this._ = \"\";\n}\n\nfunction path() {\n  return new Path;\n}\n\nPath.prototype = path.prototype = {\n  constructor: Path,\n  moveTo: function(x, y) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y);\n  },\n  closePath: function() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._ += \"Z\";\n    }\n  },\n  lineTo: function(x, y) {\n    this._ += \"L\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  quadraticCurveTo: function(x1, y1, x, y) {\n    this._ += \"Q\" + (+x1) + \",\" + (+y1) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) {\n    this._ += \"C\" + (+x1) + \",\" + (+y1) + \",\" + (+x2) + \",\" + (+y2) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  arcTo: function(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n    var x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._ += \"M\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon));\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._ += \"L\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      var x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._ += \"L\" + (x1 + t01 * x01) + \",\" + (y1 + t01 * y01);\n      }\n\n      this._ += \"A\" + r + \",\" + r + \",0,0,\" + (+(y01 * x20 > x01 * y20)) + \",\" + (this._x1 = x1 + t21 * x21) + \",\" + (this._y1 = y1 + t21 * y21);\n    }\n  },\n  arc: function(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r, ccw = !!ccw;\n    var dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._ += \"M\" + x0 + \",\" + y0;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._ += \"L\" + x0 + \",\" + y0;\n    }\n\n    // Is this arc empty? Weâ€™re done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (x - dx) + \",\" + (y - dy) + \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (this._x1 = x0) + \",\" + (this._y1 = y0);\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,\" + (+(da >= pi)) + \",\" + cw + \",\" + (this._x1 = x + r * Math.cos(a1)) + \",\" + (this._y1 = y + r * Math.sin(a1));\n    }\n  },\n  rect: function(x, y, w, h) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y) + \"h\" + (+w) + \"v\" + (+h) + \"h\" + (-w) + \"Z\";\n  },\n  toString: function() {\n    return this._;\n  }\n};\n\nexport default path;\n","export default function(x) {\n  return function constant() {\n    return x;\n  };\n}\n","export const abs = Math.abs;\nexport const atan2 = Math.atan2;\nexport const cos = Math.cos;\nexport const max = Math.max;\nexport const min = Math.min;\nexport const sin = Math.sin;\nexport const sqrt = Math.sqrt;\n\nexport const epsilon = 1e-12;\nexport const pi = Math.PI;\nexport const halfPi = pi / 2;\nexport const tau = 2 * pi;\n\nexport function acos(x) {\n  return x > 1 ? 0 : x < -1 ? pi : Math.acos(x);\n}\n\nexport function asin(x) {\n  return x >= 1 ? halfPi : x <= -1 ? -halfPi : Math.asin(x);\n}\n","import {path} from \"d3-path\";\nimport constant from \"./constant.js\";\nimport {abs, acos, asin, atan2, cos, epsilon, halfPi, max, min, pi, sin, sqrt, tau} from \"./math.js\";\n\nfunction arcInnerRadius(d) {\n  return d.innerRadius;\n}\n\nfunction arcOuterRadius(d) {\n  return d.outerRadius;\n}\n\nfunction arcStartAngle(d) {\n  return d.startAngle;\n}\n\nfunction arcEndAngle(d) {\n  return d.endAngle;\n}\n\nfunction arcPadAngle(d) {\n  return d && d.padAngle; // Note: optional!\n}\n\nfunction intersect(x0, y0, x1, y1, x2, y2, x3, y3) {\n  var x10 = x1 - x0, y10 = y1 - y0,\n      x32 = x3 - x2, y32 = y3 - y2,\n      t = y32 * x10 - x32 * y10;\n  if (t * t < epsilon) return;\n  t = (x32 * (y0 - y2) - y32 * (x0 - x2)) / t;\n  return [x0 + t * x10, y0 + t * y10];\n}\n\n// Compute perpendicular offset line of length rc.\n// http://mathworld.wolfram.com/Circle-LineIntersection.html\nfunction cornerTangents(x0, y0, x1, y1, r1, rc, cw) {\n  var x01 = x0 - x1,\n      y01 = y0 - y1,\n      lo = (cw ? rc : -rc) / sqrt(x01 * x01 + y01 * y01),\n      ox = lo * y01,\n      oy = -lo * x01,\n      x11 = x0 + ox,\n      y11 = y0 + oy,\n      x10 = x1 + ox,\n      y10 = y1 + oy,\n      x00 = (x11 + x10) / 2,\n      y00 = (y11 + y10) / 2,\n      dx = x10 - x11,\n      dy = y10 - y11,\n      d2 = dx * dx + dy * dy,\n      r = r1 - rc,\n      D = x11 * y10 - x10 * y11,\n      d = (dy < 0 ? -1 : 1) * sqrt(max(0, r * r * d2 - D * D)),\n      cx0 = (D * dy - dx * d) / d2,\n      cy0 = (-D * dx - dy * d) / d2,\n      cx1 = (D * dy + dx * d) / d2,\n      cy1 = (-D * dx + dy * d) / d2,\n      dx0 = cx0 - x00,\n      dy0 = cy0 - y00,\n      dx1 = cx1 - x00,\n      dy1 = cy1 - y00;\n\n  // Pick the closer of the two intersection points.\n  // TODO Is there a faster way to determine which intersection to use?\n  if (dx0 * dx0 + dy0 * dy0 > dx1 * dx1 + dy1 * dy1) cx0 = cx1, cy0 = cy1;\n\n  return {\n    cx: cx0,\n    cy: cy0,\n    x01: -ox,\n    y01: -oy,\n    x11: cx0 * (r1 / r - 1),\n    y11: cy0 * (r1 / r - 1)\n  };\n}\n\nexport default function() {\n  var innerRadius = arcInnerRadius,\n      outerRadius = arcOuterRadius,\n      cornerRadius = constant(0),\n      padRadius = null,\n      startAngle = arcStartAngle,\n      endAngle = arcEndAngle,\n      padAngle = arcPadAngle,\n      context = null;\n\n  function arc() {\n    var buffer,\n        r,\n        r0 = +innerRadius.apply(this, arguments),\n        r1 = +outerRadius.apply(this, arguments),\n        a0 = startAngle.apply(this, arguments) - halfPi,\n        a1 = endAngle.apply(this, arguments) - halfPi,\n        da = abs(a1 - a0),\n        cw = a1 > a0;\n\n    if (!context) context = buffer = path();\n\n    // Ensure that the outer radius is always larger than the inner radius.\n    if (r1 < r0) r = r1, r1 = r0, r0 = r;\n\n    // Is it a point?\n    if (!(r1 > epsilon)) context.moveTo(0, 0);\n\n    // Or is it a circle or annulus?\n    else if (da > tau - epsilon) {\n      context.moveTo(r1 * cos(a0), r1 * sin(a0));\n      context.arc(0, 0, r1, a0, a1, !cw);\n      if (r0 > epsilon) {\n        context.moveTo(r0 * cos(a1), r0 * sin(a1));\n        context.arc(0, 0, r0, a1, a0, cw);\n      }\n    }\n\n    // Or is it a circular or annular sector?\n    else {\n      var a01 = a0,\n          a11 = a1,\n          a00 = a0,\n          a10 = a1,\n          da0 = da,\n          da1 = da,\n          ap = padAngle.apply(this, arguments) / 2,\n          rp = (ap > epsilon) && (padRadius ? +padRadius.apply(this, arguments) : sqrt(r0 * r0 + r1 * r1)),\n          rc = min(abs(r1 - r0) / 2, +cornerRadius.apply(this, arguments)),\n          rc0 = rc,\n          rc1 = rc,\n          t0,\n          t1;\n\n      // Apply padding? Note that since r1 â‰¥ r0, da1 â‰¥ da0.\n      if (rp > epsilon) {\n        var p0 = asin(rp / r0 * sin(ap)),\n            p1 = asin(rp / r1 * sin(ap));\n        if ((da0 -= p0 * 2) > epsilon) p0 *= (cw ? 1 : -1), a00 += p0, a10 -= p0;\n        else da0 = 0, a00 = a10 = (a0 + a1) / 2;\n        if ((da1 -= p1 * 2) > epsilon) p1 *= (cw ? 1 : -1), a01 += p1, a11 -= p1;\n        else da1 = 0, a01 = a11 = (a0 + a1) / 2;\n      }\n\n      var x01 = r1 * cos(a01),\n          y01 = r1 * sin(a01),\n          x10 = r0 * cos(a10),\n          y10 = r0 * sin(a10);\n\n      // Apply rounded corners?\n      if (rc > epsilon) {\n        var x11 = r1 * cos(a11),\n            y11 = r1 * sin(a11),\n            x00 = r0 * cos(a00),\n            y00 = r0 * sin(a00),\n            oc;\n\n        // Restrict the corner radius according to the sector angle.\n        if (da < pi && (oc = intersect(x01, y01, x00, y00, x11, y11, x10, y10))) {\n          var ax = x01 - oc[0],\n              ay = y01 - oc[1],\n              bx = x11 - oc[0],\n              by = y11 - oc[1],\n              kc = 1 / sin(acos((ax * bx + ay * by) / (sqrt(ax * ax + ay * ay) * sqrt(bx * bx + by * by))) / 2),\n              lc = sqrt(oc[0] * oc[0] + oc[1] * oc[1]);\n          rc0 = min(rc, (r0 - lc) / (kc - 1));\n          rc1 = min(rc, (r1 - lc) / (kc + 1));\n        }\n      }\n\n      // Is the sector collapsed to a line?\n      if (!(da1 > epsilon)) context.moveTo(x01, y01);\n\n      // Does the sectorâ€™s outer ring have rounded corners?\n      else if (rc1 > epsilon) {\n        t0 = cornerTangents(x00, y00, x01, y01, r1, rc1, cw);\n        t1 = cornerTangents(x11, y11, x10, y10, r1, rc1, cw);\n\n        context.moveTo(t0.cx + t0.x01, t0.cy + t0.y01);\n\n        // Have the corners merged?\n        if (rc1 < rc) context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw);\n\n        // Otherwise, draw the two corners and the ring.\n        else {\n          context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);\n          context.arc(0, 0, r1, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), !cw);\n          context.arc(t1.cx, t1.cy, rc1, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);\n        }\n      }\n\n      // Or is the outer ring just a circular arc?\n      else context.moveTo(x01, y01), context.arc(0, 0, r1, a01, a11, !cw);\n\n      // Is there no inner ring, and itâ€™s a circular sector?\n      // Or perhaps itâ€™s an annular sector collapsed due to padding?\n      if (!(r0 > epsilon) || !(da0 > epsilon)) context.lineTo(x10, y10);\n\n      // Does the sectorâ€™s inner ring (or point) have rounded corners?\n      else if (rc0 > epsilon) {\n        t0 = cornerTangents(x10, y10, x11, y11, r0, -rc0, cw);\n        t1 = cornerTangents(x01, y01, x00, y00, r0, -rc0, cw);\n\n        context.lineTo(t0.cx + t0.x01, t0.cy + t0.y01);\n\n        // Have the corners merged?\n        if (rc0 < rc) context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw);\n\n        // Otherwise, draw the two corners and the ring.\n        else {\n          context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);\n          context.arc(0, 0, r0, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), cw);\n          context.arc(t1.cx, t1.cy, rc0, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);\n        }\n      }\n\n      // Or is the inner ring just a circular arc?\n      else context.arc(0, 0, r0, a10, a00, cw);\n    }\n\n    context.closePath();\n\n    if (buffer) return context = null, buffer + \"\" || null;\n  }\n\n  arc.centroid = function() {\n    var r = (+innerRadius.apply(this, arguments) + +outerRadius.apply(this, arguments)) / 2,\n        a = (+startAngle.apply(this, arguments) + +endAngle.apply(this, arguments)) / 2 - pi / 2;\n    return [cos(a) * r, sin(a) * r];\n  };\n\n  arc.innerRadius = function(_) {\n    return arguments.length ? (innerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : innerRadius;\n  };\n\n  arc.outerRadius = function(_) {\n    return arguments.length ? (outerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : outerRadius;\n  };\n\n  arc.cornerRadius = function(_) {\n    return arguments.length ? (cornerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : cornerRadius;\n  };\n\n  arc.padRadius = function(_) {\n    return arguments.length ? (padRadius = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), arc) : padRadius;\n  };\n\n  arc.startAngle = function(_) {\n    return arguments.length ? (startAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : startAngle;\n  };\n\n  arc.endAngle = function(_) {\n    return arguments.length ? (endAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : endAngle;\n  };\n\n  arc.padAngle = function(_) {\n    return arguments.length ? (padAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : padAngle;\n  };\n\n  arc.context = function(_) {\n    return arguments.length ? ((context = _ == null ? null : _), arc) : context;\n  };\n\n  return arc;\n}\n","export var slice = Array.prototype.slice;\n\nexport default function(x) {\n  return typeof x === \"object\" && \"length\" in x\n    ? x // Array, TypedArray, NodeList, array-like\n    : Array.from(x); // Map, Set, iterable, string, or anything else\n}\n","function Linear(context) {\n  this._context = context;\n}\n\nLinear.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // falls through\n      default: this._context.lineTo(x, y); break;\n    }\n  }\n};\n\nexport default function(context) {\n  return new Linear(context);\n}\n","export function x(p) {\n  return p[0];\n}\n\nexport function y(p) {\n  return p[1];\n}\n","import {path} from \"d3-path\";\nimport array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x, y) {\n  var defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null;\n\n  x = typeof x === \"function\" ? x : (x === undefined) ? pointX : constant(x);\n  y = typeof y === \"function\" ? y : (y === undefined) ? pointY : constant(y);\n\n  function line(data) {\n    var i,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) output.lineStart();\n        else output.lineEnd();\n      }\n      if (defined0) output.point(+x(d, i, data), +y(d, i, data));\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  line.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), line) : x;\n  };\n\n  line.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), line) : y;\n  };\n\n  line.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), line) : defined;\n  };\n\n  line.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;\n  };\n\n  line.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;\n  };\n\n  return line;\n}\n","import {path} from \"d3-path\";\nimport array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport line from \"./line.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x0, y0, y1) {\n  var x1 = null,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null;\n\n  x0 = typeof x0 === \"function\" ? x0 : (x0 === undefined) ? pointX : constant(+x0);\n  y0 = typeof y0 === \"function\" ? y0 : (y0 === undefined) ? constant(0) : constant(+y0);\n  y1 = typeof y1 === \"function\" ? y1 : (y1 === undefined) ? pointY : constant(+y1);\n\n  function area(data) {\n    var i,\n        j,\n        k,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer,\n        x0z = new Array(n),\n        y0z = new Array(n);\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) {\n          j = i;\n          output.areaStart();\n          output.lineStart();\n        } else {\n          output.lineEnd();\n          output.lineStart();\n          for (k = i - 1; k >= j; --k) {\n            output.point(x0z[k], y0z[k]);\n          }\n          output.lineEnd();\n          output.areaEnd();\n        }\n      }\n      if (defined0) {\n        x0z[i] = +x0(d, i, data), y0z[i] = +y0(d, i, data);\n        output.point(x1 ? +x1(d, i, data) : x0z[i], y1 ? +y1(d, i, data) : y0z[i]);\n      }\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  function arealine() {\n    return line().defined(defined).curve(curve).context(context);\n  }\n\n  area.x = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), x1 = null, area) : x0;\n  };\n\n  area.x0 = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), area) : x0;\n  };\n\n  area.x1 = function(_) {\n    return arguments.length ? (x1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : x1;\n  };\n\n  area.y = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), y1 = null, area) : y0;\n  };\n\n  area.y0 = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), area) : y0;\n  };\n\n  area.y1 = function(_) {\n    return arguments.length ? (y1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : y1;\n  };\n\n  area.lineX0 =\n  area.lineY0 = function() {\n    return arealine().x(x0).y(y0);\n  };\n\n  area.lineY1 = function() {\n    return arealine().x(x0).y(y1);\n  };\n\n  area.lineX1 = function() {\n    return arealine().x(x1).y(y0);\n  };\n\n  area.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), area) : defined;\n  };\n\n  area.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), area) : curve;\n  };\n\n  area.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), area) : context;\n  };\n\n  return area;\n}\n","import {pi, sqrt, tau} from \"../math.js\";\n\nexport default {\n  draw(context, size) {\n    const r = sqrt(size / pi);\n    context.moveTo(r, 0);\n    context.arc(0, 0, r, 0, tau);\n  }\n};\n","export default function() {}\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    (2 * that._x0 + that._x1) / 3,\n    (2 * that._y0 + that._y1) / 3,\n    (that._x0 + 2 * that._x1) / 3,\n    (that._y0 + 2 * that._y1) / 3,\n    (that._x0 + 4 * that._x1 + x) / 6,\n    (that._y0 + 4 * that._y1 + y) / 6\n  );\n}\n\nexport function Basis(context) {\n  this._context = context;\n}\n\nBasis.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 3: point(this, this._x1, this._y1); // falls through\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._context.lineTo((5 * this._x0 + this._x1) / 6, (5 * this._y0 + this._y1) / 6); // falls through\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new Basis(context);\n}\n","import noop from \"../noop.js\";\nimport {point} from \"./basis.js\";\n\nfunction BasisClosed(context) {\n  this._context = context;\n}\n\nBasisClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 =\n    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 1: {\n        this._context.moveTo(this._x2, this._y2);\n        this._context.closePath();\n        break;\n      }\n      case 2: {\n        this._context.moveTo((this._x2 + 2 * this._x3) / 3, (this._y2 + 2 * this._y3) / 3);\n        this._context.lineTo((this._x3 + 2 * this._x2) / 3, (this._y3 + 2 * this._y2) / 3);\n        this._context.closePath();\n        break;\n      }\n      case 3: {\n        this.point(this._x2, this._y2);\n        this.point(this._x3, this._y3);\n        this.point(this._x4, this._y4);\n        break;\n      }\n    }\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._x2 = x, this._y2 = y; break;\n      case 1: this._point = 2; this._x3 = x, this._y3 = y; break;\n      case 2: this._point = 3; this._x4 = x, this._y4 = y; this._context.moveTo((this._x0 + 4 * this._x1 + x) / 6, (this._y0 + 4 * this._y1 + y) / 6); break;\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new BasisClosed(context);\n}\n","import {point} from \"./basis.js\";\n\nfunction BasisOpen(context) {\n  this._context = context;\n}\n\nBasisOpen.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; var x0 = (this._x0 + 4 * this._x1 + x) / 6, y0 = (this._y0 + 4 * this._y1 + y) / 6; this._line ? this._context.lineTo(x0, y0) : this._context.moveTo(x0, y0); break;\n      case 3: this._point = 4; // falls through\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new BasisOpen(context);\n}\n","import {Basis} from \"./basis.js\";\n\nfunction Bundle(context, beta) {\n  this._basis = new Basis(context);\n  this._beta = beta;\n}\n\nBundle.prototype = {\n  lineStart: function() {\n    this._x = [];\n    this._y = [];\n    this._basis.lineStart();\n  },\n  lineEnd: function() {\n    var x = this._x,\n        y = this._y,\n        j = x.length - 1;\n\n    if (j > 0) {\n      var x0 = x[0],\n          y0 = y[0],\n          dx = x[j] - x0,\n          dy = y[j] - y0,\n          i = -1,\n          t;\n\n      while (++i <= j) {\n        t = i / j;\n        this._basis.point(\n          this._beta * x[i] + (1 - this._beta) * (x0 + t * dx),\n          this._beta * y[i] + (1 - this._beta) * (y0 + t * dy)\n        );\n      }\n    }\n\n    this._x = this._y = null;\n    this._basis.lineEnd();\n  },\n  point: function(x, y) {\n    this._x.push(+x);\n    this._y.push(+y);\n  }\n};\n\nexport default (function custom(beta) {\n\n  function bundle(context) {\n    return beta === 1 ? new Basis(context) : new Bundle(context, beta);\n  }\n\n  bundle.beta = function(beta) {\n    return custom(+beta);\n  };\n\n  return bundle;\n})(0.85);\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    that._x1 + that._k * (that._x2 - that._x0),\n    that._y1 + that._k * (that._y2 - that._y0),\n    that._x2 + that._k * (that._x1 - x),\n    that._y2 + that._k * (that._y1 - y),\n    that._x2,\n    that._y2\n  );\n}\n\nexport function Cardinal(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinal.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x2, this._y2); break;\n      case 3: point(this, this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; this._x1 = x, this._y1 = y; break;\n      case 2: this._point = 3; // falls through\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new Cardinal(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","import noop from \"../noop.js\";\nimport {point} from \"./cardinal.js\";\n\nexport function CardinalClosed(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinalClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 =\n    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 1: {\n        this._context.moveTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 2: {\n        this._context.lineTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 3: {\n        this.point(this._x3, this._y3);\n        this.point(this._x4, this._y4);\n        this.point(this._x5, this._y5);\n        break;\n      }\n    }\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._x3 = x, this._y3 = y; break;\n      case 1: this._point = 2; this._context.moveTo(this._x4 = x, this._y4 = y); break;\n      case 2: this._point = 3; this._x5 = x, this._y5 = y; break;\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new CardinalClosed(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","import {point} from \"./cardinal.js\";\n\nexport function CardinalOpen(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinalOpen.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2); break;\n      case 3: this._point = 4; // falls through\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new CardinalOpen(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","import {epsilon} from \"../math.js\";\nimport {Cardinal} from \"./cardinal.js\";\n\nexport function point(that, x, y) {\n  var x1 = that._x1,\n      y1 = that._y1,\n      x2 = that._x2,\n      y2 = that._y2;\n\n  if (that._l01_a > epsilon) {\n    var a = 2 * that._l01_2a + 3 * that._l01_a * that._l12_a + that._l12_2a,\n        n = 3 * that._l01_a * (that._l01_a + that._l12_a);\n    x1 = (x1 * a - that._x0 * that._l12_2a + that._x2 * that._l01_2a) / n;\n    y1 = (y1 * a - that._y0 * that._l12_2a + that._y2 * that._l01_2a) / n;\n  }\n\n  if (that._l23_a > epsilon) {\n    var b = 2 * that._l23_2a + 3 * that._l23_a * that._l12_a + that._l12_2a,\n        m = 3 * that._l23_a * (that._l23_a + that._l12_a);\n    x2 = (x2 * b + that._x1 * that._l23_2a - x * that._l12_2a) / m;\n    y2 = (y2 * b + that._y1 * that._l23_2a - y * that._l12_2a) / m;\n  }\n\n  that._context.bezierCurveTo(x1, y1, x2, y2, that._x2, that._y2);\n}\n\nfunction CatmullRom(context, alpha) {\n  this._context = context;\n  this._alpha = alpha;\n}\n\nCatmullRom.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._l01_a = this._l12_a = this._l23_a =\n    this._l01_2a = this._l12_2a = this._l23_2a =\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x2, this._y2); break;\n      case 3: this.point(this._x2, this._y2); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n\n    if (this._point) {\n      var x23 = this._x2 - x,\n          y23 = this._y2 - y;\n      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));\n    }\n\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; // falls through\n      default: point(this, x, y); break;\n    }\n\n    this._l01_a = this._l12_a, this._l12_a = this._l23_a;\n    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(alpha) {\n\n  function catmullRom(context) {\n    return alpha ? new CatmullRom(context, alpha) : new Cardinal(context, 0);\n  }\n\n  catmullRom.alpha = function(alpha) {\n    return custom(+alpha);\n  };\n\n  return catmullRom;\n})(0.5);\n","import {CardinalClosed} from \"./cardinalClosed.js\";\nimport noop from \"../noop.js\";\nimport {point} from \"./catmullRom.js\";\n\nfunction CatmullRomClosed(context, alpha) {\n  this._context = context;\n  this._alpha = alpha;\n}\n\nCatmullRomClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 =\n    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN;\n    this._l01_a = this._l12_a = this._l23_a =\n    this._l01_2a = this._l12_2a = this._l23_2a =\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 1: {\n        this._context.moveTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 2: {\n        this._context.lineTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 3: {\n        this.point(this._x3, this._y3);\n        this.point(this._x4, this._y4);\n        this.point(this._x5, this._y5);\n        break;\n      }\n    }\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n\n    if (this._point) {\n      var x23 = this._x2 - x,\n          y23 = this._y2 - y;\n      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));\n    }\n\n    switch (this._point) {\n      case 0: this._point = 1; this._x3 = x, this._y3 = y; break;\n      case 1: this._point = 2; this._context.moveTo(this._x4 = x, this._y4 = y); break;\n      case 2: this._point = 3; this._x5 = x, this._y5 = y; break;\n      default: point(this, x, y); break;\n    }\n\n    this._l01_a = this._l12_a, this._l12_a = this._l23_a;\n    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(alpha) {\n\n  function catmullRom(context) {\n    return alpha ? new CatmullRomClosed(context, alpha) : new CardinalClosed(context, 0);\n  }\n\n  catmullRom.alpha = function(alpha) {\n    return custom(+alpha);\n  };\n\n  return catmullRom;\n})(0.5);\n","import {CardinalOpen} from \"./cardinalOpen.js\";\nimport {point} from \"./catmullRom.js\";\n\nfunction CatmullRomOpen(context, alpha) {\n  this._context = context;\n  this._alpha = alpha;\n}\n\nCatmullRomOpen.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._l01_a = this._l12_a = this._l23_a =\n    this._l01_2a = this._l12_2a = this._l23_2a =\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n\n    if (this._point) {\n      var x23 = this._x2 - x,\n          y23 = this._y2 - y;\n      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));\n    }\n\n    switch (this._point) {\n      case 0: this._point = 1; break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2); break;\n      case 3: this._point = 4; // falls through\n      default: point(this, x, y); break;\n    }\n\n    this._l01_a = this._l12_a, this._l12_a = this._l23_a;\n    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(alpha) {\n\n  function catmullRom(context) {\n    return alpha ? new CatmullRomOpen(context, alpha) : new CardinalOpen(context, 0);\n  }\n\n  catmullRom.alpha = function(alpha) {\n    return custom(+alpha);\n  };\n\n  return catmullRom;\n})(0.5);\n","import noop from \"../noop.js\";\n\nfunction LinearClosed(context) {\n  this._context = context;\n}\n\nLinearClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._point) this._context.closePath();\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    if (this._point) this._context.lineTo(x, y);\n    else this._point = 1, this._context.moveTo(x, y);\n  }\n};\n\nexport default function(context) {\n  return new LinearClosed(context);\n}\n","function sign(x) {\n  return x < 0 ? -1 : 1;\n}\n\n// Calculate the slopes of the tangents (Hermite-type interpolation) based on\n// the following paper: Steffen, M. 1990. A Simple Method for Monotonic\n// Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.\n// NOV(II), P. 443, 1990.\nfunction slope3(that, x2, y2) {\n  var h0 = that._x1 - that._x0,\n      h1 = x2 - that._x1,\n      s0 = (that._y1 - that._y0) / (h0 || h1 < 0 && -0),\n      s1 = (y2 - that._y1) / (h1 || h0 < 0 && -0),\n      p = (s0 * h1 + s1 * h0) / (h0 + h1);\n  return (sign(s0) + sign(s1)) * Math.min(Math.abs(s0), Math.abs(s1), 0.5 * Math.abs(p)) || 0;\n}\n\n// Calculate a one-sided slope.\nfunction slope2(that, t) {\n  var h = that._x1 - that._x0;\n  return h ? (3 * (that._y1 - that._y0) / h - t) / 2 : t;\n}\n\n// According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations\n// \"you can express cubic Hermite interpolation in terms of cubic BÃ©zier curves\n// with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1\".\nfunction point(that, t0, t1) {\n  var x0 = that._x0,\n      y0 = that._y0,\n      x1 = that._x1,\n      y1 = that._y1,\n      dx = (x1 - x0) / 3;\n  that._context.bezierCurveTo(x0 + dx, y0 + dx * t0, x1 - dx, y1 - dx * t1, x1, y1);\n}\n\nfunction MonotoneX(context) {\n  this._context = context;\n}\n\nMonotoneX.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 =\n    this._t0 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n      case 3: point(this, this._t0, slope2(this, this._t0)); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    var t1 = NaN;\n\n    x = +x, y = +y;\n    if (x === this._x1 && y === this._y1) return; // Ignore coincident points.\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; point(this, slope2(this, t1 = slope3(this, x, y)), t1); break;\n      default: point(this, this._t0, t1 = slope3(this, x, y)); break;\n    }\n\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n    this._t0 = t1;\n  }\n}\n\nfunction MonotoneY(context) {\n  this._context = new ReflectContext(context);\n}\n\n(MonotoneY.prototype = Object.create(MonotoneX.prototype)).point = function(x, y) {\n  MonotoneX.prototype.point.call(this, y, x);\n};\n\nfunction ReflectContext(context) {\n  this._context = context;\n}\n\nReflectContext.prototype = {\n  moveTo: function(x, y) { this._context.moveTo(y, x); },\n  closePath: function() { this._context.closePath(); },\n  lineTo: function(x, y) { this._context.lineTo(y, x); },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) { this._context.bezierCurveTo(y1, x1, y2, x2, y, x); }\n};\n\nexport function monotoneX(context) {\n  return new MonotoneX(context);\n}\n\nexport function monotoneY(context) {\n  return new MonotoneY(context);\n}\n","function Natural(context) {\n  this._context = context;\n}\n\nNatural.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x = [];\n    this._y = [];\n  },\n  lineEnd: function() {\n    var x = this._x,\n        y = this._y,\n        n = x.length;\n\n    if (n) {\n      this._line ? this._context.lineTo(x[0], y[0]) : this._context.moveTo(x[0], y[0]);\n      if (n === 2) {\n        this._context.lineTo(x[1], y[1]);\n      } else {\n        var px = controlPoints(x),\n            py = controlPoints(y);\n        for (var i0 = 0, i1 = 1; i1 < n; ++i0, ++i1) {\n          this._context.bezierCurveTo(px[0][i0], py[0][i0], px[1][i0], py[1][i0], x[i1], y[i1]);\n        }\n      }\n    }\n\n    if (this._line || (this._line !== 0 && n === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n    this._x = this._y = null;\n  },\n  point: function(x, y) {\n    this._x.push(+x);\n    this._y.push(+y);\n  }\n};\n\n// See https://www.particleincell.com/2012/bezier-splines/ for derivation.\nfunction controlPoints(x) {\n  var i,\n      n = x.length - 1,\n      m,\n      a = new Array(n),\n      b = new Array(n),\n      r = new Array(n);\n  a[0] = 0, b[0] = 2, r[0] = x[0] + 2 * x[1];\n  for (i = 1; i < n - 1; ++i) a[i] = 1, b[i] = 4, r[i] = 4 * x[i] + 2 * x[i + 1];\n  a[n - 1] = 2, b[n - 1] = 7, r[n - 1] = 8 * x[n - 1] + x[n];\n  for (i = 1; i < n; ++i) m = a[i] / b[i - 1], b[i] -= m, r[i] -= m * r[i - 1];\n  a[n - 1] = r[n - 1] / b[n - 1];\n  for (i = n - 2; i >= 0; --i) a[i] = (r[i] - a[i + 1]) / b[i];\n  b[n - 1] = (x[n] + a[n - 1]) / 2;\n  for (i = 0; i < n - 1; ++i) b[i] = 2 * x[i + 1] - a[i + 1];\n  return [a, b];\n}\n\nexport default function(context) {\n  return new Natural(context);\n}\n","function Step(context, t) {\n  this._context = context;\n  this._t = t;\n}\n\nStep.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x = this._y = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (0 < this._t && this._t < 1 && this._point === 2) this._context.lineTo(this._x, this._y);\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    if (this._line >= 0) this._t = 1 - this._t, this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // falls through\n      default: {\n        if (this._t <= 0) {\n          this._context.lineTo(this._x, y);\n          this._context.lineTo(x, y);\n        } else {\n          var x1 = this._x * (1 - this._t) + x * this._t;\n          this._context.lineTo(x1, this._y);\n          this._context.lineTo(x1, y);\n        }\n        break;\n      }\n    }\n    this._x = x, this._y = y;\n  }\n};\n\nexport default function(context) {\n  return new Step(context, 0.5);\n}\n\nexport function stepBefore(context) {\n  return new Step(context, 0);\n}\n\nexport function stepAfter(context) {\n  return new Step(context, 1);\n}\n","import {hasOwnProperty} from 'vega-util';\n\nimport {\n  curveBasis,\n  curveBasisClosed,\n  curveBasisOpen,\n  curveBundle,\n  curveCardinal,\n  curveCardinalClosed,\n  curveCardinalOpen,\n  curveCatmullRom,\n  curveCatmullRomClosed,\n  curveCatmullRomOpen,\n  curveLinear,\n  curveLinearClosed,\n  curveMonotoneX,\n  curveMonotoneY,\n  curveNatural,\n  curveStep,\n  curveStepAfter,\n  curveStepBefore\n} from 'd3-shape';\n\nconst lookup = {\n  'basis': {\n    curve: curveBasis\n  },\n  'basis-closed': {\n    curve: curveBasisClosed\n  },\n  'basis-open': {\n    curve: curveBasisOpen\n  },\n  'bundle': {\n    curve: curveBundle,\n    tension: 'beta',\n    value: 0.85\n  },\n  'cardinal': {\n    curve: curveCardinal,\n    tension: 'tension',\n    value: 0\n  },\n  'cardinal-open': {\n    curve: curveCardinalOpen,\n    tension: 'tension',\n    value: 0\n  },\n  'cardinal-closed': {\n    curve: curveCardinalClosed,\n    tension: 'tension',\n    value: 0\n  },\n  'catmull-rom': {\n    curve: curveCatmullRom,\n    tension: 'alpha',\n    value: 0.5\n  },\n  'catmull-rom-closed': {\n    curve: curveCatmullRomClosed,\n    tension: 'alpha',\n    value: 0.5\n  },\n  'catmull-rom-open': {\n    curve: curveCatmullRomOpen,\n    tension: 'alpha',\n    value: 0.5\n  },\n  'linear': {\n    curve: curveLinear\n  },\n  'linear-closed': {\n    curve: curveLinearClosed\n  },\n  'monotone': {\n    horizontal: curveMonotoneY,\n    vertical:   curveMonotoneX\n  },\n  'natural': {\n    curve: curveNatural\n  },\n  'step': {\n    curve: curveStep\n  },\n  'step-after': {\n    curve: curveStepAfter\n  },\n  'step-before': {\n    curve: curveStepBefore\n  }\n};\n\nexport default function curves(type, orientation, tension) {\n  var entry = hasOwnProperty(lookup, type) && lookup[type],\n      curve = null;\n\n  if (entry) {\n    curve = entry.curve || entry[orientation || 'vertical'];\n    if (entry.tension && tension != null) {\n      curve = curve[entry.tension](tension);\n    }\n  }\n\n  return curve;\n}\n","const paramCounts = { m:2, l:2, h:1, v:1, z:0, c:6, s:4, q:4, t:2, a:7 };\nconst commandPattern = /[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi;\nconst numberPattern = /^[+-]?(([0-9]*\\.[0-9]+)|([0-9]+\\.)|([0-9]+))([eE][+-]?[0-9]+)?/;\nconst spacePattern = /^((\\s+,?\\s*)|(,\\s*))/;\nconst flagPattern = /^[01]/;\n\nexport default function parse(path) {\n  const commands = [];\n\n  path.match(commandPattern).forEach(str => {\n    let cmd = str[0];\n    const type = cmd.toLowerCase();\n\n    // parse parameters\n    const paramCount = paramCounts[type];\n    const params = parseParams(type, paramCount, str.slice(1).trim());\n    const count = params.length;\n\n    // error checking based on parameter count\n    if (count < paramCount || (count && count % paramCount !== 0)) {\n      throw Error('Invalid SVG path, incorrect parameter count');\n    }\n\n    // register the command\n    commands.push([cmd, ...params.slice(0, paramCount)]);\n\n    // exit now if we're done, also handles zero-param 'z'\n    if (count === paramCount) {\n      return;\n    }\n\n    // handle implicit line-to\n    if (type === 'm') {\n      cmd = (cmd === 'M') ? 'L' : 'l';\n    }\n\n    // repeat command when given extended param list\n    for (let i = paramCount; i < count; i += paramCount) {\n      commands.push([cmd, ...params.slice(i, i + paramCount)]);\n    }\n  });\n\n  return commands;\n}\n\nfunction parseParams(type, paramCount, segment) {\n  const params = [];\n\n  for (let index = 0; paramCount && index < segment.length; ) {\n    for (let i = 0; i < paramCount; ++i) {\n      const pattern = type === 'a' && (i === 3 || i === 4) ? flagPattern : numberPattern;\n      const match = segment.slice(index).match(pattern);\n\n      if (match === null) {\n        throw Error('Invalid SVG path, incorrect parameter type');\n      }\n\n      index += match[0].length;\n      params.push(+match[0]);\n\n      const ws = segment.slice(index).match(spacePattern);\n      if (ws !== null) {\n        index += ws[0].length;\n      }\n    }\n  }\n\n  return params;\n}\n","export const DegToRad = Math.PI / 180;\nexport const Epsilon = 1e-14;\nexport const HalfPi = Math.PI / 2;\nexport const Tau = Math.PI * 2;\nexport const HalfSqrt3 = Math.sqrt(3) / 2;\n","import {DegToRad, HalfPi, Tau} from '../util/constants';\n\nexport var segmentCache = {};\nexport var bezierCache = {};\n\nvar join = [].join;\n\n// Copied from Inkscape svgtopdf, thanks!\nexport function segments(x, y, rx, ry, large, sweep, rotateX, ox, oy) {\n  const key = join.call(arguments);\n  if (segmentCache[key]) {\n    return segmentCache[key];\n  }\n\n  const th = rotateX * DegToRad;\n  const sin_th = Math.sin(th);\n  const cos_th = Math.cos(th);\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n  const px = cos_th * (ox - x) * 0.5 + sin_th * (oy - y) * 0.5;\n  const py = cos_th * (oy - y) * 0.5 - sin_th * (ox - x) * 0.5;\n  let pl = (px*px) / (rx*rx) + (py*py) / (ry*ry);\n  if (pl > 1) {\n    pl = Math.sqrt(pl);\n    rx *= pl;\n    ry *= pl;\n  }\n\n  const a00 = cos_th / rx;\n  const a01 = sin_th / rx;\n  const a10 = (-sin_th) / ry;\n  const a11 = (cos_th) / ry;\n  const x0 = a00 * ox + a01 * oy;\n  const y0 = a10 * ox + a11 * oy;\n  const x1 = a00 * x + a01 * y;\n  const y1 = a10 * x + a11 * y;\n\n  const d = (x1-x0) * (x1-x0) + (y1-y0) * (y1-y0);\n  let sfactor_sq = 1 / d - 0.25;\n  if (sfactor_sq < 0) sfactor_sq = 0;\n  let sfactor = Math.sqrt(sfactor_sq);\n  if (sweep == large) sfactor = -sfactor;\n  const xc = 0.5 * (x0 + x1) - sfactor * (y1-y0);\n  const yc = 0.5 * (y0 + y1) + sfactor * (x1-x0);\n\n  const th0 = Math.atan2(y0-yc, x0-xc);\n  const th1 = Math.atan2(y1-yc, x1-xc);\n\n  let th_arc = th1-th0;\n  if (th_arc < 0 && sweep === 1) {\n    th_arc += Tau;\n  } else if (th_arc > 0 && sweep === 0) {\n    th_arc -= Tau;\n  }\n\n  const segs = Math.ceil(Math.abs(th_arc / (HalfPi + 0.001)));\n  const result = [];\n  for (let i=0; i<segs; ++i) {\n    const th2 = th0 + i * th_arc / segs;\n    const th3 = th0 + (i+1) * th_arc / segs;\n    result[i] = [xc, yc, th2, th3, rx, ry, sin_th, cos_th];\n  }\n\n  return (segmentCache[key] = result);\n}\n\nexport function bezier(params) {\n  const key = join.call(params);\n  if (bezierCache[key]) {\n    return bezierCache[key];\n  }\n\n  var cx = params[0],\n      cy = params[1],\n      th0 = params[2],\n      th1 = params[3],\n      rx = params[4],\n      ry = params[5],\n      sin_th = params[6],\n      cos_th = params[7];\n\n  const a00 = cos_th * rx;\n  const a01 = -sin_th * ry;\n  const a10 = sin_th * rx;\n  const a11 = cos_th * ry;\n\n  const cos_th0 = Math.cos(th0);\n  const sin_th0 = Math.sin(th0);\n  const cos_th1 = Math.cos(th1);\n  const sin_th1 = Math.sin(th1);\n\n  const th_half = 0.5 * (th1 - th0);\n  const sin_th_h2 = Math.sin(th_half * 0.5);\n  const t = (8/3) * sin_th_h2 * sin_th_h2 / Math.sin(th_half);\n  const x1 = cx + cos_th0 - t * sin_th0;\n  const y1 = cy + sin_th0 + t * cos_th0;\n  const x3 = cx + cos_th1;\n  const y3 = cy + sin_th1;\n  const x2 = x3 + t * sin_th1;\n  const y2 = y3 - t * cos_th1;\n\n  return (bezierCache[key] = [\n    a00 * x1 + a01 * y1,  a10 * x1 + a11 * y1,\n    a00 * x2 + a01 * y2,  a10 * x2 + a11 * y2,\n    a00 * x3 + a01 * y3,  a10 * x3 + a11 * y3\n  ]);\n}\n","import {bezier, segments} from './arc';\n\nconst temp = ['l', 0, 0, 0, 0, 0, 0, 0];\n\nfunction scale(current, sX, sY) {\n  const c = (temp[0] = current[0]);\n  if (c === 'a' || c === 'A') {\n    temp[1] = sX * current[1];\n    temp[2] = sY * current[2];\n    temp[3] = current[3];\n    temp[4] = current[4];\n    temp[5] = current[5];\n    temp[6] = sX * current[6];\n    temp[7] = sY * current[7];\n  } else if (c === 'h' || c === 'H') {\n    temp[1] = sX * current[1];\n  } else if (c === 'v' || c === 'V') {\n    temp[1] = sY * current[1];\n  } else {\n    for (var i=1, n=current.length; i<n; ++i) {\n      temp[i] = (i % 2 == 1 ? sX : sY) * current[i];\n    }\n  }\n  return temp;\n}\n\nexport default function(context, path, l, t, sX, sY) {\n  var current, // current instruction\n      previous = null,\n      x = 0, // current x\n      y = 0, // current y\n      controlX = 0, // current control point x\n      controlY = 0, // current control point y\n      tempX,\n      tempY,\n      tempControlX,\n      tempControlY,\n      anchorX = 0,\n      anchorY = 0;\n\n  if (l == null) l = 0;\n  if (t == null) t = 0;\n  if (sX == null) sX = 1;\n  if (sY == null) sY = sX;\n\n  if (context.beginPath) context.beginPath();\n\n  for (var i=0, len=path.length; i<len; ++i) {\n    current = path[i];\n    if (sX !== 1 || sY !== 1) {\n      current = scale(current, sX, sY);\n    }\n\n    switch (current[0]) { // first letter\n\n      case 'l': // lineto, relative\n        x += current[1];\n        y += current[2];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'L': // lineto, absolute\n        x = current[1];\n        y = current[2];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'h': // horizontal lineto, relative\n        x += current[1];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'H': // horizontal lineto, absolute\n        x = current[1];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'v': // vertical lineto, relative\n        y += current[1];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'V': // verical lineto, absolute\n        y = current[1];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'm': // moveTo, relative\n        x += current[1];\n        y += current[2];\n        anchorX = x;\n        anchorY = y;\n        context.moveTo(x + l, y + t);\n        break;\n\n      case 'M': // moveTo, absolute\n        x = current[1];\n        y = current[2];\n        anchorX = x;\n        anchorY = y;\n        context.moveTo(x + l, y + t);\n        break;\n\n      case 'c': // bezierCurveTo, relative\n        tempX = x + current[5];\n        tempY = y + current[6];\n        controlX = x + current[3];\n        controlY = y + current[4];\n        context.bezierCurveTo(\n          x + current[1] + l, // x1\n          y + current[2] + t, // y1\n          controlX + l, // x2\n          controlY + t, // y2\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        break;\n\n      case 'C': // bezierCurveTo, absolute\n        x = current[5];\n        y = current[6];\n        controlX = current[3];\n        controlY = current[4];\n        context.bezierCurveTo(\n          current[1] + l,\n          current[2] + t,\n          controlX + l,\n          controlY + t,\n          x + l,\n          y + t\n        );\n        break;\n\n      case 's': // shorthand cubic bezierCurveTo, relative\n        // transform to absolute x,y\n        tempX = x + current[3];\n        tempY = y + current[4];\n        // calculate reflection of previous control points\n        controlX = 2 * x - controlX;\n        controlY = 2 * y - controlY;\n        context.bezierCurveTo(\n          controlX + l,\n          controlY + t,\n          x + current[1] + l,\n          y + current[2] + t,\n          tempX + l,\n          tempY + t\n        );\n\n        // set control point to 2nd one of this command\n        // the first control point is assumed to be the reflection of\n        // the second control point on the previous command relative\n        // to the current point.\n        controlX = x + current[1];\n        controlY = y + current[2];\n\n        x = tempX;\n        y = tempY;\n        break;\n\n      case 'S': // shorthand cubic bezierCurveTo, absolute\n        tempX = current[3];\n        tempY = current[4];\n        // calculate reflection of previous control points\n        controlX = 2*x - controlX;\n        controlY = 2*y - controlY;\n        context.bezierCurveTo(\n          controlX + l,\n          controlY + t,\n          current[1] + l,\n          current[2] + t,\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        // set control point to 2nd one of this command\n        // the first control point is assumed to be the reflection of\n        // the second control point on the previous command relative\n        // to the current point.\n        controlX = current[1];\n        controlY = current[2];\n\n        break;\n\n      case 'q': // quadraticCurveTo, relative\n        // transform to absolute x,y\n        tempX = x + current[3];\n        tempY = y + current[4];\n\n        controlX = x + current[1];\n        controlY = y + current[2];\n\n        context.quadraticCurveTo(\n          controlX + l,\n          controlY + t,\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        break;\n\n      case 'Q': // quadraticCurveTo, absolute\n        tempX = current[3];\n        tempY = current[4];\n\n        context.quadraticCurveTo(\n          current[1] + l,\n          current[2] + t,\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        controlX = current[1];\n        controlY = current[2];\n        break;\n\n      case 't': // shorthand quadraticCurveTo, relative\n\n        // transform to absolute x,y\n        tempX = x + current[1];\n        tempY = y + current[2];\n\n        if (previous[0].match(/[QqTt]/) === null) {\n          // If there is no previous command or if the previous command was not a Q, q, T or t,\n          // assume the control point is coincident with the current point\n          controlX = x;\n          controlY = y;\n        }\n        else if (previous[0] === 't') {\n          // calculate reflection of previous control points for t\n          controlX = 2 * x - tempControlX;\n          controlY = 2 * y - tempControlY;\n        }\n        else if (previous[0] === 'q') {\n          // calculate reflection of previous control points for q\n          controlX = 2 * x - controlX;\n          controlY = 2 * y - controlY;\n        }\n\n        tempControlX = controlX;\n        tempControlY = controlY;\n\n        context.quadraticCurveTo(\n          controlX + l,\n          controlY + t,\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        controlX = x + current[1];\n        controlY = y + current[2];\n        break;\n\n      case 'T':\n        tempX = current[1];\n        tempY = current[2];\n\n        // calculate reflection of previous control points\n        controlX = 2 * x - controlX;\n        controlY = 2 * y - controlY;\n        context.quadraticCurveTo(\n          controlX + l,\n          controlY + t,\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        break;\n\n      case 'a':\n        drawArc(context, x + l, y + t, [\n          current[1],\n          current[2],\n          current[3],\n          current[4],\n          current[5],\n          current[6] + x + l,\n          current[7] + y + t\n        ]);\n        x += current[6];\n        y += current[7];\n        break;\n\n      case 'A':\n        drawArc(context, x + l, y + t, [\n          current[1],\n          current[2],\n          current[3],\n          current[4],\n          current[5],\n          current[6] + l,\n          current[7] + t\n        ]);\n        x = current[6];\n        y = current[7];\n        break;\n\n      case 'z':\n      case 'Z':\n        x = anchorX;\n        y = anchorY;\n        context.closePath();\n        break;\n    }\n    previous = current;\n  }\n}\n\nfunction drawArc(context, x, y, coords) {\n  const seg = segments(\n    coords[5], // end x\n    coords[6], // end y\n    coords[0], // radius x\n    coords[1], // radius y\n    coords[3], // large flag\n    coords[4], // sweep flag\n    coords[2], // rotation\n    x, y\n  );\n  for (let i=0; i<seg.length; ++i) {\n    const bez = bezier(seg[i]);\n    context.bezierCurveTo(bez[0], bez[1], bez[2], bez[3], bez[4], bez[5]);\n  }\n}\n","import pathParse from './parse';\nimport pathRender from './render';\nimport {HalfSqrt3, Tau} from '../util/constants';\nimport {hasOwnProperty} from 'vega-util';\n\nconst Tan30 = 0.5773502691896257;\n\nconst builtins = {\n  'circle': {\n    draw: function(context, size) {\n      const r = Math.sqrt(size) / 2;\n      context.moveTo(r, 0);\n      context.arc(0, 0, r, 0, Tau);\n    }\n  },\n  'cross': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          s = r / 2.5;\n      context.moveTo(-r, -s);\n      context.lineTo(-r, s);\n      context.lineTo(-s, s);\n      context.lineTo(-s, r);\n      context.lineTo(s, r);\n      context.lineTo(s, s);\n      context.lineTo(r, s);\n      context.lineTo(r, -s);\n      context.lineTo(s, -s);\n      context.lineTo(s, -r);\n      context.lineTo(-s, -r);\n      context.lineTo(-s, -s);\n      context.closePath();\n    }\n  },\n  'diamond': {\n    draw: function(context, size) {\n      const r = Math.sqrt(size) / 2;\n      context.moveTo(-r, 0);\n      context.lineTo(0, -r);\n      context.lineTo(r, 0);\n      context.lineTo(0, r);\n      context.closePath();\n    }\n  },\n  'square': {\n    draw: function(context, size) {\n      var w = Math.sqrt(size),\n          x = -w / 2;\n      context.rect(x, x, w, w);\n    }\n  },\n  'arrow': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          s = r / 7,\n          t = r / 2.5,\n          v = r / 8;\n      context.moveTo(-s, r);\n      context.lineTo(s, r);\n      context.lineTo(s, -v);\n      context.lineTo(t, -v);\n      context.lineTo(0, -r);\n      context.lineTo(-t, -v);\n      context.lineTo(-s, -v);\n      context.closePath();\n    }\n  },\n  'wedge': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r,\n          o = (h - r * Tan30),\n          b = r / 4;\n      context.moveTo(0, -h - o);\n      context.lineTo(-b, h - o);\n      context.lineTo(b, h - o);\n      context.closePath();\n    }\n  },\n  'triangle': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r,\n          o = (h - r * Tan30);\n      context.moveTo(0, -h - o);\n      context.lineTo(-r, h - o);\n      context.lineTo(r, h - o);\n      context.closePath();\n    }\n  },\n  'triangle-up': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r;\n      context.moveTo(0, -h);\n      context.lineTo(-r, h);\n      context.lineTo(r, h);\n      context.closePath();\n    }\n  },\n  'triangle-down': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r;\n      context.moveTo(0, h);\n      context.lineTo(-r, -h);\n      context.lineTo(r, -h);\n      context.closePath();\n    }\n  },\n  'triangle-right': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r;\n      context.moveTo(h, 0);\n      context.lineTo(-h, -r);\n      context.lineTo(-h, r);\n      context.closePath();\n    }\n  },\n  'triangle-left': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r;\n      context.moveTo(-h, 0);\n      context.lineTo(h, -r);\n      context.lineTo(h, r);\n      context.closePath();\n    }\n  },\n  'stroke': {\n    draw: function(context, size) {\n      const r = Math.sqrt(size) / 2;\n      context.moveTo(-r, 0);\n      context.lineTo(r, 0);\n    }\n  }\n};\n\nexport default function symbols(_) {\n  return hasOwnProperty(builtins, _) ? builtins[_] : customSymbol(_);\n}\n\nvar custom = {};\n\nfunction customSymbol(path) {\n  if (!hasOwnProperty(custom, path)) {\n    const parsed = pathParse(path);\n    custom[path] = {\n      draw: function(context, size) {\n        pathRender(context, parsed, 0, 0, Math.sqrt(size) / 2);\n      }\n    };\n  }\n  return custom[path];\n}\n","import {path} from 'd3-path';\n\n// See http://spencermortensen.com/articles/bezier-circle/\nconst C = 0.448084975506; // C = 1 - c\n\nfunction rectangleX(d) {\n  return d.x;\n}\n\nfunction rectangleY(d) {\n  return d.y;\n}\n\nfunction rectangleWidth(d) {\n  return d.width;\n}\n\nfunction rectangleHeight(d) {\n  return d.height;\n}\n\nfunction number(_) {\n  return typeof _ === 'function' ? _ : () => +_;\n}\n\nfunction clamp(value, min, max) {\n  return Math.max(min, Math.min(value, max));\n}\n\nexport default function() {\n  var x = rectangleX,\n      y = rectangleY,\n      width = rectangleWidth,\n      height = rectangleHeight,\n      crTL = number(0),\n      crTR = crTL,\n      crBL = crTL,\n      crBR = crTL,\n      context = null;\n\n  function rectangle(_, x0, y0) {\n    var buffer,\n        x1 = x0 != null ? x0 : +x.call(this, _),\n        y1 = y0 != null ? y0 : +y.call(this, _),\n        w  = +width.call(this, _),\n        h  = +height.call(this, _),\n        s  = Math.min(w, h) / 2,\n        tl = clamp(+crTL.call(this, _), 0, s),\n        tr = clamp(+crTR.call(this, _), 0, s),\n        bl = clamp(+crBL.call(this, _), 0, s),\n        br = clamp(+crBR.call(this, _), 0, s);\n\n    if (!context) context = buffer = path();\n\n    if (tl <= 0 && tr <= 0 && bl <= 0 && br <= 0) {\n      context.rect(x1, y1, w, h);\n    } else {\n      var x2 = x1 + w,\n          y2 = y1 + h;\n      context.moveTo(x1 + tl, y1);\n      context.lineTo(x2 - tr, y1);\n      context.bezierCurveTo(x2 - C * tr, y1, x2, y1 + C * tr, x2, y1 + tr);\n      context.lineTo(x2, y2 - br);\n      context.bezierCurveTo(x2, y2 - C * br, x2 - C * br, y2, x2 - br, y2);\n      context.lineTo(x1 + bl, y2);\n      context.bezierCurveTo(x1 + C * bl, y2, x1, y2 - C * bl, x1, y2 - bl);\n      context.lineTo(x1, y1 + tl);\n      context.bezierCurveTo(x1, y1 + C * tl, x1 + C * tl, y1, x1 + tl, y1);\n      context.closePath();\n    }\n\n    if (buffer) {\n      context = null;\n      return buffer + '' || null;\n    }\n  }\n\n  rectangle.x = function(_) {\n    if (arguments.length) {\n      x = number(_);\n      return rectangle;\n    } else {\n      return x;\n    }\n  };\n\n  rectangle.y = function(_) {\n    if (arguments.length) {\n      y = number(_);\n      return rectangle;\n    } else {\n      return y;\n    }\n  };\n\n  rectangle.width = function(_) {\n    if (arguments.length) {\n      width = number(_);\n      return rectangle;\n    } else {\n      return width;\n    }\n  };\n\n  rectangle.height = function(_) {\n    if (arguments.length) {\n      height = number(_);\n      return rectangle;\n    } else {\n      return height;\n    }\n  };\n\n  rectangle.cornerRadius = function(tl, tr, br, bl) {\n    if (arguments.length) {\n      crTL = number(tl);\n      crTR = tr != null ? number(tr) : crTL;\n      crBR = br != null ? number(br) : crTL;\n      crBL = bl != null ? number(bl) : crTR;\n      return rectangle;\n    } else {\n      return crTL;\n    }\n  };\n\n  rectangle.context = function(_) {\n    if (arguments.length) {\n      context = _ == null ? null : _;\n      return rectangle;\n    } else {\n      return context;\n    }\n  };\n\n  return rectangle;\n}\n","import {Tau} from '../util/constants';\nimport {path} from 'd3-path';\n\nexport default function() {\n  var x,\n      y,\n      size,\n      defined,\n      context = null,\n      ready, x1, y1, r1;\n\n  function point(x2, y2, w2) {\n    const r2 = w2 / 2;\n\n    if (ready) {\n      var ux = y1 - y2,\n          uy = x2 - x1;\n\n      if (ux || uy) {\n        // get normal vector\n        var ud = Math.sqrt(ux * ux + uy * uy),\n            rx = (ux /= ud) * r1,\n            ry = (uy /= ud) * r1,\n            t = Math.atan2(uy, ux);\n\n        // draw segment\n        context.moveTo(x1 - rx, y1 - ry);\n        context.lineTo(x2 - ux * r2, y2 - uy * r2);\n        context.arc(x2, y2, r2, t - Math.PI, t);\n        context.lineTo(x1 + rx, y1 + ry);\n        context.arc(x1, y1, r1, t, t + Math.PI);\n      } else {\n        context.arc(x2, y2, r2, 0, Tau);\n      }\n      context.closePath();\n    } else {\n      ready = 1;\n    }\n    x1 = x2;\n    y1 = y2;\n    r1 = r2;\n  }\n\n  function trail(data) {\n    var i,\n        n = data.length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) context = buffer = path();\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) ready = 0;\n      }\n      if (defined0) point(+x(d, i, data), +y(d, i, data), +size(d, i, data));\n    }\n\n    if (buffer) {\n      context = null;\n      return buffer + '' || null;\n    }\n  }\n\n  trail.x = function(_) {\n    if (arguments.length) {\n      x = _;\n      return trail;\n    } else {\n      return x;\n    }\n  };\n\n  trail.y = function(_) {\n    if (arguments.length) {\n      y = _;\n      return trail;\n    } else {\n      return y;\n    }\n  };\n\n  trail.size = function(_) {\n    if (arguments.length) {\n      size = _;\n      return trail;\n    } else {\n      return size;\n    }\n  };\n\n  trail.defined = function(_) {\n    if (arguments.length) {\n      defined = _;\n      return trail;\n    } else {\n      return defined;\n    }\n  };\n\n  trail.context = function(_) {\n    if (arguments.length) {\n      if (_ == null) {\n        context = null;\n      } else {\n        context = _;\n      }\n      return trail;\n    } else {\n      return context;\n    }\n  };\n\n  return trail;\n}\n","import curves from './curves';\nimport symbols from './symbols';\n\nimport {default as vg_rect} from './rectangle';\nimport {default as vg_trail} from './trail';\n\nimport {\n  arc as d3_arc,\n  area as d3_area,\n  line as d3_line,\n  symbol as d3_symbol\n} from 'd3-shape';\n\nfunction value(a, b) {\n  return a != null ? a : b;\n}\n\nconst x =  item => item.x || 0,\n      y =  item => item.y || 0,\n      w =  item => item.width || 0,\n      h =  item => item.height || 0,\n      xw = item => (item.x || 0) + (item.width || 0),\n      yh = item => (item.y || 0) + (item.height || 0),\n      sa = item => item.startAngle || 0,\n      ea = item => item.endAngle || 0,\n      pa = item => item.padAngle || 0,\n      ir = item => item.innerRadius || 0,\n      or = item => item.outerRadius || 0,\n      cr = item => item.cornerRadius || 0,\n      tl = item => value(item.cornerRadiusTopLeft, item.cornerRadius) || 0,\n      tr = item => value(item.cornerRadiusTopRight, item.cornerRadius) || 0,\n      br = item => value(item.cornerRadiusBottomRight, item.cornerRadius) || 0,\n      bl = item => value(item.cornerRadiusBottomLeft, item.cornerRadius) || 0,\n      sz = item => value(item.size, 64),\n      ts = item => item.size || 1,\n      def = item => !(item.defined === false),\n      type = item => symbols(item.shape || 'circle');\n\nconst arcShape    = d3_arc().startAngle(sa).endAngle(ea).padAngle(pa)\n                      .innerRadius(ir).outerRadius(or).cornerRadius(cr),\n      areavShape  = d3_area().x(x).y1(y).y0(yh).defined(def),\n      areahShape  = d3_area().y(y).x1(x).x0(xw).defined(def),\n      lineShape   = d3_line().x(x).y(y).defined(def),\n      rectShape   = vg_rect().x(x).y(y).width(w).height(h)\n                      .cornerRadius(tl, tr, br, bl),\n      symbolShape = d3_symbol().type(type).size(sz),\n      trailShape  = vg_trail().x(x).y(y).defined(def).size(ts);\n\nexport function hasCornerRadius(item) {\n  return item.cornerRadius\n    || item.cornerRadiusTopLeft\n    || item.cornerRadiusTopRight\n    || item.cornerRadiusBottomRight\n    || item.cornerRadiusBottomLeft;\n}\n\nexport function arc(context, item) {\n  return arcShape.context(context)(item);\n}\n\nexport function area(context, items) {\n  const item = items[0],\n        interp = item.interpolate || 'linear';\n  return (item.orient === 'horizontal' ? areahShape : areavShape)\n    .curve(curves(interp, item.orient, item.tension))\n    .context(context)(items);\n}\n\nexport function line(context, items) {\n  const item = items[0],\n        interp = item.interpolate || 'linear';\n  return lineShape.curve(curves(interp, item.orient, item.tension))\n    .context(context)(items);\n}\n\nexport function rectangle(context, item, x, y) {\n  return rectShape.context(context)(item, x, y);\n}\n\nexport function shape(context, item) {\n  return (item.mark.shape || item.shape)\n    .context(context)(item);\n}\n\nexport function symbol(context, item) {\n  return symbolShape.context(context)(item);\n}\n\nexport function trail(context, items) {\n  return trailShape.context(context)(items);\n}\n","import {path} from \"d3-path\";\nimport constant from \"./constant.js\";\nimport asterisk from \"./symbol/asterisk.js\";\nimport circle from \"./symbol/circle.js\";\nimport cross from \"./symbol/cross.js\";\nimport diamond from \"./symbol/diamond.js\";\nimport diamond2 from \"./symbol/diamond2.js\";\nimport plus from \"./symbol/plus.js\";\nimport square from \"./symbol/square.js\";\nimport square2 from \"./symbol/square2.js\";\nimport star from \"./symbol/star.js\";\nimport triangle from \"./symbol/triangle.js\";\nimport triangle2 from \"./symbol/triangle2.js\";\nimport wye from \"./symbol/wye.js\";\nimport x from \"./symbol/x.js\";\n\n// These symbols are designed to be filled.\nexport const symbolsFill = [\n  circle,\n  cross,\n  diamond,\n  square,\n  star,\n  triangle,\n  wye\n];\n\n// These symbols are designed to be stroked (with a width of 1.5px and round caps).\nexport const symbolsStroke = [\n  circle,\n  plus,\n  x,\n  triangle2,\n  asterisk,\n  square2,\n  diamond2\n];\n\nexport default function Symbol(type, size) {\n  let context = null;\n\n  type = typeof type === \"function\" ? type : constant(type || circle);\n  size = typeof size === \"function\" ? size : constant(size === undefined ? 64 : +size);\n\n  function symbol() {\n    let buffer;\n    if (!context) context = buffer = path();\n    type.apply(this, arguments).draw(context, +size.apply(this, arguments));\n    if (buffer) return context = null, buffer + \"\" || null;\n  }\n\n  symbol.type = function(_) {\n    return arguments.length ? (type = typeof _ === \"function\" ? _ : constant(_), symbol) : type;\n  };\n\n  symbol.size = function(_) {\n    return arguments.length ? (size = typeof _ === \"function\" ? _ : constant(+_), symbol) : size;\n  };\n\n  symbol.context = function(_) {\n    return arguments.length ? (context = _ == null ? null : _, symbol) : context;\n  };\n\n  return symbol;\n}\n","import {hasCornerRadius, rectangle} from '../../path/shapes';\nimport {isFunction} from 'vega-util';\n\nvar clip_id = 1;\n\nexport function resetSVGClipId() {\n  clip_id = 1;\n}\n\nexport default function(renderer, item, size) {\n  var clip = item.clip,\n      defs = renderer._defs,\n      id = item.clip_id || (item.clip_id = 'clip' + clip_id++),\n      c = defs.clipping[id] || (defs.clipping[id] = {id: id});\n\n  if (isFunction(clip)) {\n    c.path = clip(null);\n  } else if (hasCornerRadius(size)) {\n    c.path = rectangle(null, size, 0, 0);\n  } else {\n    c.width = size.width || 0;\n    c.height = size.height || 0;\n  }\n\n  return 'url(#' + id + ')';\n}\n","export default function Bounds(b) {\n  this.clear();\n  if (b) this.union(b);\n}\n\nBounds.prototype = {\n  clone() {\n    return new Bounds(this);\n  },\n\n  clear() {\n    this.x1 = +Number.MAX_VALUE;\n    this.y1 = +Number.MAX_VALUE;\n    this.x2 = -Number.MAX_VALUE;\n    this.y2 = -Number.MAX_VALUE;\n    return this;\n  },\n\n  empty() {\n    return (\n      this.x1 === +Number.MAX_VALUE &&\n      this.y1 === +Number.MAX_VALUE &&\n      this.x2 === -Number.MAX_VALUE &&\n      this.y2 === -Number.MAX_VALUE\n    );\n  },\n\n  equals(b) {\n    return (\n      this.x1 === b.x1 &&\n      this.y1 === b.y1 &&\n      this.x2 === b.x2 &&\n      this.y2 === b.y2\n    );\n  },\n\n  set(x1, y1, x2, y2) {\n    if (x2 < x1) {\n      this.x2 = x1;\n      this.x1 = x2;\n    } else {\n      this.x1 = x1;\n      this.x2 = x2;\n    }\n    if (y2 < y1) {\n      this.y2 = y1;\n      this.y1 = y2;\n    } else {\n      this.y1 = y1;\n      this.y2 = y2;\n    }\n    return this;\n  },\n\n  add(x, y) {\n    if (x < this.x1) this.x1 = x;\n    if (y < this.y1) this.y1 = y;\n    if (x > this.x2) this.x2 = x;\n    if (y > this.y2) this.y2 = y;\n    return this;\n  },\n\n  expand(d) {\n    this.x1 -= d;\n    this.y1 -= d;\n    this.x2 += d;\n    this.y2 += d;\n    return this;\n  },\n\n  round() {\n    this.x1 = Math.floor(this.x1);\n    this.y1 = Math.floor(this.y1);\n    this.x2 = Math.ceil(this.x2);\n    this.y2 = Math.ceil(this.y2);\n    return this;\n  },\n\n  scale(s) {\n    this.x1 *= s;\n    this.y1 *= s;\n    this.x2 *= s;\n    this.y2 *= s;\n    return this;\n  },\n\n  translate(dx, dy) {\n    this.x1 += dx;\n    this.x2 += dx;\n    this.y1 += dy;\n    this.y2 += dy;\n    return this;\n  },\n\n  rotate(angle, x, y) {\n    const p = this.rotatedPoints(angle, x, y);\n    return this.clear()\n      .add(p[0], p[1])\n      .add(p[2], p[3])\n      .add(p[4], p[5])\n      .add(p[6], p[7]);\n  },\n\n  rotatedPoints(angle, x, y) {\n    var {x1, y1, x2, y2} = this,\n        cos = Math.cos(angle),\n        sin = Math.sin(angle),\n        cx = x - x * cos + y * sin,\n        cy = y - x * sin - y * cos;\n\n    return [\n      cos * x1 - sin * y1 + cx, sin * x1 + cos * y1 + cy,\n      cos * x1 - sin * y2 + cx, sin * x1 + cos * y2 + cy,\n      cos * x2 - sin * y1 + cx, sin * x2 + cos * y1 + cy,\n      cos * x2 - sin * y2 + cx, sin * x2 + cos * y2 + cy\n    ];\n  },\n\n  union(b) {\n    if (b.x1 < this.x1) this.x1 = b.x1;\n    if (b.y1 < this.y1) this.y1 = b.y1;\n    if (b.x2 > this.x2) this.x2 = b.x2;\n    if (b.y2 > this.y2) this.y2 = b.y2;\n    return this;\n  },\n\n  intersect(b) {\n    if (b.x1 > this.x1) this.x1 = b.x1;\n    if (b.y1 > this.y1) this.y1 = b.y1;\n    if (b.x2 < this.x2) this.x2 = b.x2;\n    if (b.y2 < this.y2) this.y2 = b.y2;\n    return this;\n  },\n\n  encloses(b) {\n    return b && (\n      this.x1 <= b.x1 &&\n      this.x2 >= b.x2 &&\n      this.y1 <= b.y1 &&\n      this.y2 >= b.y2\n    );\n  },\n\n  alignsWith(b) {\n    return b && (\n      this.x1 == b.x1 ||\n      this.x2 == b.x2 ||\n      this.y1 == b.y1 ||\n      this.y2 == b.y2\n    );\n  },\n\n  intersects(b) {\n    return b && !(\n      this.x2 < b.x1 ||\n      this.x1 > b.x2 ||\n      this.y2 < b.y1 ||\n      this.y1 > b.y2\n    );\n  },\n\n  contains(x, y) {\n    return !(\n      x < this.x1 ||\n      x > this.x2 ||\n      y < this.y1 ||\n      y > this.y2\n    );\n  },\n\n  width() {\n    return this.x2 - this.x1;\n  },\n\n  height() {\n    return this.y2 - this.y1;\n  }\n};\n","import Bounds from './Bounds';\n\nexport default function Item(mark) {\n  this.mark = mark;\n  this.bounds = (this.bounds || new Bounds());\n}\n","import Item from './Item';\nimport {inherits} from 'vega-util';\n\nexport default function GroupItem(mark) {\n  Item.call(this, mark);\n  this.items = (this.items || []);\n}\n\ninherits(GroupItem, Item);\n","import {image} from 'vega-canvas';\nimport {loader} from 'vega-loader';\nimport {hasOwnProperty} from 'vega-util';\n\nexport default function ResourceLoader(customLoader) {\n  this._pending = 0;\n  this._loader = customLoader || loader();\n}\n\nfunction increment(loader) {\n  loader._pending += 1;\n}\n\nfunction decrement(loader) {\n  loader._pending -= 1;\n}\n\nResourceLoader.prototype = {\n  pending() {\n    return this._pending;\n  },\n\n  sanitizeURL(uri) {\n    const loader = this;\n    increment(loader);\n\n    return loader._loader.sanitize(uri, {context:'href'})\n      .then(opt => {\n        decrement(loader);\n        return opt;\n      })\n      .catch(() => {\n        decrement(loader);\n        return null;\n      });\n  },\n\n  loadImage(uri) {\n    const loader = this,\n          Image = image();\n    increment(loader);\n\n    return loader._loader\n      .sanitize(uri, {context: 'image'})\n      .then(opt => {\n        const url = opt.href;\n        if (!url || !Image) throw {url: url};\n\n        const img = new Image();\n\n        // set crossOrigin only if cors is defined; empty string sets anonymous mode\n        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/crossOrigin\n        const cors = hasOwnProperty(opt, 'crossOrigin') ? opt.crossOrigin : 'anonymous';\n        if (cors != null) img.crossOrigin = cors;\n\n        // attempt to load image resource\n        img.onload = () => decrement(loader);\n        img.onerror = () => decrement(loader);\n        img.src = url;\n\n        return img;\n      })\n      .catch(e => {\n        decrement(loader);\n        return {complete: false, width: 0, height: 0, src: e && e.url || ''};\n      });\n  },\n\n  ready() {\n    const loader = this;\n    return new Promise(accept => {\n      function poll(value) {\n        if (!loader.pending()) accept(value);\n        else setTimeout(() => { poll(true); }, 10);\n      }\n      poll(false);\n    });\n  }\n};\n","export default function(bounds, item, miter) {\n  if (item.stroke && item.opacity !== 0 && item.strokeOpacity !== 0) {\n    const sw = item.strokeWidth != null ? +item.strokeWidth : 1;\n    bounds.expand(sw + (miter ? miterAdjustment(item, sw) : 0));\n  }\n  return bounds;\n}\n\nfunction miterAdjustment(item, strokeWidth) {\n  // TODO: more sophisticated adjustment? Or miter support in boundContext?\n  return item.strokeJoin && item.strokeJoin !== 'miter' ? 0 : strokeWidth;\n}\n","import {DegToRad, Epsilon, HalfPi, Tau} from '../util/constants';\n\nconst circleThreshold = Tau - 1e-8;\nlet bounds, lx, ly, rot, ma, mb, mc, md;\n\nconst add = (x, y) => bounds.add(x, y);\nconst addL = (x, y) => add(lx = x, ly = y);\nconst addX = x => add(x, bounds.y1);\nconst addY = y => add(bounds.x1, y);\n\nconst px = (x, y) => ma * x + mc * y;\nconst py = (x, y) => mb * x + md * y;\nconst addp = (x, y) => add(px(x, y), py(x, y));\nconst addpL = (x, y) => addL(px(x, y), py(x, y));\n\nexport default function(_, deg) {\n  bounds = _;\n  if (deg) {\n    rot = deg * DegToRad;\n    ma = md = Math.cos(rot);\n    mb = Math.sin(rot);\n    mc = -mb;\n  } else {\n    ma = md = 1;\n    rot = mb = mc = 0;\n  }\n  return context;\n}\n\nconst context = {\n  beginPath() {},\n  closePath() {},\n\n  moveTo: addpL,\n  lineTo: addpL,\n\n  rect(x, y, w, h) {\n    if (rot) {\n      addp(x + w, y);\n      addp(x + w, y + h);\n      addp(x, y + h);\n      addpL(x, y);\n    } else {\n      add(x + w, y + h);\n      addL(x, y);\n    }\n  },\n\n  quadraticCurveTo(x1, y1, x2, y2) {\n    const px1 = px(x1, y1),\n          py1 = py(x1, y1),\n          px2 = px(x2, y2),\n          py2 = py(x2, y2);\n    quadExtrema(lx, px1, px2, addX);\n    quadExtrema(ly, py1, py2, addY);\n    addL(px2, py2);\n  },\n\n  bezierCurveTo(x1, y1, x2, y2, x3, y3) {\n    const px1 = px(x1, y1),\n          py1 = py(x1, y1),\n          px2 = px(x2, y2),\n          py2 = py(x2, y2),\n          px3 = px(x3, y3),\n          py3 = py(x3, y3);\n    cubicExtrema(lx, px1, px2, px3, addX);\n    cubicExtrema(ly, py1, py2, py3, addY);\n    addL(px3, py3);\n  },\n\n  arc(cx, cy, r, sa, ea, ccw) {\n    sa += rot;\n    ea += rot;\n\n    // store last point on path\n    lx = r * Math.cos(ea) + cx;\n    ly = r * Math.sin(ea) + cy;\n\n    if (Math.abs(ea - sa) > circleThreshold) {\n      // treat as full circle\n      add(cx - r, cy - r);\n      add(cx + r, cy + r);\n    } else {\n      const update = a => add(r * Math.cos(a) + cx, r * Math.sin(a) + cy);\n      let s, i;\n\n      // sample end points\n      update(sa);\n      update(ea);\n\n      // sample interior points aligned with 90 degrees\n      if (ea !== sa) {\n        sa = sa % Tau; if (sa < 0) sa += Tau;\n        ea = ea % Tau; if (ea < 0) ea += Tau;\n\n        if (ea < sa) {\n          ccw = !ccw; // flip direction\n          s = sa; sa = ea; ea = s; // swap end-points\n        }\n\n        if (ccw) {\n          ea -= Tau;\n          s = sa - (sa % HalfPi);\n          for (i=0; i<4 && s>ea; ++i, s-=HalfPi) update(s);\n        } else {\n          s = sa - (sa % HalfPi) + HalfPi;\n          for (i=0; i<4 && s<ea; ++i, s=s+HalfPi) update(s);\n        }\n      }\n    }\n  }\n};\n\nfunction quadExtrema(x0, x1, x2, cb) {\n  const t = (x0 - x1) / (x0 + x2 - 2 * x1);\n  if (0 < t && t < 1) cb(x0 + (x1 - x0) * t);\n}\n\nfunction cubicExtrema(x0, x1, x2, x3, cb) {\n  const a = x3 - x0 + 3 * x1 - 3 * x2,\n        b = x0 + x2 - 2 * x1,\n        c = x0 - x1;\n\n  let t0 = 0, t1 = 0, r;\n\n  // solve for parameter t\n  if (Math.abs(a) > Epsilon) {\n    // quadratic equation\n    r = b * b + c * a;\n    if (r >= 0) {\n      r = Math.sqrt(r);\n      t0 = (-b + r) / a;\n      t1 = (-b - r) / a;\n    }\n  } else {\n    // linear equation\n    t0 = 0.5 * c / b;\n  }\n\n  // calculate position\n  if (0 < t0 && t0 < 1) cb(cubic(t0, x0, x1, x2, x3));\n  if (0 < t1 && t1 < 1) cb(cubic(t1, x0, x1, x2, x3));\n}\n\nfunction cubic(t, x0, x1, x2, x3) {\n  const s = 1 - t, s2 = s * s, t2 = t * t;\n  return (s2 * s * x0) + (3 * s2 * t * x1) + (3 * s * t2 * x2) + (t2 * t * x3);\n}\n","import {canvas} from 'vega-canvas';\n\nexport var context = (context = canvas(1,1))\n  ? context.getContext('2d')\n  : null;\n","import {context} from './canvas/context';\nimport Bounds from '../Bounds';\n\nconst b = new Bounds();\n\nexport function intersectPath(draw) {\n  return function(item, brush) {\n    // rely on (inaccurate) bounds intersection if no context\n    if (!context) return true;\n\n    // add path to offscreen graphics context\n    draw(context, item);\n\n    // get bounds intersection region\n    b.clear().union(item.bounds).intersect(brush).round();\n    const {x1, y1, x2, y2} = b;\n\n    // iterate over intersection region\n    // perform fine grained inclusion test\n    for (let y = y1; y <= y2; ++y) {\n      for (let x = x1; x <= x2; ++x) {\n        if (context.isPointInPath(x, y)) {\n          return true;\n        }\n      }\n    }\n\n    // false if no hits in intersection region\n    return false;\n  };\n}\n\nexport function intersectPoint(item, box) {\n  return box.contains(item.x || 0, item.y || 0);\n}\n\nexport function intersectRect(item, box) {\n  const x = item.x || 0,\n        y = item.y || 0,\n        w = item.width || 0,\n        h = item.height || 0;\n  return box.intersects(b.set(x, y, x + w, y + h));\n}\n\nexport function intersectRule(item, box) {\n  const x = item.x || 0,\n        y = item.y || 0,\n        x2 = item.x2 != null ? item.x2 : x,\n        y2 = item.y2 != null ? item.y2 : y;\n  return intersectBoxLine(box, x, y, x2, y2);\n}\n\nexport function intersectBoxLine(box, x, y, u, v) {\n  const {x1, y1, x2, y2} = box,\n        dx = u - x,\n        dy = v - y;\n\n  let t0 = 0, t1 = 1, p, q, r, e;\n\n  for (e=0; e<4; ++e) {\n    if (e === 0) { p = -dx; q = -(x1 - x); }\n    if (e === 1) { p =  dx; q =  (x2 - x); }\n    if (e === 2) { p = -dy; q = -(y1 - y); }\n    if (e === 3) { p =  dy; q =  (y2 - y); }\n\n    if (Math.abs(p) < 1e-10 && q < 0) return false;\n\n    r = q / p;\n\n    if (p < 0) {\n      if (r > t1) return false;\n      else if (r > t0) t0 = r;\n    } else if (p > 0) {\n      if (r < t0) return false;\n      else if (r < t1) t1 = r;\n    }\n  }\n\n  return true;\n}\n","export default function(context, item) {\n  context.globalCompositeOperation = item.blend || 'source-over';\n}\n","export default function(value, dflt) {\n  return value == null ? dflt : value;\n}\n","import value from '../value';\nimport {canvas} from 'vega-canvas';\n\nfunction addStops(gradient, stops) {\n  const n = stops.length;\n  for (let i=0; i<n; ++i) {\n    gradient.addColorStop(stops[i].offset, stops[i].color);\n  }\n  return gradient;\n}\n\nexport default function(context, spec, bounds) {\n  const w = bounds.width(),\n        h = bounds.height();\n  let gradient;\n\n\n  if (spec.gradient === 'radial') {\n    gradient = context.createRadialGradient(\n      bounds.x1 + value(spec.x1, 0.5) * w,\n      bounds.y1 + value(spec.y1, 0.5) * h,\n      Math.max(w, h) * value(spec.r1, 0),\n      bounds.x1 + value(spec.x2, 0.5) * w,\n      bounds.y1 + value(spec.y2, 0.5) * h,\n      Math.max(w, h) * value(spec.r2, 0.5)\n    );\n  } else { // linear gradient\n    const x1 = value(spec.x1, 0),\n          y1 = value(spec.y1, 0),\n          x2 = value(spec.x2, 1),\n          y2 = value(spec.y2, 0);\n\n    if (x1 === x2 || y1 === y2 || w === h) {\n      // axis aligned: use normal gradient\n      gradient = context.createLinearGradient(\n        bounds.x1 + x1 * w,\n        bounds.y1 + y1 * h,\n        bounds.x1 + x2 * w,\n        bounds.y1 + y2 * h\n      );\n    } else {\n      // not axis aligned: render gradient into a pattern (#2365)\n      // this allows us to use normalized bounding box coordinates\n      const image = canvas(Math.ceil(w), Math.ceil(h)),\n            ictx = image.getContext('2d');\n\n      ictx.scale(w, h);\n      ictx.fillStyle = addStops(\n        ictx.createLinearGradient(x1, y1, x2, y2),\n        spec.stops\n      );\n      ictx.fillRect(0, 0, w, h);\n\n      return context.createPattern(image, 'no-repeat');\n    }\n  }\n\n  return addStops(gradient, spec.stops);\n}\n","import {isGradient} from '../../Gradient';\nimport gradient from './gradient';\n\nexport default function(context, item, value) {\n  return isGradient(value)\n    ? gradient(context, value, item.bounds)\n    : value;\n}\n","import color from './color';\n\nexport default function(context, item, opacity) {\n  opacity *= (item.fillOpacity==null ? 1 : item.fillOpacity);\n  if (opacity > 0) {\n    context.globalAlpha = opacity;\n    context.fillStyle = color(context, item, item.fill);\n    return true;\n  } else {\n    return false;\n  }\n}\n","import color from './color';\n\nvar Empty = [];\n\nexport default function(context, item, opacity) {\n  var lw = (lw = item.strokeWidth) != null ? lw : 1;\n\n  if (lw <= 0) return false;\n\n  opacity *= (item.strokeOpacity==null ? 1 : item.strokeOpacity);\n  if (opacity > 0) {\n    context.globalAlpha = opacity;\n    context.strokeStyle = color(context, item, item.stroke);\n\n    context.lineWidth = lw;\n    context.lineCap = item.strokeCap || 'butt';\n    context.lineJoin = item.strokeJoin || 'miter';\n    context.miterLimit = item.strokeMiterLimit || 10;\n\n    if (context.setLineDash) {\n      context.setLineDash(item.strokeDash || Empty);\n      context.lineDashOffset = item.strokeDashOffset || 0;\n    }\n    return true;\n  } else {\n    return false;\n  }\n}\n","function compare(a, b) {\n  return a.zindex - b.zindex || a.index - b.index;\n}\n\nexport function zorder(scene) {\n  if (!scene.zdirty) return scene.zitems;\n\n  var items = scene.items,\n      output = [], item, i, n;\n\n  for (i=0, n=items.length; i<n; ++i) {\n    item = items[i];\n    item.index = i;\n    if (item.zindex) output.push(item);\n  }\n\n  scene.zdirty = false;\n  return scene.zitems = output.sort(compare);\n}\n\nexport function visit(scene, visitor) {\n  var items = scene.items, i, n;\n  if (!items || !items.length) return;\n\n  const zitems = zorder(scene);\n\n  if (zitems && zitems.length) {\n    for (i=0, n=items.length; i<n; ++i) {\n      if (!items[i].zindex) visitor(items[i]);\n    }\n    items = zitems;\n  }\n\n  for (i=0, n=items.length; i<n; ++i) {\n    visitor(items[i]);\n  }\n}\n\nexport function pickVisit(scene, visitor) {\n  var items = scene.items, hit, i;\n  if (!items || !items.length) return null;\n\n  const zitems = zorder(scene);\n  if (zitems && zitems.length) items = zitems;\n\n  for (i=items.length; --i >= 0;) {\n    if (hit = visitor(items[i])) return hit;\n  }\n\n  if (items === zitems) {\n    for (items=scene.items, i=items.length; --i >= 0;) {\n      if (!items[i].zindex) {\n        if (hit = visitor(items[i])) return hit;\n      }\n    }\n  }\n\n  return null;\n}\n","import blend from './blend';\nimport fill from './fill';\nimport stroke from './stroke';\nimport {visit} from '../visit';\n\nexport function drawAll(path) {\n  return function(context, scene, bounds) {\n    visit(scene, item => {\n      if (!bounds || bounds.intersects(item.bounds)) {\n        drawPath(path, context, item, item);\n      }\n    });\n  };\n}\n\nexport function drawOne(path) {\n  return function(context, scene, bounds) {\n    if (scene.items.length && (!bounds || bounds.intersects(scene.bounds))) {\n      drawPath(path, context, scene.items[0], scene.items);\n    }\n  };\n}\n\nfunction drawPath(path, context, item, items) {\n  var opacity = item.opacity == null ? 1 : item.opacity;\n  if (opacity === 0) return;\n\n  if (path(context, items)) return;\n\n  blend(context, item);\n\n  if (item.fill && fill(context, item, opacity)) {\n    context.fill();\n  }\n\n  if (item.stroke && stroke(context, item, opacity)) {\n    context.stroke();\n  }\n}\n","import {pickVisit} from '../visit';\nimport {truthy} from 'vega-util';\n\nexport function pick(test) {\n  test = test || truthy;\n\n  return function(context, scene, x, y, gx, gy) {\n    x *= context.pixelRatio;\n    y *= context.pixelRatio;\n\n    return pickVisit(scene, item => {\n      const b = item.bounds;\n      // first hit test against bounding box\n      if ((b && !b.contains(gx, gy)) || !b) return;\n      // if in bounding box, perform more careful test\n      if (test(context, item, x, y, gx, gy)) return item;\n    });\n  };\n}\n\nexport function hitPath(path, filled) {\n  return function(context, o, x, y) {\n    var item = Array.isArray(o) ? o[0] : o,\n        fill = (filled == null) ? item.fill : filled,\n        stroke = item.stroke && context.isPointInStroke, lw, lc;\n\n    if (stroke) {\n      lw = item.strokeWidth;\n      lc = item.strokeCap;\n      context.lineWidth = lw != null ? lw : 1;\n      context.lineCap   = lc != null ? lc : 'butt';\n    }\n\n    return path(context, o) ? false :\n      (fill && context.isPointInPath(x, y)) ||\n      (stroke && context.isPointInStroke(x, y));\n  };\n}\n\nexport function pickPath(path) {\n  return pick(hitPath(path));\n}\n","export function translate(x, y) {\n  return 'translate(' + x + ',' + y + ')';\n}\n\nexport function rotate(a) {\n  return 'rotate(' + a + ')';\n}\n\nexport function scale(scaleX, scaleY){\n  return 'scale('+ scaleX + ',' + scaleY+')';\n}\n\nexport function translateItem(item) {\n  return translate(item.x || 0, item.y || 0);\n}\n\nexport function rotateItem(item) {\n  return translate(item.x || 0, item.y || 0)\n    + (item.angle ? ' ' + rotate(item.angle) : '');\n}\n\nexport function transformItem(item) {\n  return translate(item.x || 0, item.y || 0)\n    + (item.angle ? ' ' + rotate(item.angle) : '')\n    + (item.scaleX || item.scaleY ? ' ' + scale(item.scaleX || 1, item.scaleY || 1) : '');\n}\n","import boundStroke from '../bound/boundStroke';\nimport context from '../bound/boundContext';\nimport {intersectPath} from '../util/intersect';\nimport {drawAll} from '../util/canvas/draw';\nimport {pickPath} from '../util/canvas/pick';\nimport {rotateItem} from '../util/svg/transform';\nimport {DegToRad} from '../util/constants';\n\nexport default function(type, shape, isect) {\n\n  function attr(emit, item) {\n    emit('transform', rotateItem(item));\n    emit('d', shape(null, item));\n  }\n\n  function bound(bounds, item) {\n    shape(context(bounds, item.angle), item);\n    return boundStroke(bounds, item).translate(item.x || 0, item.y || 0);\n  }\n\n  function draw(context, item) {\n    var x = item.x || 0,\n        y = item.y || 0,\n        a = item.angle || 0;\n\n    context.translate(x, y);\n    if (a) context.rotate(a *= DegToRad);\n    context.beginPath();\n    shape(context, item);\n    if (a) context.rotate(-a);\n    context.translate(-x, -y);\n  }\n\n  return {\n    type:   type,\n    tag:    'path',\n    nested: false,\n    attr:   attr,\n    bound:  bound,\n    draw:   drawAll(draw),\n    pick:   pickPath(draw),\n    isect:  isect || intersectPath(draw)\n  };\n\n}\n","import {arc} from '../path/shapes';\nimport markItemPath from './markItemPath';\n\nexport default markItemPath('arc', arc);\n","import boundStroke from '../bound/boundStroke';\nimport context from '../bound/boundContext';\nimport {intersectPoint} from '../util/intersect';\nimport {drawOne} from '../util/canvas/draw';\nimport {hitPath} from '../util/canvas/pick';\n\nexport default function(type, shape, tip) {\n\n  function attr(emit, item) {\n    var items = item.mark.items;\n    if (items.length) emit('d', shape(null, items));\n  }\n\n  function bound(bounds, mark) {\n    var items = mark.items;\n    if (items.length === 0) {\n      return bounds;\n    } else {\n      shape(context(bounds), items);\n      return boundStroke(bounds, items[0]);\n    }\n  }\n\n  function draw(context, items) {\n    context.beginPath();\n    shape(context, items);\n  }\n\n  const hit = hitPath(draw);\n\n  function pick(context, scene, x, y, gx, gy) {\n    var items = scene.items,\n        b = scene.bounds;\n\n    if (!items || !items.length || b && !b.contains(gx, gy)) {\n      return null;\n    }\n\n    x *= context.pixelRatio;\n    y *= context.pixelRatio;\n    return hit(context, items, x, y) ? items[0] : null;\n  }\n\n  return {\n    type:   type,\n    tag:    'path',\n    nested: true,\n    attr:   attr,\n    bound:  bound,\n    draw:   drawOne(draw),\n    pick:   pick,\n    isect:  intersectPoint,\n    tip:    tip\n  };\n\n}\n\n\n","import {area} from '../path/shapes';\nimport {pickArea} from '../util/pickPath';\nimport markMultiItemPath from './markMultiItemPath';\n\nexport default markMultiItemPath('area', area, pickArea);\n","export function pickArea(a, p) {\n  var v = a[0].orient === 'horizontal' ? p[1] : p[0],\n      z = a[0].orient === 'horizontal' ? 'y' : 'x',\n      i = a.length,\n      min = +Infinity, hit, d;\n\n  while (--i >= 0) {\n    if (a[i].defined === false) continue;\n    d = Math.abs(a[i][z] - v);\n    if (d < min) {\n      min = d;\n      hit = a[i];\n    }\n  }\n\n  return hit;\n}\n\nexport function pickLine(a, p) {\n  var t = Math.pow(a[0].strokeWidth || 1, 2),\n      i = a.length, dx, dy, dd;\n\n  while (--i >= 0) {\n    if (a[i].defined === false) continue;\n    dx = a[i].x - p[0];\n    dy = a[i].y - p[1];\n    dd = dx * dx + dy * dy;\n    if (dd < t) return a[i];\n  }\n\n  return null;\n}\n\nexport function pickTrail(a, p) {\n  var i = a.length, dx, dy, dd;\n\n  while (--i >= 0) {\n    if (a[i].defined === false) continue;\n    dx = a[i].x - p[0];\n    dy = a[i].y - p[1];\n    dd = dx * dx + dy * dy;\n    dx = a[i].size || 1;\n    if (dd < dx*dx) return a[i];\n  }\n\n  return null;\n}\n","import {hasCornerRadius, rectangle} from '../../path/shapes';\nimport {isFunction} from 'vega-util';\n\nexport default function(context, scene) {\n  var clip = scene.clip;\n\n  context.save();\n\n  if (isFunction(clip)) {\n    context.beginPath();\n    clip(context);\n    context.clip();\n  } else {\n    clipGroup(context, scene.group);\n  }\n}\n\nexport function clipGroup(context, group) {\n  context.beginPath();\n  hasCornerRadius(group)\n    ? rectangle(context, group, 0, 0)\n    : context.rect(0, 0, group.width || 0, group.height || 0);\n  context.clip();\n}\n","import {hasCornerRadius, rectangle} from '../path/shapes';\nimport boundStroke from '../bound/boundStroke';\nimport {intersectRect} from '../util/intersect';\nimport value from '../util/value';\nimport {pickVisit, visit} from '../util/visit';\nimport blend from '../util/canvas/blend';\nimport {clipGroup} from '../util/canvas/clip';\nimport fill from '../util/canvas/fill';\nimport stroke from '../util/canvas/stroke';\nimport {hitPath} from '../util/canvas/pick';\nimport clip from '../util/svg/clip';\nimport {translateItem} from '../util/svg/transform';\n\nfunction offset(item) {\n  const sw = value(item.strokeWidth, 1);\n  return item.strokeOffset != null ? item.strokeOffset\n    : item.stroke && sw > 0.5 && sw < 1.5 ? 0.5 - Math.abs(sw - 1)\n    : 0;\n}\n\nfunction attr(emit, item) {\n  emit('transform', translateItem(item));\n}\n\nfunction emitRectangle(emit, item) {\n  const off = offset(item);\n  emit('d', rectangle(null, item, off, off));\n}\n\nfunction background(emit, item) {\n  emit('class', 'background');\n  emit('aria-hidden', true);\n  emitRectangle(emit, item);\n}\n\nfunction foreground(emit, item) {\n  emit('class', 'foreground');\n  emit('aria-hidden', true);\n  if (item.strokeForeground) {\n    emitRectangle(emit, item);\n  } else {\n    emit('d', '');\n  }\n}\n\nfunction content(emit, item, renderer) {\n  const url = item.clip ? clip(renderer, item, item) : null;\n  emit('clip-path', url);\n}\n\nfunction bound(bounds, group) {\n  if (!group.clip && group.items) {\n    const items = group.items, m = items.length;\n    for (let j=0; j<m; ++j) {\n      bounds.union(items[j].bounds);\n    }\n  }\n\n  if ((group.clip || group.width || group.height) && !group.noBound) {\n    bounds.add(0, 0).add(group.width || 0, group.height || 0);\n  }\n\n  boundStroke(bounds, group);\n\n  return bounds.translate(group.x || 0, group.y || 0);\n}\n\nfunction rectanglePath(context, group, x, y) {\n  const off = offset(group);\n  context.beginPath();\n  rectangle(context, group, (x || 0) + off, (y || 0) + off);\n}\n\nconst hitBackground = hitPath(rectanglePath);\nconst hitForeground = hitPath(rectanglePath, false);\nconst hitCorner = hitPath(rectanglePath, true);\n\nfunction draw(context, scene, bounds) {\n  visit(scene, group => {\n    const gx = group.x || 0,\n          gy = group.y || 0,\n          fore = group.strokeForeground,\n          opacity = group.opacity == null ? 1 : group.opacity;\n\n    // draw group background\n    if ((group.stroke || group.fill) && opacity) {\n      rectanglePath(context, group, gx, gy);\n      blend(context, group);\n      if (group.fill && fill(context, group, opacity)) {\n        context.fill();\n      }\n      if (group.stroke && !fore && stroke(context, group, opacity)) {\n        context.stroke();\n      }\n    }\n\n    // setup graphics context, set clip and bounds\n    context.save();\n    context.translate(gx, gy);\n    if (group.clip) clipGroup(context, group);\n    if (bounds) bounds.translate(-gx, -gy);\n\n    // draw group contents\n    visit(group, item => {\n      this.draw(context, item, bounds);\n    });\n\n    // restore graphics context\n    if (bounds) bounds.translate(gx, gy);\n    context.restore();\n\n    // draw group foreground\n    if (fore && group.stroke && opacity) {\n      rectanglePath(context, group, gx, gy);\n      blend(context, group);\n      if (stroke(context, group, opacity)) {\n        context.stroke();\n      }\n    }\n  });\n}\n\nfunction pick(context, scene, x, y, gx, gy) {\n  if (scene.bounds && !scene.bounds.contains(gx, gy) || !scene.items) {\n    return null;\n  }\n\n  const cx = x * context.pixelRatio,\n        cy = y * context.pixelRatio;\n\n  return pickVisit(scene, group => {\n    let hit, dx, dy;\n\n    // first hit test bounding box\n    const b = group.bounds;\n    if (b && !b.contains(gx, gy)) return;\n\n    // passed bounds check, test rectangular clip\n    dx = group.x || 0;\n    dy = group.y || 0;\n    const dw = dx + (group.width || 0),\n          dh = dy + (group.height || 0),\n          c = group.clip;\n    if (c && (gx < dx || gx > dw || gy < dy || gy > dh)) return;\n\n    // adjust coordinate system\n    context.save();\n    context.translate(dx, dy);\n    dx = gx - dx;\n    dy = gy - dy;\n\n    // test background for rounded corner clip\n    if (c && hasCornerRadius(group) && !hitCorner(context, group, cx, cy)) {\n      context.restore();\n      return null;\n    }\n\n    const fore = group.strokeForeground,\n          ix = scene.interactive !== false;\n\n    // hit test against group foreground\n    if (ix && fore && group.stroke\n        && hitForeground(context, group, cx, cy)) {\n      context.restore();\n      return group;\n    }\n\n    // hit test against contained marks\n    hit = pickVisit(group, mark => pickMark(mark, dx, dy)\n      ? this.pick(mark, x, y, dx, dy)\n      : null\n    );\n\n    // hit test against group background\n    if (!hit && ix && (group.fill || (!fore && group.stroke))\n        && hitBackground(context, group, cx, cy)) {\n      hit = group;\n    }\n\n    // restore state and return\n    context.restore();\n    return hit || null;\n  });\n}\n\nfunction pickMark(mark, x, y) {\n  return (mark.interactive !== false || mark.marktype === 'group')\n    && mark.bounds && mark.bounds.contains(x, y);\n}\n\nexport default {\n  type:       'group',\n  tag:        'g',\n  nested:     false,\n  attr:       attr,\n  bound:      bound,\n  draw:       draw,\n  pick:       pick,\n  isect:      intersectRect,\n  content:    content,\n  background: background,\n  foreground: foreground\n};\n","export default {\n  'xmlns': 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  'version': '1.1'\n};","import {visit} from '../util/visit';\nimport blend from '../util/canvas/blend';\nimport {pick} from '../util/canvas/pick';\nimport metadata from '../util/svg/metadata';\nimport {translate} from '../util/svg/transform';\nimport {truthy} from 'vega-util';\n\nfunction getImage(item, renderer) {\n  var image = item.image;\n  if (!image || item.url && item.url !== image.url) {\n    image = {complete: false, width: 0, height: 0};\n    renderer.loadImage(item.url).then(image => {\n      item.image = image;\n      item.image.url = item.url;\n    });\n  }\n  return image;\n}\n\nfunction imageWidth(item, image) {\n  return item.width != null ? item.width\n    : !image || !image.width ? 0\n    : item.aspect !== false && item.height ? item.height * image.width / image.height\n    : image.width;\n}\n\nfunction imageHeight(item, image) {\n  return item.height != null ? item.height\n    : !image || !image.height ? 0\n    : item.aspect !== false && item.width ? item.width * image.height / image.width\n    : image.height;\n}\n\nfunction imageXOffset(align, w) {\n  return align === 'center' ? w / 2 : align === 'right' ? w : 0;\n}\n\nfunction imageYOffset(baseline, h) {\n  return baseline === 'middle' ? h / 2 : baseline === 'bottom' ? h : 0;\n}\n\nfunction attr(emit, item, renderer) {\n  const img = getImage(item, renderer),\n        w = imageWidth(item, img),\n        h = imageHeight(item, img),\n        x = (item.x || 0) - imageXOffset(item.align, w),\n        y = (item.y || 0) - imageYOffset(item.baseline, h),\n        i = !img.src && img.toDataURL ? img.toDataURL() : img.src || '';\n\n  emit('href', i, metadata['xmlns:xlink'], 'xlink:href');\n  emit('transform', translate(x, y));\n  emit('width', w);\n  emit('height', h);\n  emit('preserveAspectRatio', item.aspect === false ? 'none' : 'xMidYMid');\n}\n\nfunction bound(bounds, item) {\n  const img = item.image,\n        w = imageWidth(item, img),\n        h = imageHeight(item, img),\n        x = (item.x || 0) - imageXOffset(item.align, w),\n        y = (item.y || 0) - imageYOffset(item.baseline, h);\n\n  return bounds.set(x, y, x + w, y + h);\n}\n\nfunction draw(context, scene, bounds) {\n  visit(scene, item => {\n    if (bounds && !bounds.intersects(item.bounds)) return; // bounds check\n\n    const img = getImage(item, this);\n\n    let w = imageWidth(item, img);\n    let h = imageHeight(item, img);\n    if (w === 0 || h === 0) return; // early exit\n\n    let x = (item.x || 0) - imageXOffset(item.align, w),\n        y = (item.y || 0) - imageYOffset(item.baseline, h),\n        opacity, ar0, ar1, t;\n\n    if (item.aspect !== false) {\n      ar0 = img.width / img.height;\n      ar1 = item.width / item.height;\n      if (ar0 === ar0 && ar1 === ar1 && ar0 !== ar1) {\n        if (ar1 < ar0) {\n          t = w / ar0;\n          y += (h - t) / 2;\n          h = t;\n        } else {\n          t = h * ar0;\n          x += (w - t) / 2;\n          w = t;\n        }\n      }\n    }\n\n    if (img.complete || img.toDataURL) {\n      blend(context, item);\n      context.globalAlpha = (opacity = item.opacity) != null ? opacity : 1;\n      context.imageSmoothingEnabled = item.smooth !== false;\n      context.drawImage(img, x, y, w, h);\n    }\n  });\n}\n\nexport default {\n  type:     'image',\n  tag:      'image',\n  nested:   false,\n  attr:     attr,\n  bound:    bound,\n  draw:     draw,\n  pick:     pick(),\n  isect:    truthy, // bounds check is sufficient\n  get:      getImage,\n  xOffset:  imageXOffset,\n  yOffset:  imageYOffset\n};\n","import {line} from '../path/shapes';\nimport {pickLine} from '../util/pickPath';\nimport markMultiItemPath from './markMultiItemPath';\n\nexport default markMultiItemPath('line', line, pickLine);\n","import boundStroke from '../bound/boundStroke';\nimport context from '../bound/boundContext';\nimport pathParse from '../path/parse';\nimport pathRender from '../path/render';\nimport {intersectPath} from '../util/intersect';\nimport {drawAll} from '../util/canvas/draw';\nimport {pickPath} from '../util/canvas/pick';\nimport {transformItem} from '../util/svg/transform';\nimport {DegToRad} from '../util/constants';\n\nfunction attr(emit, item) {\n  var sx = item.scaleX || 1,\n      sy = item.scaleY || 1;\n  if (sx !== 1 || sy !== 1) {\n    emit('vector-effect', 'non-scaling-stroke');\n  }\n  emit('transform', transformItem(item));\n  emit('d', item.path);\n}\n\nfunction path(context, item) {\n  var path = item.path;\n  if (path == null) return true;\n\n  var x = item.x || 0,\n      y = item.y || 0,\n      sx = item.scaleX || 1,\n      sy = item.scaleY || 1,\n      a = (item.angle || 0) * DegToRad,\n      cache = item.pathCache;\n\n  if (!cache || cache.path !== path) {\n    (item.pathCache = cache = pathParse(path)).path = path;\n  }\n\n  if (a && context.rotate && context.translate) {\n    context.translate(x, y);\n    context.rotate(a);\n    pathRender(context, cache, 0, 0, sx, sy);\n    context.rotate(-a);\n    context.translate(-x, -y);\n  } else {\n    pathRender(context, cache, x, y, sx, sy);\n  }\n}\n\nfunction bound(bounds, item) {\n  return path(context(bounds, item.angle), item)\n    ? bounds.set(0, 0, 0, 0)\n    : boundStroke(bounds, item, true);\n}\n\nexport default {\n  type:   'path',\n  tag:    'path',\n  nested: false,\n  attr:   attr,\n  bound:  bound,\n  draw:   drawAll(path),\n  pick:   pickPath(path),\n  isect:  intersectPath(path)\n};\n","import boundStroke from '../bound/boundStroke';\nimport {rectangle} from '../path/shapes';\nimport {intersectRect} from '../util/intersect';\nimport {drawAll} from '../util/canvas/draw';\nimport {pickPath} from '../util/canvas/pick';\n\nfunction attr(emit, item) {\n  emit('d', rectangle(null, item));\n}\n\nfunction bound(bounds, item) {\n  var x, y;\n  return boundStroke(bounds.set(\n    x = item.x || 0,\n    y = item.y || 0,\n    (x + item.width) || 0,\n    (y + item.height) || 0\n  ), item);\n}\n\nfunction draw(context, item) {\n  context.beginPath();\n  rectangle(context, item);\n}\n\nexport default {\n  type:   'rect',\n  tag:    'path',\n  nested: false,\n  attr:   attr,\n  bound:  bound,\n  draw:   drawAll(draw),\n  pick:   pickPath(draw),\n  isect:  intersectRect\n};\n","import boundStroke from '../bound/boundStroke';\nimport {intersectRule} from '../util/intersect';\nimport {visit} from '../util/visit';\nimport blend from '../util/canvas/blend';\nimport {pick} from '../util/canvas/pick';\nimport stroke from '../util/canvas/stroke';\nimport {translateItem} from '../util/svg/transform';\n\nfunction attr(emit, item) {\n  emit('transform', translateItem(item));\n  emit('x2', item.x2 != null ? item.x2 - (item.x || 0) : 0);\n  emit('y2', item.y2 != null ? item.y2 - (item.y || 0) : 0);\n}\n\nfunction bound(bounds, item) {\n  var x1, y1;\n  return boundStroke(bounds.set(\n    x1 = item.x || 0,\n    y1 = item.y || 0,\n    item.x2 != null ? item.x2 : x1,\n    item.y2 != null ? item.y2 : y1\n  ), item);\n}\n\nfunction path(context, item, opacity) {\n  var x1, y1, x2, y2;\n\n  if (item.stroke && stroke(context, item, opacity)) {\n    x1 = item.x || 0;\n    y1 = item.y || 0;\n    x2 = item.x2 != null ? item.x2 : x1;\n    y2 = item.y2 != null ? item.y2 : y1;\n    context.beginPath();\n    context.moveTo(x1, y1);\n    context.lineTo(x2, y2);\n    return true;\n  }\n  return false;\n}\n\nfunction draw(context, scene, bounds) {\n  visit(scene, item => {\n    if (bounds && !bounds.intersects(item.bounds)) return; // bounds check\n    var opacity = item.opacity == null ? 1 : item.opacity;\n    if (opacity && path(context, item, opacity)) {\n      blend(context, item);\n      context.stroke();\n    }\n  });\n}\n\nfunction hit(context, item, x, y) {\n  if (!context.isPointInStroke) return false;\n  return path(context, item, 1) && context.isPointInStroke(x, y);\n}\n\nexport default {\n  type:   'rule',\n  tag:    'line',\n  nested: false,\n  attr:   attr,\n  bound:  bound,\n  draw:   draw,\n  pick:   pick(hit),\n  isect:  intersectRule\n};\n","import {shape} from '../path/shapes';\nimport markItemPath from './markItemPath';\n\nexport default markItemPath('shape', shape);\n","import {symbol} from '../path/shapes';\nimport {intersectPoint} from '../util/intersect';\nimport markItemPath from './markItemPath';\n\nexport default markItemPath('symbol', symbol, intersectPoint);\n","import {context} from './canvas/context';\nimport {isArray, lruCache} from 'vega-util';\n\n// memoize text width measurement\nconst widthCache = lruCache();\n\nexport var textMetrics = {\n  height: fontSize,\n  measureWidth: measureWidth,\n  estimateWidth: estimateWidth,\n  width: estimateWidth,\n  canvas: useCanvas\n};\n\nuseCanvas(true);\n\nfunction useCanvas(use) {\n  textMetrics.width = (use && context) ? measureWidth : estimateWidth;\n}\n\n// make simple estimate if no canvas is available\nfunction estimateWidth(item, text) {\n  return _estimateWidth(textValue(item, text), fontSize(item));\n}\n\nfunction _estimateWidth(text, currentFontHeight) {\n  return ~~(0.8 * text.length * currentFontHeight);\n}\n\n// measure text width if canvas is available\nfunction measureWidth(item, text) {\n  return fontSize(item) <= 0 || !(text = textValue(item, text)) ? 0\n    : _measureWidth(text, font(item));\n}\n\nfunction _measureWidth(text, currentFont) {\n  const key = `(${currentFont}) ${text}`;\n  let width = widthCache.get(key);\n  if (width === undefined) {\n    context.font = currentFont;\n    width = context.measureText(text).width;\n    widthCache.set(key, width);\n  }\n  return width;\n}\n\nexport function fontSize(item) {\n  return item.fontSize != null ? (+item.fontSize || 0) : 11;\n}\n\nexport function lineHeight(item) {\n  return item.lineHeight != null ? item.lineHeight : (fontSize(item) + 2);\n}\n\nfunction lineArray(_) {\n  return isArray(_) ? _.length > 1 ? _ : _[0] : _;\n}\n\nexport function textLines(item) {\n  return lineArray(\n    item.lineBreak && item.text && !isArray(item.text)\n      ? item.text.split(item.lineBreak)\n      : item.text\n  );\n}\n\nexport function multiLineOffset(item) {\n  const tl = textLines(item);\n  return (isArray(tl) ? (tl.length - 1) : 0) * lineHeight(item);\n}\n\nexport function textValue(item, line) {\n  const text = line == null ? '' : (line + '').trim();\n  return item.limit > 0 && text.length ? truncate(item, text) : text;\n}\n\nfunction widthGetter(item) {\n  if (textMetrics.width === measureWidth) {\n    // we are using canvas\n    const currentFont = font(item);\n    return text => _measureWidth(text, currentFont);\n  } else {\n    // we are relying on estimates\n    const currentFontHeight = fontSize(item);\n    return text => _estimateWidth(text, currentFontHeight);\n  }\n}\n\nfunction truncate(item, text) {\n  var limit = +item.limit,\n      width = widthGetter(item);\n\n  if (width(text) < limit) return text;\n\n  var ellipsis = item.ellipsis || '\\u2026',\n      rtl = item.dir === 'rtl',\n      lo = 0,\n      hi = text.length, mid;\n\n  limit -= width(ellipsis);\n\n  if (rtl) {\n    while (lo < hi) {\n      mid = (lo + hi >>> 1);\n      if (width(text.slice(mid)) > limit) lo = mid + 1;\n      else hi = mid;\n    }\n    return ellipsis + text.slice(lo);\n  } else {\n    while (lo < hi) {\n      mid = 1 + (lo + hi >>> 1);\n      if (width(text.slice(0, mid)) < limit) lo = mid;\n      else hi = mid - 1;\n    }\n    return text.slice(0, lo) + ellipsis;\n  }\n}\n\nexport function fontFamily(item, quote) {\n  var font = item.font;\n  return (quote && font\n    ? String(font).replace(/\"/g, '\\'')\n    : font) || 'sans-serif';\n}\n\nexport function font(item, quote) {\n  return '' +\n    (item.fontStyle ? item.fontStyle + ' ' : '') +\n    (item.fontVariant ? item.fontVariant + ' ' : '') +\n    (item.fontWeight ? item.fontWeight + ' ' : '') +\n    fontSize(item) + 'px ' +\n    fontFamily(item, quote);\n}\n\nexport function offset(item) {\n  // perform our own font baseline calculation\n  // why? not all browsers support SVG 1.1 'alignment-baseline' :(\n  // this also ensures consistent layout across renderers\n  var baseline = item.baseline,\n      h = fontSize(item);\n\n  return Math.round(\n    baseline === 'top'         ?  0.79 * h :\n    baseline === 'middle'      ?  0.30 * h :\n    baseline === 'bottom'      ? -0.21 * h :\n    baseline === 'line-top'    ?  0.29 * h + 0.5 * lineHeight(item) :\n    baseline === 'line-bottom' ?  0.29 * h - 0.5 * lineHeight(item) : 0\n  );\n}\n","import Bounds from '../Bounds';\nimport {DegToRad, HalfPi} from '../util/constants';\nimport {font, lineHeight, offset, textLines, textMetrics, textValue} from '../util/text';\nimport {intersectBoxLine} from '../util/intersect';\nimport {visit} from '../util/visit';\nimport blend from '../util/canvas/blend';\nimport fill from '../util/canvas/fill';\nimport {pick} from '../util/canvas/pick';\nimport stroke from '../util/canvas/stroke';\nimport {rotate, translate} from '../util/svg/transform';\nimport {isArray} from 'vega-util';\n\nconst textAlign = {\n  'left':   'start',\n  'center': 'middle',\n  'right':  'end'\n};\n\nconst tempBounds = new Bounds();\n\nfunction anchorPoint(item) {\n  var x = item.x || 0,\n      y = item.y || 0,\n      r = item.radius || 0, t;\n\n  if (r) {\n    t = (item.theta || 0) - HalfPi;\n    x += r * Math.cos(t);\n    y += r * Math.sin(t);\n  }\n\n  tempBounds.x1 = x;\n  tempBounds.y1 = y;\n  return tempBounds;\n}\n\nfunction attr(emit, item) {\n  var dx = item.dx || 0,\n      dy = (item.dy || 0) + offset(item),\n      p = anchorPoint(item),\n      x = p.x1,\n      y = p.y1,\n      a = item.angle || 0, t;\n\n  emit('text-anchor', textAlign[item.align] || 'start');\n\n  if (a) {\n    t = translate(x, y) + ' ' + rotate(a);\n    if (dx || dy) t += ' ' + translate(dx, dy);\n  } else {\n    t = translate(x + dx, y + dy);\n  }\n  emit('transform', t);\n}\n\nfunction bound(bounds, item, mode) {\n  var h = textMetrics.height(item),\n      a = item.align,\n      p = anchorPoint(item),\n      x = p.x1,\n      y = p.y1,\n      dx = item.dx || 0,\n      dy = (item.dy || 0) + offset(item) - Math.round(0.8*h), // use 4/5 offset\n      tl = textLines(item),\n      w;\n\n  // get dimensions\n  if (isArray(tl)) {\n    // multi-line text\n    h += lineHeight(item) * (tl.length - 1);\n    w = tl.reduce((w, t) => Math.max(w, textMetrics.width(item, t)), 0);\n  } else {\n    // single-line text\n    w = textMetrics.width(item, tl);\n  }\n\n  // horizontal alignment\n  if (a === 'center') {\n    dx -= (w / 2);\n  } else if (a === 'right') {\n    dx -= w;\n  } else {\n    // left by default, do nothing\n  }\n\n  bounds.set(dx+=x, dy+=y, dx+w, dy+h);\n\n  if (item.angle && !mode) {\n    bounds.rotate(item.angle * DegToRad, x, y);\n  } else if (mode === 2) {\n    return bounds.rotatedPoints(item.angle * DegToRad, x, y);\n  }\n  return bounds;\n}\n\nfunction draw(context, scene, bounds) {\n  visit(scene, item => {\n    var opacity = item.opacity == null ? 1 : item.opacity,\n        p, x, y, i, lh, tl, str;\n\n    if (bounds && !bounds.intersects(item.bounds) || // bounds check\n        opacity === 0 || item.fontSize <= 0 ||\n        item.text == null || item.text.length === 0) return;\n\n    context.font = font(item);\n    context.textAlign = item.align || 'left';\n\n    p = anchorPoint(item);\n    x = p.x1,\n    y = p.y1;\n\n    if (item.angle) {\n      context.save();\n      context.translate(x, y);\n      context.rotate(item.angle * DegToRad);\n      x = y = 0; // reset x, y\n    }\n    x += (item.dx || 0);\n    y += (item.dy || 0) + offset(item);\n\n    tl = textLines(item);\n    blend(context, item);\n    if (isArray(tl)) {\n      lh = lineHeight(item);\n      for (i=0; i<tl.length; ++i) {\n        str = textValue(item, tl[i]);\n        if (item.fill && fill(context, item, opacity)) {\n          context.fillText(str, x, y);\n        }\n        if (item.stroke && stroke(context, item, opacity)) {\n          context.strokeText(str, x, y);\n        }\n        y += lh;\n      }\n    } else {\n      str = textValue(item, tl);\n      if (item.fill && fill(context, item, opacity)) {\n        context.fillText(str, x, y);\n      }\n      if (item.stroke && stroke(context, item, opacity)) {\n        context.strokeText(str, x, y);\n      }\n    }\n\n    if (item.angle) context.restore();\n  });\n}\n\nfunction hit(context, item, x, y, gx, gy) {\n  if (item.fontSize <= 0) return false;\n  if (!item.angle) return true; // bounds sufficient if no rotation\n\n  // project point into space of unrotated bounds\n  var p = anchorPoint(item),\n      ax = p.x1,\n      ay = p.y1,\n      b = bound(tempBounds, item, 1),\n      a = -item.angle * DegToRad,\n      cos = Math.cos(a),\n      sin = Math.sin(a),\n      px = cos * gx - sin * gy + (ax - cos * ax + sin * ay),\n      py = sin * gx + cos * gy + (ay - sin * ax - cos * ay);\n\n  return b.contains(px, py);\n}\n\nfunction intersectText(item, box) {\n  const p = bound(tempBounds, item, 2);\n  return intersectBoxLine(box, p[0], p[1], p[2], p[3])\n      || intersectBoxLine(box, p[0], p[1], p[4], p[5])\n      || intersectBoxLine(box, p[4], p[5], p[6], p[7])\n      || intersectBoxLine(box, p[2], p[3], p[6], p[7]);\n}\n\nexport default {\n  type:   'text',\n  tag:    'text',\n  nested: false,\n  attr:   attr,\n  bound:  bound,\n  draw:   draw,\n  pick:   pick(hit),\n  isect:  intersectText\n};\n","import {trail} from '../path/shapes';\nimport {pickTrail} from '../util/pickPath';\nimport markMultiItemPath from './markMultiItemPath';\n\nexport default markMultiItemPath('trail', trail, pickTrail);\n","import arc from './arc';\nimport area from './area';\nimport group from './group';\nimport image from './image';\nimport line from './line';\nimport path from './path';\nimport rect from './rect';\nimport rule from './rule';\nimport shape from './shape';\nimport symbol from './symbol';\nimport text from './text';\nimport trail from './trail';\n\nexport default {\n  arc:     arc,\n  area:    area,\n  group:   group,\n  image:   image,\n  line:    line,\n  path:    path,\n  rect:    rect,\n  rule:    rule,\n  shape:   shape,\n  symbol:  symbol,\n  text:    text,\n  trail:   trail\n};\n","import Bounds from '../Bounds';\nimport marks from '../marks/index';\n\nexport default function(item, func, opt) {\n  var type = marks[item.mark.marktype],\n      bound = func || type.bound;\n  if (type.nested) item = item.mark;\n\n  return bound(item.bounds || (item.bounds = new Bounds()), item, opt);\n}\n","import Bounds from '../Bounds';\nimport boundItem from './boundItem';\nimport marks from '../marks/index';\n\nvar DUMMY = {mark: null};\n\nexport default function(mark, bounds, opt) {\n  var type  = marks[mark.marktype],\n      bound = type.bound,\n      items = mark.items,\n      hasItems = items && items.length,\n      i, n, item, b;\n\n  if (type.nested) {\n    if (hasItems) {\n      item = items[0];\n    } else {\n      // no items, fake it\n      DUMMY.mark = mark;\n      item = DUMMY;\n    }\n    b = boundItem(item, bound, opt);\n    bounds = bounds && bounds.union(b) || b;\n    return bounds;\n  }\n\n  bounds = bounds\n    || mark.bounds && mark.bounds.clear()\n    || new Bounds();\n\n  if (hasItems) {\n    for (i=0, n=items.length; i<n; ++i) {\n      bounds.union(boundItem(items[i], bound, opt));\n    }\n  }\n\n  return mark.bounds = bounds;\n}\n","import boundMark from '../bound/boundMark';\n\nconst keys = [\n  'marktype', 'name', 'role', 'interactive', 'clip', 'items', 'zindex',\n  'x', 'y', 'width', 'height', 'align', 'baseline',             // layout\n  'fill', 'fillOpacity', 'opacity', 'blend',                    // fill\n  'stroke', 'strokeOpacity', 'strokeWidth', 'strokeCap',        // stroke\n  'strokeDash', 'strokeDashOffset',                             // stroke dash\n  'strokeForeground', 'strokeOffset',                           // group\n  'startAngle', 'endAngle', 'innerRadius', 'outerRadius',       // arc\n  'cornerRadius', 'padAngle',                                   // arc, rect\n  'cornerRadiusTopLeft', 'cornerRadiusTopRight',                // rect, group\n  'cornerRadiusBottomLeft', 'cornerRadiusBottomRight',\n  'interpolate', 'tension', 'orient', 'defined',                // area, line\n  'url', 'aspect', 'smooth',                                    // image\n  'path', 'scaleX', 'scaleY',                                   // path\n  'x2', 'y2',                                                   // rule\n  'size', 'shape',                                              // symbol\n  'text', 'angle', 'theta', 'radius', 'dir', 'dx', 'dy',        // text\n  'ellipsis', 'limit', 'lineBreak', 'lineHeight',\n  'font', 'fontSize', 'fontWeight', 'fontStyle', 'fontVariant', // font\n  'description', 'aria', 'ariaRole', 'ariaRoleDescription'      // aria\n];\n\nexport function sceneToJSON(scene, indent) {\n  return JSON.stringify(scene, keys, indent);\n}\n\nexport function sceneFromJSON(json) {\n  const scene = (typeof json === 'string' ? JSON.parse(json) : json);\n  return initialize(scene);\n}\n\nfunction initialize(scene) {\n  var type = scene.marktype,\n      items = scene.items,\n      parent, i, n;\n\n  if (items) {\n    for (i=0, n=items.length; i<n; ++i) {\n      parent = type ? 'mark' : 'group';\n      items[i][parent] = scene;\n      if (items[i].zindex) items[i][parent].zdirty = true;\n      if ('group' === (type || parent)) initialize(items[i]);\n    }\n  }\n\n  if (type) boundMark(scene);\n  return scene;\n}\n","import Bounds from './Bounds';\nimport GroupItem from './GroupItem';\nimport {sceneFromJSON, sceneToJSON} from './util/serialize';\n\nexport default function Scenegraph(scene) {\n  if (arguments.length) {\n    this.root = sceneFromJSON(scene);\n  } else {\n    this.root = createMark({\n      marktype: 'group',\n      name: 'root',\n      role: 'frame'\n    });\n    this.root.items = [new GroupItem(this.root)];\n  }\n}\n\nScenegraph.prototype = {\n  toJSON(indent) {\n    return sceneToJSON(this.root, indent || 0);\n  },\n\n  mark(markdef, group, index) {\n    group = group || this.root.items[0];\n    const mark = createMark(markdef, group);\n    group.items[index] = mark;\n    if (mark.zindex) mark.group.zdirty = true;\n    return mark;\n  }\n};\n\nfunction createMark(def, group) {\n  const mark = {\n    bounds:      new Bounds(),\n    clip:        !!def.clip,\n    group:       group,\n    interactive: def.interactive === false ? false : true,\n    items:       [],\n    marktype:    def.marktype,\n    name:        def.name || undefined,\n    role:        def.role || undefined,\n    zindex:      def.zindex || 0\n  };\n\n  // add accessibility properties if defined\n  if (def.aria != null) {\n    mark.aria = def.aria;\n  }\n  if (def.description) {\n    mark.description = def.description;\n  }\n\n  return mark;\n}\n","// create a new DOM element\nexport function domCreate(doc, tag, ns) {\n  if (!doc && typeof document !== 'undefined' && document.createElement) {\n    doc = document;\n  }\n  return doc\n    ? (ns ? doc.createElementNS(ns, tag) : doc.createElement(tag))\n    : null;\n}\n\n// find first child element with matching tag\nexport function domFind(el, tag) {\n  tag = tag.toLowerCase();\n  var nodes = el.childNodes, i = 0, n = nodes.length;\n  for (; i<n; ++i) if (nodes[i].tagName.toLowerCase() === tag) {\n    return nodes[i];\n  }\n}\n\n// retrieve child element at given index\n// create & insert if doesn't exist or if tags do not match\nexport function domChild(el, index, tag, ns) {\n  var a = el.childNodes[index], b;\n  if (!a || a.tagName.toLowerCase() !== tag.toLowerCase()) {\n    b = a || null;\n    a = domCreate(el.ownerDocument, tag, ns);\n    el.insertBefore(a, b);\n  }\n  return a;\n}\n\n// remove all child elements at or above the given index\nexport function domClear(el, index) {\n  var nodes = el.childNodes,\n      curr = nodes.length;\n  while (curr > index) el.removeChild(nodes[--curr]);\n  return el;\n}\n\n// generate css class name for mark\nexport function cssClass(mark) {\n  return 'mark-' + mark.marktype\n    + (mark.role ? ' role-' + mark.role : '')\n    + (mark.name ? ' ' + mark.name : '');\n}\n","export default function(event, el) {\n  const rect = el.getBoundingClientRect();\n  return [\n    event.clientX - rect.left - (el.clientLeft || 0),\n    event.clientY - rect.top - (el.clientTop || 0)\n  ];\n}\n","import {domCreate} from './util/dom';\nimport resolveItem from './util/resolveItem';\nimport {loader} from 'vega-loader';\n\n/**\n * Create a new Handler instance.\n * @param {object} [customLoader] - Optional loader instance for\n *   href URL sanitization. If not specified, a standard loader\n *   instance will be generated.\n * @param {function} [customTooltip] - Optional tooltip handler\n *   function for custom tooltip display.\n * @constructor\n */\nexport default function Handler(customLoader, customTooltip) {\n  this._active = null;\n  this._handlers = {};\n  this._loader = customLoader || loader();\n  this._tooltip = customTooltip || defaultTooltip;\n}\n\n// The default tooltip display handler.\n// Sets the HTML title attribute on the visualization container.\nfunction defaultTooltip(handler, event, item, value) {\n  handler.element().setAttribute('title', value || '');\n}\n\nHandler.prototype = {\n  /**\n   * Initialize a new Handler instance.\n   * @param {DOMElement} el - The containing DOM element for the display.\n   * @param {Array<number>} origin - The origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {object} [obj] - Optional context object that should serve as\n   *   the \"this\" context for event callbacks.\n   * @return {Handler} - This handler instance.\n   */\n  initialize(el, origin, obj) {\n    this._el = el;\n    this._obj = obj || null;\n    return this.origin(origin);\n  },\n\n  /**\n   * Returns the parent container element for a visualization.\n   * @return {DOMElement} - The containing DOM element.\n   */\n  element() {\n    return this._el;\n  },\n\n  /**\n   * Returns the scene element (e.g., canvas or SVG) of the visualization\n   * Subclasses must override if the first child is not the scene element.\n   * @return {DOMElement} - The scene (e.g., canvas or SVG) element.\n   */\n  canvas() {\n    return this._el && this._el.firstChild;\n  },\n\n  /**\n   * Get / set the origin coordinates of the visualization.\n   */\n  origin(origin) {\n    if (arguments.length) {\n      this._origin = origin || [0, 0];\n      return this;\n    } else {\n      return this._origin.slice();\n    }\n  },\n\n  /**\n   * Get / set the scenegraph root.\n   */\n  scene(scene) {\n    if (!arguments.length) return this._scene;\n    this._scene = scene;\n    return this;\n  },\n\n  /**\n   * Add an event handler. Subclasses should override this method.\n   */\n  on(/*type, handler*/) {},\n\n  /**\n   * Remove an event handler. Subclasses should override this method.\n   */\n  off(/*type, handler*/) {},\n\n  /**\n   * Utility method for finding the array index of an event handler.\n   * @param {Array} h - An array of registered event handlers.\n   * @param {string} type - The event type.\n   * @param {function} handler - The event handler instance to find.\n   * @return {number} - The handler's array index or -1 if not registered.\n   */\n  _handlerIndex(h, type, handler) {\n    for (let i = h ? h.length : 0; --i>=0;) {\n      if (h[i].type === type && (!handler || h[i].handler === handler)) {\n        return i;\n      }\n    }\n    return -1;\n  },\n\n  /**\n   * Returns an array with registered event handlers.\n   * @param {string} [type] - The event type to query. Any annotations\n   *   are ignored; for example, for the argument \"click.foo\", \".foo\" will\n   *   be ignored and the method returns all \"click\" handlers. If type is\n   *   null or unspecified, this method returns handlers for all types.\n   * @return {Array} - A new array containing all registered event handlers.\n   */\n  handlers(type) {\n    const h = this._handlers, a = [];\n    if (type) {\n      a.push(...h[this.eventName(type)]);\n    } else {\n      for (const k in h) { a.push(...h[k]); }\n    }\n    return a;\n  },\n\n  /**\n   * Parses an event name string to return the specific event type.\n   * For example, given \"click.foo\" returns \"click\"\n   * @param {string} name - The input event type string.\n   * @return {string} - A string with the event type only.\n   */\n  eventName(name) {\n    const i = name.indexOf('.');\n    return i < 0 ? name : name.slice(0, i);\n  },\n\n  /**\n   * Handle hyperlink navigation in response to an item.href value.\n   * @param {Event} event - The event triggering hyperlink navigation.\n   * @param {Item} item - The scenegraph item.\n   * @param {string} href - The URL to navigate to.\n   */\n  handleHref(event, item, href) {\n    this._loader\n      .sanitize(href, {context:'href'})\n      .then(opt => {\n        const e = new MouseEvent(event.type, event),\n              a = domCreate(null, 'a');\n        for (const name in opt) a.setAttribute(name, opt[name]);\n        a.dispatchEvent(e);\n      })\n      .catch(() => { /* do nothing */ });\n  },\n\n  /**\n   * Handle tooltip display in response to an item.tooltip value.\n   * @param {Event} event - The event triggering tooltip display.\n   * @param {Item} item - The scenegraph item.\n   * @param {boolean} show - A boolean flag indicating whether\n   *   to show or hide a tooltip for the given item.\n   */\n  handleTooltip(event, item, show) {\n    if (item && item.tooltip != null) {\n      item = resolveItem(item, event, this.canvas(), this._origin);\n      const value = (show && item && item.tooltip) || null;\n      this._tooltip.call(this._obj, this, event, item, value);\n    }\n  },\n\n  /**\n   * Returns the size of a scenegraph item and its position relative\n   * to the viewport.\n   * @param {Item} item - The scenegraph item.\n   * @return {object} - A bounding box object (compatible with the\n   *   DOMRect type) consisting of x, y, width, heigh, top, left,\n   *   right, and bottom properties.\n   */\n  getItemBoundingClientRect(item) {\n    const el = this.canvas();\n    if (!el) return;\n\n    const rect = el.getBoundingClientRect(),\n          origin = this._origin,\n          bounds = item.bounds,\n          width = bounds.width(),\n          height = bounds.height();\n\n    let x = bounds.x1 + origin[0] + rect.left,\n        y = bounds.y1 + origin[1] + rect.top;\n\n    // translate coordinate for each parent group\n    while (item.mark && (item = item.mark.group)) {\n      x += item.x || 0;\n      y += item.y || 0;\n    }\n\n    // return DOMRect-compatible bounding box\n    return {\n      x, y, width, height,\n      left: x, top: y, right: x + width, bottom: y + height\n    };\n  }\n};\n","import ResourceLoader from './ResourceLoader';\n\n/**\n * Create a new Renderer instance.\n * @param {object} [loader] - Optional loader instance for\n *   image and href URL sanitization. If not specified, a\n *   standard loader instance will be generated.\n * @constructor\n */\nexport default function Renderer(loader) {\n  this._el = null;\n  this._bgcolor = null;\n  this._loader = new ResourceLoader(loader);\n}\n\nRenderer.prototype = {\n  /**\n   * Initialize a new Renderer instance.\n   * @param {DOMElement} el - The containing DOM element for the display.\n   * @param {number} width - The coordinate width of the display, in pixels.\n   * @param {number} height - The coordinate height of the display, in pixels.\n   * @param {Array<number>} origin - The origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {number} [scaleFactor=1] - Optional scaleFactor by which to multiply\n   *   the width and height to determine the final pixel size.\n   * @return {Renderer} - This renderer instance.\n   */\n  initialize(el, width, height, origin, scaleFactor) {\n    this._el = el;\n    return this.resize(width, height, origin, scaleFactor);\n  },\n\n  /**\n   * Returns the parent container element for a visualization.\n   * @return {DOMElement} - The containing DOM element.\n   */\n  element() {\n    return this._el;\n  },\n\n  /**\n   * Returns the scene element (e.g., canvas or SVG) of the visualization\n   * Subclasses must override if the first child is not the scene element.\n   * @return {DOMElement} - The scene (e.g., canvas or SVG) element.\n   */\n  canvas() {\n    return this._el && this._el.firstChild;\n  },\n\n  /**\n   * Get / set the background color.\n   */\n  background(bgcolor) {\n    if (arguments.length === 0) return this._bgcolor;\n    this._bgcolor = bgcolor;\n    return this;\n  },\n\n  /**\n   * Resize the display.\n   * @param {number} width - The new coordinate width of the display, in pixels.\n   * @param {number} height - The new coordinate height of the display, in pixels.\n   * @param {Array<number>} origin - The new origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {number} [scaleFactor=1] - Optional scaleFactor by which to multiply\n   *   the width and height to determine the final pixel size.\n   * @return {Renderer} - This renderer instance;\n   */\n  resize(width, height, origin, scaleFactor) {\n    this._width = width;\n    this._height = height;\n    this._origin = origin || [0, 0];\n    this._scale = scaleFactor || 1;\n    return this;\n  },\n\n  /**\n   * Report a dirty item whose bounds should be redrawn.\n   * This base class method does nothing. Subclasses that perform\n   * incremental should implement this method.\n   * @param {Item} item - The dirty item whose bounds should be redrawn.\n   */\n  dirty(/*item*/) {},\n\n  /**\n   * Render an input scenegraph, potentially with a set of dirty items.\n   * This method will perform an immediate rendering with available resources.\n   * The renderer may also need to perform image loading to perform a complete\n   * render. This process can lead to asynchronous re-rendering of the scene\n   * after this method returns. To receive notification when rendering is\n   * complete, use the renderAsync method instead.\n   * @param {object} scene - The root mark of a scenegraph to render.\n   * @return {Renderer} - This renderer instance.\n   */\n  render(scene) {\n    const r = this;\n\n    // bind arguments into a render call, and cache it\n    // this function may be subsequently called for async redraw\n    r._call = function() { r._render(scene); };\n\n    // invoke the renderer\n    r._call();\n\n    // clear the cached call for garbage collection\n    // async redraws will stash their own copy\n    r._call = null;\n\n    return r;\n  },\n\n  /**\n   * Internal rendering method. Renderer subclasses should override this\n   * method to actually perform rendering.\n   * @param {object} scene - The root mark of a scenegraph to render.\n   */\n  _render(/*scene*/) {\n    // subclasses to override\n  },\n\n  /**\n   * Asynchronous rendering method. Similar to render, but returns a Promise\n   * that resolves when all rendering is completed. Sometimes a renderer must\n   * perform image loading to get a complete rendering. The returned\n   * Promise will not resolve until this process completes.\n   * @param {object} scene - The root mark of a scenegraph to render.\n   * @return {Promise} - A Promise that resolves when rendering is complete.\n   */\n  renderAsync(scene) {\n    const r = this.render(scene);\n    return this._ready\n      ? this._ready.then(() => r)\n      : Promise.resolve(r);\n  },\n\n  /**\n   * Internal method for asynchronous resource loading.\n   * Proxies method calls to the ImageLoader, and tracks loading\n   * progress to invoke a re-render once complete.\n   * @param {string} method - The method name to invoke on the ImageLoader.\n   * @param {string} uri - The URI for the requested resource.\n   * @return {Promise} - A Promise that resolves to the requested resource.\n   */\n  _load(method, uri) {\n    var r = this,\n        p = r._loader[method](uri);\n\n    if (!r._ready) {\n      // re-render the scene when loading completes\n      const call = r._call;\n      r._ready = r._loader.ready()\n        .then(redraw => {\n          if (redraw) call();\n          r._ready = null;\n        });\n    }\n\n    return p;\n  },\n\n  /**\n   * Sanitize a URL to include as a hyperlink in the rendered scene.\n   * This method proxies a call to ImageLoader.sanitizeURL, but also tracks\n   * image loading progress and invokes a re-render once complete.\n   * @param {string} uri - The URI string to sanitize.\n   * @return {Promise} - A Promise that resolves to the sanitized URL.\n   */\n  sanitizeURL(uri) {\n    return this._load('sanitizeURL', uri);\n  },\n\n  /**\n   * Requests an image to include in the rendered scene.\n   * This method proxies a call to ImageLoader.loadImage, but also tracks\n   * image loading progress and invokes a re-render once complete.\n   * @param {string} uri - The URI string of the image.\n   * @return {Promise} - A Promise that resolves to the loaded Image.\n   */\n  loadImage(uri) {\n    return this._load('loadImage', uri);\n  }\n};\n","import marks from '../marks/index';\nimport point from './point';\n\nexport default function(item, event, el, origin) {\n  var mark = item && item.mark,\n      mdef, p;\n\n  if (mark && (mdef = marks[mark.marktype]).tip) {\n    p = point(event, el);\n    p[0] -= origin[0];\n    p[1] -= origin[1];\n    while (item = item.mark.group) {\n      p[0] -= item.x || 0;\n      p[1] -= item.y || 0;\n    }\n    item = mdef.tip(mark.items, p);\n  }\n\n  return item;\n}\n","export const KeyDownEvent = 'keydown';\nexport const KeyPressEvent = 'keypress';\nexport const KeyUpEvent = 'keyup';\nexport const DragEnterEvent = 'dragenter';\nexport const DragLeaveEvent = 'dragleave';\nexport const DragOverEvent = 'dragover';\nexport const MouseDownEvent = 'mousedown';\nexport const MouseUpEvent = 'mouseup';\nexport const MouseMoveEvent = 'mousemove';\nexport const MouseOutEvent = 'mouseout';\nexport const MouseOverEvent = 'mouseover';\nexport const ClickEvent = 'click';\nexport const DoubleClickEvent = 'dblclick';\nexport const WheelEvent = 'wheel';\nexport const MouseWheelEvent = 'mousewheel';\nexport const TouchStartEvent = 'touchstart';\nexport const TouchMoveEvent = 'touchmove';\nexport const TouchEndEvent = 'touchend';\n\nexport const Events = [\n  KeyDownEvent,\n  KeyPressEvent,\n  KeyUpEvent,\n  DragEnterEvent,\n  DragLeaveEvent,\n  DragOverEvent,\n  MouseDownEvent,\n  MouseUpEvent,\n  MouseMoveEvent,\n  MouseOutEvent,\n  MouseOverEvent,\n  ClickEvent,\n  DoubleClickEvent,\n  WheelEvent,\n  MouseWheelEvent,\n  TouchStartEvent,\n  TouchMoveEvent,\n  TouchEndEvent\n];\n\nexport const TooltipShowEvent = MouseMoveEvent;\n\nexport const TooltipHideEvent = MouseOutEvent;\n\nexport const HrefEvent = ClickEvent;\n","import Handler from './Handler';\nimport Marks from './marks/index';\nimport {\n  ClickEvent, DragEnterEvent, DragLeaveEvent, DragOverEvent, Events,\n  HrefEvent, MouseDownEvent, MouseMoveEvent, MouseOutEvent, MouseOverEvent,\n  MouseWheelEvent, TooltipHideEvent, TooltipShowEvent,\n  TouchEndEvent, TouchMoveEvent, TouchStartEvent\n} from './util/events';\nimport point from './util/point';\nimport {domFind} from './util/dom';\nimport {inherits} from 'vega-util';\n\nexport default function CanvasHandler(loader, tooltip) {\n  Handler.call(this, loader, tooltip);\n  this._down = null;\n  this._touch = null;\n  this._first = true;\n  this._events = {};\n}\n\nconst eventBundle = type => (\n  type === TouchStartEvent ||\n  type === TouchMoveEvent ||\n  type === TouchEndEvent\n)\n? [TouchStartEvent, TouchMoveEvent, TouchEndEvent]\n: [type];\n\n// lazily add listeners to the canvas as needed\nfunction eventListenerCheck(handler, type) {\n  eventBundle(type).forEach(_ => addEventListener(handler, _));\n}\n\nfunction addEventListener(handler, type) {\n  const canvas = handler.canvas();\n  if (canvas && !handler._events[type]) {\n    handler._events[type] = 1;\n    canvas.addEventListener(type, handler[type]\n      ? evt => handler[type](evt)\n      : evt => handler.fire(type, evt)\n    );\n  }\n}\n\nfunction move(moveEvent, overEvent, outEvent) {\n  return function(evt) {\n    const a = this._active,\n          p = this.pickEvent(evt);\n\n    if (p === a) {\n      // active item and picked item are the same\n      this.fire(moveEvent, evt); // fire move\n    } else {\n      // active item and picked item are different\n      if (!a || !a.exit) {\n        // fire out for prior active item\n        // suppress if active item was removed from scene\n        this.fire(outEvent, evt);\n      }\n      this._active = p;          // set new active item\n      this.fire(overEvent, evt); // fire over for new active item\n      this.fire(moveEvent, evt); // fire move for new active item\n    }\n  };\n}\n\nfunction inactive(type) {\n  return function(evt) {\n    this.fire(type, evt);\n    this._active = null;\n  };\n}\n\ninherits(CanvasHandler, Handler, {\n  initialize(el, origin, obj) {\n    this._canvas = el && domFind(el, 'canvas');\n\n    // add minimal events required for proper state management\n    [ClickEvent, MouseDownEvent, MouseMoveEvent, MouseOutEvent, DragLeaveEvent]\n      .forEach(type => eventListenerCheck(this, type));\n\n    return Handler.prototype.initialize.call(this, el, origin, obj);\n  },\n\n  // return the backing canvas instance\n  canvas() {\n    return this._canvas;\n  },\n\n  // retrieve the current canvas context\n  context() {\n    return this._canvas.getContext('2d');\n  },\n\n  // supported events\n  events: Events,\n\n  // to keep old versions of firefox happy\n  DOMMouseScroll(evt) {\n    this.fire(MouseWheelEvent, evt);\n  },\n\n  mousemove: move(MouseMoveEvent, MouseOverEvent, MouseOutEvent),\n  dragover: move(DragOverEvent, DragEnterEvent, DragLeaveEvent),\n\n  mouseout: inactive(MouseOutEvent),\n  dragleave: inactive(DragLeaveEvent),\n\n  mousedown(evt) {\n    this._down = this._active;\n    this.fire(MouseDownEvent, evt);\n  },\n\n  click(evt) {\n    if (this._down === this._active) {\n      this.fire(ClickEvent, evt);\n      this._down = null;\n    }\n  },\n\n  touchstart(evt) {\n    this._touch = this.pickEvent(evt.changedTouches[0]);\n\n    if (this._first) {\n      this._active = this._touch;\n      this._first = false;\n    }\n\n    this.fire(TouchStartEvent, evt, true);\n  },\n\n  touchmove(evt) {\n    this.fire(TouchMoveEvent, evt, true);\n  },\n\n  touchend(evt) {\n    this.fire(TouchEndEvent, evt, true);\n    this._touch = null;\n  },\n\n  // fire an event\n  fire(type, evt, touch) {\n    const a = touch ? this._touch : this._active,\n          h = this._handlers[type];\n\n    // set event type relative to scenegraph items\n    evt.vegaType = type;\n\n    // handle hyperlinks and tooltips first\n    if (type === HrefEvent && a && a.href) {\n      this.handleHref(evt, a, a.href);\n    } else if (type === TooltipShowEvent || type === TooltipHideEvent) {\n      this.handleTooltip(evt, a, type !== TooltipHideEvent);\n    }\n\n    // invoke all registered handlers\n    if (h) {\n      for (let i=0, len=h.length; i<len; ++i) {\n        h[i].handler.call(this._obj, evt, a);\n      }\n    }\n  },\n\n  // add an event handler\n  on(type, handler) {\n    const name = this.eventName(type),\n          h = this._handlers,\n          i = this._handlerIndex(h[name], type, handler);\n\n    if (i < 0) {\n      eventListenerCheck(this, type);\n      (h[name] || (h[name] = [])).push({\n        type:    type,\n        handler: handler\n      });\n    }\n\n    return this;\n  },\n\n  // remove an event handler\n  off(type, handler) {\n    const name = this.eventName(type),\n          h = this._handlers[name],\n          i = this._handlerIndex(h, type, handler);\n\n    if (i >= 0) {\n      h.splice(i, 1);\n    }\n\n    return this;\n  },\n\n  pickEvent(evt) {\n    const p = point(evt, this._canvas),\n          o = this._origin;\n    return this.pick(this._scene, p[0], p[1], p[0] - o[0], p[1] - o[1]);\n  },\n\n  // find the scenegraph item at the current mouse position\n  // x, y -- the absolute x, y mouse coordinates on the canvas element\n  // gx, gy -- the relative coordinates within the current group\n  pick(scene, x, y, gx, gy) {\n    const g = this.context(),\n          mark = Marks[scene.marktype];\n    return mark.pick.call(this, g, scene, x, y, gx, gy);\n  }\n});\n","function devicePixelRatio() {\n  return typeof window !== 'undefined' ? window.devicePixelRatio || 1 : 1;\n}\n\nvar pixelRatio = devicePixelRatio();\n\nexport default function(canvas, width, height, origin, scaleFactor, opt) {\n  const inDOM = typeof HTMLElement !== 'undefined'\n              && canvas instanceof HTMLElement\n              && canvas.parentNode != null,\n        context = canvas.getContext('2d'),\n        ratio = inDOM ? pixelRatio : scaleFactor;\n\n  canvas.width = width * ratio;\n  canvas.height = height * ratio;\n\n  for (const key in opt) {\n    context[key] = opt[key];\n  }\n\n  if (inDOM && ratio !== 1) {\n    canvas.style.width = width + 'px';\n    canvas.style.height = height + 'px';\n  }\n\n  context.pixelRatio = ratio;\n  context.setTransform(\n    ratio, 0, 0, ratio,\n    ratio * origin[0],\n    ratio * origin[1]\n  );\n\n  return canvas;\n}\n","import Renderer from './Renderer';\nimport Bounds from './Bounds';\nimport marks from './marks/index';\n\nimport {domClear} from './util/dom';\nimport clip from './util/canvas/clip';\nimport resize from './util/canvas/resize';\nimport {canvas} from 'vega-canvas';\nimport {error, inherits} from 'vega-util';\n\nexport default function CanvasRenderer(loader) {\n  Renderer.call(this, loader);\n  this._options = {};\n  this._redraw = false;\n  this._dirty = new Bounds();\n  this._tempb = new Bounds();\n}\n\nconst base = Renderer.prototype;\n\nconst viewBounds = (origin, width, height) => new Bounds()\n  .set(0, 0, width, height)\n  .translate(-origin[0], -origin[1]);\n\nfunction clipToBounds(g, b, origin) {\n  // expand bounds by 1 pixel, then round to pixel boundaries\n  b.expand(1).round();\n\n  // align to base pixel grid in case of non-integer scaling (#2425)\n  if (g.pixelRatio % 1) {\n    b.scale(g.pixelRatio).round().scale(1 / g.pixelRatio);\n  }\n\n  // to avoid artifacts translate if origin has fractional pixels\n  b.translate(-(origin[0] % 1), -(origin[1] % 1));\n\n  // set clip path\n  g.beginPath();\n  g.rect(b.x1, b.y1, b.width(), b.height());\n  g.clip();\n\n  return b;\n}\n\ninherits(CanvasRenderer, Renderer, {\n  initialize(el, width, height, origin, scaleFactor, options) {\n    this._options = options || {};\n\n    this._canvas = this._options.externalContext\n      ? null\n      : canvas(1, 1, this._options.type); // instantiate a small canvas\n\n    if (el && this._canvas) {\n      domClear(el, 0).appendChild(this._canvas);\n      this._canvas.setAttribute('class', 'marks');\n    }\n\n    // this method will invoke resize to size the canvas appropriately\n    return base.initialize.call(this, el, width, height, origin, scaleFactor);\n  },\n\n  resize(width, height, origin, scaleFactor) {\n    base.resize.call(this, width, height, origin, scaleFactor);\n\n    if (this._canvas) {\n      // configure canvas size and transform\n      resize(this._canvas, this._width, this._height,\n        this._origin, this._scale, this._options.context);\n    } else {\n      // external context needs to be scaled and positioned to origin\n      const ctx = this._options.externalContext;\n      if (!ctx) error('CanvasRenderer is missing a valid canvas or context');\n      ctx.scale(this._scale, this._scale);\n      ctx.translate(this._origin[0], this._origin[1]);\n    }\n\n    this._redraw = true;\n    return this;\n  },\n\n  canvas() {\n    return this._canvas;\n  },\n\n  context() {\n    return this._options.externalContext\n      || (this._canvas ? this._canvas.getContext('2d') : null);\n  },\n\n  dirty(item) {\n    const b = this._tempb.clear().union(item.bounds);\n    let g = item.mark.group;\n\n    while (g) {\n      b.translate(g.x || 0, g.y || 0);\n      g = g.mark.group;\n    }\n\n    this._dirty.union(b);\n  },\n\n  _render(scene) {\n    const g = this.context(),\n          o = this._origin,\n          w = this._width,\n          h = this._height,\n          db = this._dirty,\n          vb = viewBounds(o, w, h);\n\n    // setup\n    g.save();\n    const b = this._redraw || db.empty()\n      ? (this._redraw = false, vb.expand(1))\n      : clipToBounds(g, vb.intersect(db), o);\n\n    this.clear(-o[0], -o[1], w, h);\n\n    // render\n    this.draw(g, scene, b);\n\n    // takedown\n    g.restore();\n    db.clear();\n\n    return this;\n  },\n\n  draw(ctx, scene, bounds) {\n    const mark = marks[scene.marktype];\n    if (scene.clip) clip(ctx, scene);\n    mark.draw.call(this, ctx, scene, bounds);\n    if (scene.clip) ctx.restore();\n  },\n\n  clear(x, y, w, h) {\n    const opt = this._options,\n          g = this.context();\n\n    if (opt.type !== 'pdf' && !opt.externalContext) {\n      // calling clear rect voids vector output in pdf mode\n      // and could remove external context content (#2615)\n      g.clearRect(x, y, w, h);\n    }\n\n    if (this._bgcolor != null) {\n      g.fillStyle = this._bgcolor;\n      g.fillRect(x, y, w, h);\n    }\n  }\n});\n","import Handler from './Handler';\nimport {domFind} from './util/dom';\nimport {HrefEvent, TooltipHideEvent, TooltipShowEvent} from './util/events';\nimport {inherits} from 'vega-util';\n\nexport default function SVGHandler(loader, tooltip) {\n  Handler.call(this, loader, tooltip);\n  const h = this;\n  h._hrefHandler = listener(h, (evt, item) => {\n    if (item && item.href) h.handleHref(evt, item, item.href);\n  });\n  h._tooltipHandler = listener(h, (evt, item) => {\n    h.handleTooltip(evt, item, evt.type !== TooltipHideEvent);\n  });\n}\n\n// wrap an event listener for the SVG DOM\nconst listener = (context, handler) => evt => {\n  let item = evt.target.__data__;\n  item = Array.isArray(item) ? item[0] : item;\n  evt.vegaType = evt.type;\n  handler.call(context._obj, evt, item);\n};\n\ninherits(SVGHandler, Handler, {\n  initialize(el, origin, obj) {\n    let svg = this._svg;\n    if (svg) {\n      svg.removeEventListener(HrefEvent, this._hrefHandler);\n      svg.removeEventListener(TooltipShowEvent, this._tooltipHandler);\n      svg.removeEventListener(TooltipHideEvent, this._tooltipHandler);\n    }\n    this._svg = svg = el && domFind(el, 'svg');\n    if (svg) {\n      svg.addEventListener(HrefEvent, this._hrefHandler);\n      svg.addEventListener(TooltipShowEvent, this._tooltipHandler);\n      svg.addEventListener(TooltipHideEvent, this._tooltipHandler);\n    }\n    return Handler.prototype.initialize.call(this, el, origin, obj);\n  },\n\n  canvas() {\n    return this._svg;\n  },\n\n  // add an event handler\n  on(type, handler) {\n    const name = this.eventName(type),\n          h = this._handlers,\n          i = this._handlerIndex(h[name], type, handler);\n\n    if (i < 0) {\n      const x = {\n        type,\n        handler,\n        listener: listener(this, handler)\n      };\n\n      (h[name] || (h[name] = [])).push(x);\n      if (this._svg) {\n        this._svg.addEventListener(name, x.listener);\n      }\n    }\n\n    return this;\n  },\n\n  // remove an event handler\n  off(type, handler) {\n    const name = this.eventName(type),\n          h = this._handlers[name],\n          i = this._handlerIndex(h, type, handler);\n\n    if (i >= 0) {\n      if (this._svg) {\n        this._svg.removeEventListener(name, h[i].listener);\n      }\n      h.splice(i, 1);\n    }\n\n    return this;\n  }\n});","import {domainCaption, isDiscrete} from 'vega-scale';\nimport {array, peek, toSet} from 'vega-util';\n\nconst ARIA_HIDDEN = 'aria-hidden';\nconst ARIA_LABEL = 'aria-label';\nconst ARIA_ROLE = 'role';\nconst ARIA_ROLEDESCRIPTION = 'aria-roledescription';\nconst GRAPHICS_OBJECT = 'graphics-object';\nconst GRAPHICS_SYMBOL = 'graphics-symbol';\n\nconst bundle = (role, roledesc, label) => ({\n  [ARIA_ROLE]: role,\n  [ARIA_ROLEDESCRIPTION]: roledesc,\n  [ARIA_LABEL]: label || undefined\n});\n\n// these roles are covered by related roles\n// we can ignore them, no need to generate attributes\nconst AriaIgnore = toSet([\n  'axis-domain',\n  'axis-grid',\n  'axis-label',\n  'axis-tick',\n  'axis-title',\n  'legend-band',\n  'legend-entry',\n  'legend-gradient',\n  'legend-label',\n  'legend-title',\n  'legend-symbol',\n  'title'\n]);\n\n// aria attribute generators for guide roles\nconst AriaGuides = {\n  'axis': {desc: 'axis', caption: axisCaption},\n  'legend': {desc: 'legend', caption: legendCaption},\n  'title-text': {\n    desc: 'title',\n    caption: item => `Title text '${titleCaption(item)}'`\n  },\n  'title-subtitle': {\n    desc: 'subtitle',\n    caption: item => `Subtitle text '${titleCaption(item)}'`\n  }\n};\n\n// aria properties generated for mark item encoding channels\nexport const AriaEncode = {\n  ariaRole: ARIA_ROLE,\n  ariaRoleDescription: ARIA_ROLEDESCRIPTION,\n  description: ARIA_LABEL\n};\n\nexport function ariaItemAttributes(emit, item) {\n  const hide = item.aria === false;\n  emit(ARIA_HIDDEN, hide || undefined);\n\n  if (hide || item.description == null) {\n    for (const prop in AriaEncode) {\n      emit(AriaEncode[prop], undefined);\n    }\n  } else {\n    const type = item.mark.marktype;\n    emit(\n      ARIA_LABEL,\n      item.description\n    );\n    emit(\n      ARIA_ROLE,\n      item.ariaRole || (type === 'group' ? GRAPHICS_OBJECT : GRAPHICS_SYMBOL)\n    );\n    emit(\n      ARIA_ROLEDESCRIPTION,\n      item.ariaRoleDescription || `${type} mark`\n    );\n  }\n}\n\nexport function ariaMarkAttributes(mark) {\n  return mark.aria === false ? { [ARIA_HIDDEN]: true }\n    : AriaIgnore[mark.role] ? null\n    : AriaGuides[mark.role] ? ariaGuide(mark, AriaGuides[mark.role])\n    : ariaMark(mark);\n}\n\nfunction ariaMark(mark) {\n  const type = mark.marktype;\n  const recurse = (\n    type === 'group' ||\n    type === 'text' ||\n    mark.items.some(_ => _.description != null && _.aria !== false)\n  );\n  return bundle(\n    recurse ? GRAPHICS_OBJECT : GRAPHICS_SYMBOL,\n    `${type} mark container`,\n    mark.description\n  );\n}\n\nfunction ariaGuide(mark, opt) {\n  try {\n    const item = mark.items[0],\n          caption = opt.caption || (() => '');\n    return bundle(\n      opt.role || GRAPHICS_SYMBOL,\n      opt.desc,\n      item.description || caption(item)\n    );\n  } catch (err) {\n    return null;\n  }\n}\n\nfunction titleCaption(item) {\n  return array(item.text).join(' ');\n}\n\nfunction axisCaption(item) {\n  const datum = item.datum,\n        orient = item.orient,\n        title = datum.title ? extractTitle(item) : null,\n        ctx = item.context,\n        scale = ctx.scales[datum.scale].value,\n        locale = ctx.dataflow.locale(),\n        type = scale.type,\n        xy = (orient === 'left' || orient === 'right') ? 'Y' : 'X';\n\n  return `${xy}-axis`\n    + (title ? ` titled '${title}'` : '')\n    + ` for a ${isDiscrete(type) ? 'discrete' : type} scale`\n    + ` with ${domainCaption(locale, scale, item)}`;\n}\n\nfunction legendCaption(item) {\n  const datum = item.datum,\n        title = datum.title ? extractTitle(item) : null,\n        type = `${datum.type || ''} legend`.trim(),\n        scales = datum.scales,\n        props = Object.keys(scales),\n        ctx = item.context,\n        scale = ctx.scales[scales[props[0]]].value,\n        locale = ctx.dataflow.locale();\n\n  return capitalize(type)\n    + (title ? ` titled '${title}'` : '')\n    + ` for ${channelCaption(props)}`\n    + ` with ${domainCaption(locale, scale, item)}`;\n}\n\nfunction extractTitle(item) {\n  try {\n    return array(peek(item.items).items[0].text).join(' ');\n  } catch (err) {\n    return null;\n  }\n}\n\nfunction channelCaption(props) {\n  props = props.map(p => p + (p === 'fill' || p === 'stroke' ? ' color' : ''));\n  return props.length < 2 ? props[0]\n    : props.slice(0, -1).join(', ') + ' and ' + peek(props);\n}\n\nfunction capitalize(s) {\n  return s.length ? s[0].toUpperCase() + s.slice(1) : s;\n}\n","const innerText = val => (val + '')\n  .replace(/&/g, '&amp;')\n  .replace(/</g, '&lt;')\n  .replace(/>/g, '&gt;');\n\nconst attrText = val => innerText(val)\n  .replace(/\"/g, '&quot;')\n  .replace(/\\t/g, '&#x9;')\n  .replace(/\\n/g, '&#xA;')\n  .replace(/\\r/g, '&#xD;');\n\nexport function markup() {\n  let buf = '',\n      outer = '',\n      inner = '';\n\n  const stack = [],\n        clear = () => outer = inner = '',\n        push = tag => {\n          if (outer) { buf += `${outer}>${inner}`; clear(); }\n          stack.push(tag);\n        },\n        attr = (name, value) => {\n          if (value != null) outer += ` ${name}=\"${attrText(value)}\"`;\n          return m;\n        },\n\n        m = {\n          open(tag, ...attrs) {\n            push(tag);\n            outer = '<' + tag;\n            for (const set of attrs) {\n              for (const key in set) attr(key, set[key]);\n            }\n            return m;\n          },\n          close() {\n            const tag = stack.pop();\n            if (outer) {\n              buf += outer + (inner\n                ? `>${inner}</${tag}>`\n                : '/>');\n            } else {\n              buf += `</${tag}>`;\n            }\n            clear();\n            return m;\n          },\n          attr,\n          text: t => (inner += innerText(t), m),\n          toString: () => buf\n        };\n\n  return m;\n}\n\nexport const serializeXML = node =>\n  _serialize(markup(), node) + '';\n\nfunction _serialize(m, node) {\n  m.open(node.tagName);\n\n  if (node.hasAttributes()) {\n    const attrs = node.attributes,\n          n = attrs.length;\n    for (let i=0; i<n; ++i) {\n      m.attr(attrs[i].name, attrs[i].value);\n    }\n  }\n\n  if (node.hasChildNodes()) {\n    const children = node.childNodes;\n\n    for (const child of children) {\n      child.nodeType === 3 // text node\n        ? m.text(child.nodeValue)\n        : _serialize(m, child);\n    }\n  }\n\n  return m.close();\n}\n","export const stylesAttr = {\n  fill:             'fill',\n  fillOpacity:      'fill-opacity',\n  stroke:           'stroke',\n  strokeOpacity:    'stroke-opacity',\n  strokeWidth:      'stroke-width',\n  strokeCap:        'stroke-linecap',\n  strokeJoin:       'stroke-linejoin',\n  strokeDash:       'stroke-dasharray',\n  strokeDashOffset: 'stroke-dashoffset',\n  strokeMiterLimit: 'stroke-miterlimit',\n  opacity:          'opacity'\n};\n\nexport const stylesCss = {\n  blend:            'mix-blend-mode'\n};\n\n// ensure miter limit default is consistent with canvas (#2498)\nexport const rootAttributes = {\n  'fill': 'none',\n  'stroke-miterlimit': 10\n};\n","import Renderer from './Renderer';\nimport {gradientRef, isGradient, patternPrefix} from './Gradient';\nimport marks from './marks/index';\nimport {ariaItemAttributes, ariaMarkAttributes} from './util/aria';\nimport {cssClass, domChild, domClear, domCreate} from './util/dom';\nimport {serializeXML} from './util/markup';\nimport {fontFamily, fontSize, lineHeight, textLines, textValue} from './util/text';\nimport {visit} from './util/visit';\nimport clip from './util/svg/clip';\nimport metadata from './util/svg/metadata';\nimport {rootAttributes, stylesAttr, stylesCss} from './util/svg/styles';\nimport {inherits, isArray} from 'vega-util';\n\nconst RootIndex = 0,\n      xmlns = 'http://www.w3.org/2000/xmlns/',\n      svgns = metadata.xmlns;\n\nexport default function SVGRenderer(loader) {\n  Renderer.call(this, loader);\n  this._dirtyID = 0;\n  this._dirty = [];\n  this._svg = null;\n  this._root = null;\n  this._defs = null;\n}\n\nconst base = Renderer.prototype;\n\ninherits(SVGRenderer, Renderer, {\n  /**\n   * Initialize a new SVGRenderer instance.\n   * @param {DOMElement} el - The containing DOM element for the display.\n   * @param {number} width - The coordinate width of the display, in pixels.\n   * @param {number} height - The coordinate height of the display, in pixels.\n   * @param {Array<number>} origin - The origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {number} [scaleFactor=1] - Optional scaleFactor by which to multiply\n   *   the width and height to determine the final pixel size.\n   * @return {SVGRenderer} - This renderer instance.\n   */\n  initialize(el, width, height, origin, scaleFactor) {\n    // create the svg definitions cache\n    this._defs = {};\n    this._clearDefs();\n\n    if (el) {\n      this._svg = domChild(el, 0, 'svg', svgns);\n      this._svg.setAttributeNS(xmlns, 'xmlns', svgns);\n      this._svg.setAttributeNS(xmlns, 'xmlns:xlink', metadata['xmlns:xlink']);\n      this._svg.setAttribute('version', metadata['version']);\n      this._svg.setAttribute('class', 'marks');\n      domClear(el, 1);\n\n      // set the svg root group\n      this._root = domChild(this._svg, RootIndex, 'g', svgns);\n      setAttributes(this._root, rootAttributes);\n\n      // ensure no additional child elements\n      domClear(this._svg, RootIndex + 1);\n    }\n\n    // set background color if defined\n    this.background(this._bgcolor);\n\n    return base.initialize.call(this, el, width, height, origin, scaleFactor);\n  },\n\n  /**\n   * Get / set the background color.\n   */\n  background(bgcolor) {\n    if (arguments.length && this._svg) {\n      this._svg.style.setProperty('background-color', bgcolor);\n    }\n    return base.background.apply(this, arguments);\n  },\n\n  /**\n   * Resize the display.\n   * @param {number} width - The new coordinate width of the display, in pixels.\n   * @param {number} height - The new coordinate height of the display, in pixels.\n   * @param {Array<number>} origin - The new origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {number} [scaleFactor=1] - Optional scaleFactor by which to multiply\n   *   the width and height to determine the final pixel size.\n   * @return {SVGRenderer} - This renderer instance;\n   */\n  resize(width, height, origin, scaleFactor) {\n    base.resize.call(this, width, height, origin, scaleFactor);\n\n    if (this._svg) {\n      setAttributes(this._svg, {\n        width: this._width * this._scale,\n        height: this._height * this._scale,\n        viewBox: `0 0 ${this._width} ${this._height}`\n      });\n      this._root.setAttribute('transform', `translate(${this._origin})`);\n    }\n\n    this._dirty = [];\n\n    return this;\n  },\n\n  /**\n   * Returns the SVG element of the visualization.\n   * @return {DOMElement} - The SVG element.\n   */\n  canvas() {\n    return this._svg;\n  },\n\n  /**\n   * Returns an SVG text string for the rendered content,\n   * or null if this renderer is currently headless.\n   */\n  svg() {\n    const svg = this._svg,\n          bg = this._bgcolor;\n\n    if (!svg) return null;\n\n    let node;\n    if (bg) {\n      svg.removeAttribute('style');\n      node = domChild(svg, RootIndex, 'rect', svgns);\n      setAttributes(node, {width: this._width, height: this._height, fill: bg});\n    }\n\n    const text = serializeXML(svg);\n\n    if (bg) {\n      svg.removeChild(node);\n      this._svg.style.setProperty('background-color', bg);\n    }\n\n    return text;\n  },\n\n  /**\n   * Internal rendering method.\n   * @param {object} scene - The root mark of a scenegraph to render.\n   */\n  _render(scene) {\n    // perform spot updates and re-render markup\n    if (this._dirtyCheck()) {\n      if (this._dirtyAll) this._clearDefs();\n      this.mark(this._root, scene);\n      domClear(this._root, 1);\n    }\n\n    this.defs();\n\n    this._dirty = [];\n    ++this._dirtyID;\n\n    return this;\n  },\n\n  // -- Manage rendering of items marked as dirty --\n\n  /**\n   * Flag a mark item as dirty.\n   * @param {Item} item - The mark item.\n   */\n  dirty(item) {\n    if (item.dirty !== this._dirtyID) {\n      item.dirty = this._dirtyID;\n      this._dirty.push(item);\n    }\n  },\n\n  /**\n   * Check if a mark item is considered dirty.\n   * @param {Item} item - The mark item.\n   */\n  isDirty(item) {\n    return this._dirtyAll\n      || !item._svg\n      || !item._svg.ownerSVGElement\n      || item.dirty === this._dirtyID;\n  },\n\n  /**\n   * Internal method to check dirty status and, if possible,\n   * make targetted updates without a full rendering pass.\n   */\n  _dirtyCheck() {\n    this._dirtyAll = true;\n    const items = this._dirty;\n    if (!items.length || !this._dirtyID) return true;\n\n    const id = ++this._dirtyID;\n    let item, mark, type, mdef, i, n, o;\n\n    for (i=0, n=items.length; i<n; ++i) {\n      item = items[i];\n      mark = item.mark;\n\n      if (mark.marktype !== type) {\n        // memoize mark instance lookup\n        type = mark.marktype;\n        mdef = marks[type];\n      }\n\n      if (mark.zdirty && mark.dirty !== id) {\n        this._dirtyAll = false;\n        dirtyParents(item, id);\n        mark.items.forEach(i => { i.dirty = id; });\n      }\n      if (mark.zdirty) continue; // handle in standard drawing pass\n\n      if (item.exit) { // EXIT\n        if (mdef.nested && mark.items.length) {\n          // if nested mark with remaining points, update instead\n          o = mark.items[0];\n          if (o._svg) this._update(mdef, o._svg, o);\n        } else if (item._svg) {\n          // otherwise remove from DOM\n          o = item._svg.parentNode;\n          if (o) o.removeChild(item._svg);\n        }\n        item._svg = null;\n        continue;\n      }\n\n      item = (mdef.nested ? mark.items[0] : item);\n      if (item._update === id) continue; // already visited\n\n      if (!item._svg || !item._svg.ownerSVGElement) {\n        // ENTER\n        this._dirtyAll = false;\n        dirtyParents(item, id);\n      } else {\n        // IN-PLACE UPDATE\n        this._update(mdef, item._svg, item);\n      }\n      item._update = id;\n    }\n    return !this._dirtyAll;\n  },\n\n  // -- Construct & maintain scenegraph to SVG mapping ---\n\n  /**\n   * Render a set of mark items.\n   * @param {SVGElement} el - The parent element in the SVG tree.\n   * @param {object} scene - The mark parent to render.\n   * @param {SVGElement} prev - The previous sibling in the SVG tree.\n   */\n  mark(el, scene, prev) {\n    if (!this.isDirty(scene)) {\n      return scene._svg;\n    }\n\n    const svg = this._svg,\n          mdef = marks[scene.marktype],\n          events = scene.interactive === false ? 'none' : null,\n          isGroup = mdef.tag === 'g';\n\n    const parent = bind(scene, el, prev, 'g', svg);\n    parent.setAttribute('class', cssClass(scene));\n\n    // apply aria attributes to parent container element\n    const aria = ariaMarkAttributes(scene);\n    for (const key in aria) setAttribute(parent, key, aria[key]);\n\n    if (!isGroup) {\n      setAttribute(parent, 'pointer-events', events);\n    }\n    setAttribute(parent, 'clip-path',\n      scene.clip ? clip(this, scene, scene.group) : null);\n\n    let sibling = null,\n        i = 0;\n\n    const process = item => {\n      const dirty = this.isDirty(item),\n            node = bind(item, parent, sibling, mdef.tag, svg);\n\n      if (dirty) {\n        this._update(mdef, node, item);\n        if (isGroup) recurse(this, node, item);\n      }\n\n      sibling = node;\n      ++i;\n    };\n\n    if (mdef.nested) {\n      if (scene.items.length) process(scene.items[0]);\n    } else {\n      visit(scene, process);\n    }\n\n    domClear(parent, i);\n    return parent;\n  },\n\n  /**\n   * Update the attributes of an SVG element for a mark item.\n   * @param {object} mdef - The mark definition object\n   * @param {SVGElement} el - The SVG element.\n   * @param {Item} item - The mark item.\n   */\n  _update(mdef, el, item) {\n    // set dom element and values cache\n    // provides access to emit method\n    element = el;\n    values = el.__values__;\n\n    // apply aria-specific properties\n    ariaItemAttributes(emit, item);\n\n    // apply svg attributes\n    mdef.attr(emit, item, this);\n\n    // some marks need special treatment\n    const extra = mark_extras[mdef.type];\n    if (extra) extra.call(this, mdef, el, item);\n\n    // apply svg style attributes\n    // note: element state may have been modified by 'extra' method\n    if (element) this.style(element, item);\n  },\n\n  /**\n   * Update the presentation attributes of an SVG element for a mark item.\n   * @param {SVGElement} el - The SVG element.\n   * @param {Item} item - The mark item.\n   */\n  style(el, item) {\n    if (item == null) return;\n\n    for (const prop in stylesAttr) {\n      let value = prop === 'font' ? fontFamily(item) : item[prop];\n      if (value === values[prop]) continue;\n\n      const name = stylesAttr[prop];\n      if (value == null) {\n        el.removeAttribute(name);\n      } else {\n        if (isGradient(value)) {\n          value = gradientRef(value, this._defs.gradient, href());\n        }\n        el.setAttribute(name, value + '');\n      }\n\n      values[prop] = value;\n    }\n\n    for (const prop in stylesCss) {\n      setStyle(el, stylesCss[prop], item[prop]);\n    }\n  },\n\n  /**\n   * Render SVG defs, as needed.\n   * Must be called *after* marks have been processed to ensure the\n   * collected state is current and accurate.\n   */\n  defs() {\n    const svg = this._svg,\n          defs = this._defs;\n\n    let el = defs.el,\n        index = 0;\n\n    for (const id in defs.gradient) {\n      if (!el) defs.el = (el = domChild(svg, RootIndex + 1, 'defs', svgns));\n      index = updateGradient(el, defs.gradient[id], index);\n    }\n\n    for (const id in defs.clipping) {\n      if (!el) defs.el = (el = domChild(svg, RootIndex + 1, 'defs', svgns));\n      index = updateClipping(el, defs.clipping[id], index);\n    }\n\n    // clean-up\n    if (el) {\n      index === 0\n        ? (svg.removeChild(el), defs.el = null)\n        : domClear(el, index);\n    }\n  },\n\n  /**\n   * Clear defs caches.\n   */\n  _clearDefs() {\n    const def = this._defs;\n    def.gradient = {};\n    def.clipping = {};\n  }\n});\n\n// mark ancestor chain with a dirty id\nfunction dirtyParents(item, id) {\n  for (; item && item.dirty !== id; item=item.mark.group) {\n    item.dirty = id;\n    if (item.mark && item.mark.dirty !== id) {\n      item.mark.dirty = id;\n    } else return;\n  }\n}\n\n// update gradient definitions\nfunction updateGradient(el, grad, index) {\n  let i, n, stop;\n\n  if (grad.gradient === 'radial') {\n    // SVG radial gradients automatically transform to normalized bbox\n    // coordinates, in a way that is cumbersome to replicate in canvas.\n    // We wrap the radial gradient in a pattern element, allowing us to\n    // maintain a circular gradient that matches what canvas provides.\n    let pt = domChild(el, index++, 'pattern', svgns);\n    setAttributes(pt, {\n      id: patternPrefix + grad.id,\n      viewBox: '0,0,1,1',\n      width: '100%',\n      height: '100%',\n      preserveAspectRatio: 'xMidYMid slice'\n    });\n\n    pt = domChild(pt, 0, 'rect', svgns);\n    setAttributes(pt, {\n      width: 1,\n      height: 1,\n      fill: `url(${href()}#${grad.id})`\n    });\n\n    el = domChild(el, index++, 'radialGradient', svgns);\n    setAttributes(el, {\n      id: grad.id,\n      fx: grad.x1,\n      fy: grad.y1,\n      fr: grad.r1,\n      cx: grad.x2,\n      cy: grad.y2,\n      r: grad.r2\n    });\n  } else {\n    el = domChild(el, index++, 'linearGradient', svgns);\n    setAttributes(el, {\n      id: grad.id,\n      x1: grad.x1,\n      x2: grad.x2,\n      y1: grad.y1,\n      y2: grad.y2\n    });\n  }\n\n  for (i=0, n=grad.stops.length; i<n; ++i) {\n    stop = domChild(el, i, 'stop', svgns);\n    stop.setAttribute('offset', grad.stops[i].offset);\n    stop.setAttribute('stop-color', grad.stops[i].color);\n  }\n  domClear(el, i);\n\n  return index;\n}\n\n// update clipping path definitions\nfunction updateClipping(el, clip, index) {\n  let mask;\n\n  el = domChild(el, index, 'clipPath', svgns);\n  el.setAttribute('id', clip.id);\n\n  if (clip.path) {\n    mask = domChild(el, 0, 'path', svgns);\n    mask.setAttribute('d', clip.path);\n  } else {\n    mask = domChild(el, 0, 'rect', svgns);\n    setAttributes(mask, {x: 0, y: 0, width: clip.width, height: clip.height});\n  }\n  domClear(el, 1);\n\n  return index + 1;\n}\n\n// Recursively process group contents.\nfunction recurse(renderer, el, group) {\n  // child 'g' element is second to last among children (path, g, path)\n  // other children here are foreground and background path elements\n  el = el.lastChild.previousSibling;\n  let prev, idx = 0;\n\n  visit(group, item => {\n    prev = renderer.mark(el, item, prev);\n    ++idx;\n  });\n\n  // remove any extraneous DOM elements\n  domClear(el, 1 + idx);\n}\n\n// Bind a scenegraph item to an SVG DOM element.\n// Create new SVG elements as needed.\nfunction bind(item, el, sibling, tag, svg) {\n  let node = item._svg, doc;\n\n  // create a new dom node if needed\n  if (!node) {\n    doc = el.ownerDocument;\n    node = domCreate(doc, tag, svgns);\n    item._svg = node;\n\n    if (item.mark) {\n      node.__data__ = item;\n      node.__values__ = {fill: 'default'};\n\n      // if group, create background, content, and foreground elements\n      if (tag === 'g') {\n        const bg = domCreate(doc, 'path', svgns);\n        node.appendChild(bg);\n        bg.__data__ = item;\n\n        const cg = domCreate(doc, 'g', svgns);\n        node.appendChild(cg);\n        cg.__data__ = item;\n\n        const fg = domCreate(doc, 'path', svgns);\n        node.appendChild(fg);\n        fg.__data__ = item;\n        fg.__values__ = {fill: 'default'};\n      }\n    }\n  }\n\n  // (re-)insert if (a) not contained in SVG or (b) sibling order has changed\n  if (node.ownerSVGElement !== svg || siblingCheck(node, sibling)) {\n    el.insertBefore(node, sibling ? sibling.nextSibling : el.firstChild);\n  }\n\n  return node;\n}\n\n// check if two nodes are ordered siblings\nfunction siblingCheck(node, sibling) {\n  return node.parentNode\n    && node.parentNode.childNodes.length > 1\n    && node.previousSibling != sibling; // treat null/undefined the same\n}\n\n// -- Set attributes & styles on SVG elements ---\n\nlet element = null, // temp var for current SVG element\n    values = null;  // temp var for current values hash\n\n// Extra configuration for certain mark types\nconst mark_extras = {\n  group(mdef, el, item) {\n    const fg = element = el.childNodes[2];\n    values = fg.__values__;\n    mdef.foreground(emit, item, this);\n\n    values = el.__values__; // use parent's values hash\n    element = el.childNodes[1];\n    mdef.content(emit, item, this);\n\n    const bg = element = el.childNodes[0];\n    mdef.background(emit, item, this);\n\n    const value = item.mark.interactive === false ? 'none' : null;\n    if (value !== values.events) {\n      setAttribute(fg, 'pointer-events', value);\n      setAttribute(bg, 'pointer-events', value);\n      values.events = value;\n    }\n\n    if (item.strokeForeground && item.stroke) {\n      const fill = item.fill;\n      setAttribute(fg, 'display', null);\n\n      // set style of background\n      this.style(bg, item);\n      setAttribute(bg, 'stroke', null);\n\n      // set style of foreground\n      if (fill) item.fill = null;\n      values = fg.__values__;\n      this.style(fg, item);\n      if (fill) item.fill = fill;\n\n      // leave element null to prevent downstream styling\n      element = null;\n    } else {\n      // ensure foreground is ignored\n      setAttribute(fg, 'display', 'none');\n    }\n  },\n  image(mdef, el, item) {\n    if (item.smooth === false) {\n      setStyle(el, 'image-rendering', 'optimizeSpeed');\n      setStyle(el, 'image-rendering', 'pixelated');\n    } else {\n      setStyle(el, 'image-rendering', null);\n    }\n  },\n  text(mdef, el, item) {\n    const tl = textLines(item);\n    let key, value, doc, lh;\n\n    if (isArray(tl)) {\n      // multi-line text\n      value = tl.map(_ => textValue(item, _));\n      key = value.join('\\n'); // content cache key\n\n      if (key !== values.text) {\n        domClear(el, 0);\n        doc = el.ownerDocument;\n        lh = lineHeight(item);\n        value.forEach((t, i) => {\n          const ts = domCreate(doc, 'tspan', svgns);\n          ts.__data__ = item; // data binding\n          ts.textContent = t;\n          if (i) {\n            ts.setAttribute('x', 0);\n            ts.setAttribute('dy', lh);\n          }\n          el.appendChild(ts);\n        });\n        values.text = key;\n      }\n    } else {\n      // single-line text\n      value = textValue(item, tl);\n      if (value !== values.text) {\n        el.textContent = value;\n        values.text = value;\n      }\n    }\n\n    setAttribute(el, 'font-family', fontFamily(item));\n    setAttribute(el, 'font-size', fontSize(item) + 'px');\n    setAttribute(el, 'font-style', item.fontStyle);\n    setAttribute(el, 'font-variant', item.fontVariant);\n    setAttribute(el, 'font-weight', item.fontWeight);\n  }\n};\n\nfunction emit(name, value, ns) {\n  // early exit if value is unchanged\n  if (value === values[name]) return;\n\n  // use appropriate method given namespace (ns)\n  if (ns) {\n    setAttributeNS(element, name, value, ns);\n  } else {\n    setAttribute(element, name, value);\n  }\n\n  // note current value for future comparison\n  values[name] = value;\n}\n\nfunction setStyle(el, name, value) {\n  if (value !== values[name]) {\n    if (value == null) {\n      el.style.removeProperty(name);\n    } else {\n      el.style.setProperty(name, value + '');\n    }\n    values[name] = value;\n  }\n}\n\nfunction setAttributes(el, attrs) {\n  for (const key in attrs) {\n    setAttribute(el, key, attrs[key]);\n  }\n}\n\nfunction setAttribute(el, name, value) {\n  if (value != null) {\n    // if value is provided, update DOM attribute\n    el.setAttribute(name, value);\n  } else {\n    // else remove DOM attribute\n    el.removeAttribute(name);\n  }\n}\n\nfunction setAttributeNS(el, name, value, ns) {\n  if (value != null) {\n    // if value is provided, update DOM attribute\n    el.setAttributeNS(ns, name, value);\n  } else {\n    // else remove DOM attribute\n    el.removeAttributeNS(ns, name);\n  }\n}\n\nfunction href() {\n  let loc;\n  return typeof window === 'undefined' ? ''\n    : (loc = window.location).hash ? loc.href.slice(0, -loc.hash.length)\n    : loc.href;\n}\n","import Renderer from './Renderer';\nimport {gradientRef, isGradient, patternPrefix} from './Gradient';\nimport Marks from './marks/index';\nimport {ariaItemAttributes, ariaMarkAttributes} from './util/aria';\nimport {cssClass} from './util/dom';\nimport {markup} from './util/markup';\nimport {fontFamily, fontSize, lineHeight, textLines, textValue} from './util/text';\nimport {visit} from './util/visit';\nimport clip from './util/svg/clip';\nimport metadata from './util/svg/metadata';\nimport {rootAttributes, stylesAttr, stylesCss} from './util/svg/styles';\nimport {extend, inherits, isArray} from 'vega-util';\n\nexport default function SVGStringRenderer(loader) {\n  Renderer.call(this, loader);\n  this._text = null;\n  this._defs = {\n    gradient: {},\n    clipping: {}\n  };\n}\n\ninherits(SVGStringRenderer, Renderer, {\n  /**\n   * Returns the rendered SVG text string,\n   * or null if rendering has not yet occurred.\n   */\n  svg() {\n    return this._text;\n  },\n\n  /**\n   * Internal rendering method.\n   * @param {object} scene - The root mark of a scenegraph to render.\n   */\n  _render(scene) {\n    const m = markup();\n\n    // svg tag\n    m.open('svg', extend({}, metadata, {\n      class:   'marks',\n      width:   this._width * this._scale,\n      height:  this._height * this._scale,\n      viewBox: `0 0 ${this._width} ${this._height}`\n    }));\n\n    // background, if defined\n    const bg = this._bgcolor;\n    if (bg && bg !== 'transparent' && bg !== 'none') {\n      m.open('rect', {\n        width:  this._width,\n        height: this._height,\n        fill:   bg\n      }).close();\n    }\n\n    // root content group\n    m.open('g', rootAttributes, {\n      transform: 'translate(' + this._origin + ')'\n    });\n    this.mark(m, scene);\n    m.close(); // </g>\n\n    // defs\n    this.defs(m);\n\n    // get SVG text string\n    this._text = m.close() + '';\n\n    return this;\n  },\n\n  /**\n   * Render a set of mark items.\n   * @param {object} m - The markup context.\n   * @param {object} scene - The mark parent to render.\n   */\n  mark(m, scene) {\n    const mdef = Marks[scene.marktype],\n          tag  = mdef.tag,\n          attrList = [ariaItemAttributes, mdef.attr];\n\n    // render opening group tag\n    m.open('g',\n      {\n        'class': cssClass(scene),\n        'clip-path': scene.clip ? clip(this, scene, scene.group) : null\n      },\n      ariaMarkAttributes(scene),\n      {\n        'pointer-events': tag !== 'g' && scene.interactive === false ? 'none' : null\n      }\n    );\n\n    // render contained elements\n    const process = item => {\n      const href = this.href(item);\n      if (href) m.open('a', href);\n\n      m.open(\n        tag,\n        this.attr(scene, item, attrList, tag !== 'g' ? tag : null)\n      );\n\n      if (tag === 'text') {\n        const tl = textLines(item);\n        if (isArray(tl)) {\n          // multi-line text\n          const attrs = {x: 0, dy: lineHeight(item)};\n          for (let i=0; i<tl.length; ++i) {\n            m.open('tspan', i ? attrs: null)\n              .text(textValue(item, tl[i]))\n              .close();\n          }\n        } else {\n          // single-line text\n          m.text(textValue(item, tl));\n        }\n      } else if (tag === 'g') {\n        const fore = item.strokeForeground,\n              fill = item.fill,\n              stroke = item.stroke;\n\n        if (fore && stroke) {\n          item.stroke = null;\n        }\n\n        m.open(\n          'path',\n          this.attr(scene, item, mdef.background, 'bgrect')\n        ).close();\n\n        // recurse for group content\n        m.open('g', this.attr(scene, item, mdef.content));\n        visit(item, scene => this.mark(m, scene));\n        m.close();\n\n        if (fore && stroke) {\n          if (fill) item.fill = null;\n          item.stroke = stroke;\n\n          m.open(\n            'path',\n            this.attr(scene, item, mdef.foreground, 'bgrect')\n          ).close();\n\n          if (fill) item.fill = fill;\n        } else {\n          m.open(\n            'path',\n            this.attr(scene, item, mdef.foreground, 'bgfore')\n          ).close();\n        }\n      }\n\n      m.close(); // </tag>\n      if (href) m.close(); // </a>\n    };\n\n    if (mdef.nested) {\n      if (scene.items && scene.items.length) process(scene.items[0]);\n    } else {\n      visit(scene, process);\n    }\n\n    // render closing group tag\n    return m.close(); // </g>\n  },\n\n  /**\n   * Get href attributes for a hyperlinked mark item.\n   * @param {Item} item - The mark item.\n   */\n  href(item) {\n    const href = item.href;\n    let attr;\n\n    if (href) {\n      if (attr = this._hrefs && this._hrefs[href]) {\n        return attr;\n      } else {\n        this.sanitizeURL(href).then(attr => {\n          // rewrite to use xlink namespace\n          attr['xlink:href'] = attr.href;\n          attr.href = null;\n          (this._hrefs || (this._hrefs = {}))[href] = attr;\n        });\n      }\n    }\n    return null;\n  },\n\n  /**\n   * Get an object of SVG attributes for a mark item.\n   * @param {object} scene - The mark parent.\n   * @param {Item} item - The mark item.\n   * @param {array|function} attrs - One or more attribute emitters.\n   * @param {string} tag - The tag being rendered.\n   */\n  attr(scene, item, attrs, tag) {\n    const object = {},\n          emit = (name, value, ns, prefixed) => {\n            object[prefixed || name] = value;\n          };\n\n    // apply mark specific attributes\n    if (Array.isArray(attrs)) {\n      attrs.forEach(fn => fn(emit, item, this));\n    } else {\n      attrs(emit, item, this);\n    }\n\n    // apply style attributes\n    if (tag) {\n      style(object, item, scene, tag, this._defs);\n    }\n\n    return object;\n  },\n\n  /**\n   * Render SVG defs, as needed.\n   * Must be called *after* marks have been processed to ensure the\n   * collected state is current and accurate.\n   * @param {object} m - The markup context.\n   */\n  defs(m) {\n    const gradient = this._defs.gradient,\n          clipping = this._defs.clipping,\n          count = Object.keys(gradient).length + Object.keys(clipping).length;\n\n    if (count === 0) return; // nothing to do\n\n    m.open('defs');\n\n    for (const id in gradient) {\n      const def = gradient[id],\n            stops = def.stops;\n\n      if (def.gradient === 'radial') {\n        // SVG radial gradients automatically transform to normalized bbox\n        // coordinates, in a way that is cumbersome to replicate in canvas.\n        // We wrap the radial gradient in a pattern element, allowing us to\n        // maintain a circular gradient that matches what canvas provides.\n\n        m.open('pattern', {\n          id: patternPrefix + id,\n          viewBox: '0,0,1,1',\n          width: '100%',\n          height: '100%',\n          preserveAspectRatio: 'xMidYMid slice'\n        });\n\n        m.open('rect', {\n          width:  '1',\n          height: '1',\n          fill:   'url(#' + id + ')'\n        }).close();\n\n        m.close(); // </pattern>\n\n        m.open('radialGradient', {\n          id: id,\n          fx: def.x1,\n          fy: def.y1,\n          fr: def.r1,\n          cx: def.x2,\n          cy: def.y2,\n          r: def.r2\n        });\n      } else {\n        m.open('linearGradient', {\n          id: id,\n          x1: def.x1,\n          x2: def.x2,\n          y1: def.y1,\n          y2: def.y2\n        });\n      }\n\n      for (let i = 0; i < stops.length; ++i) {\n        m.open('stop', {\n          offset: stops[i].offset,\n          'stop-color': stops[i].color\n        }).close();\n      }\n\n      m.close();\n    }\n\n    for (const id in clipping) {\n      const def = clipping[id];\n\n      m.open('clipPath', {id: id});\n      if (def.path) {\n        m.open('path', {\n          d: def.path\n        }).close();\n      } else {\n        m.open('rect', {\n          x: 0,\n          y: 0,\n          width: def.width,\n          height: def.height\n        }).close();\n      }\n      m.close();\n    }\n\n    m.close();\n  }\n});\n\n// Helper function for attr for style presentation attributes\nfunction style(s, item, scene, tag, defs) {\n  let styleList;\n  if (item == null) return s;\n\n  if (tag === 'bgrect' && scene.interactive === false) {\n    s['pointer-events'] = 'none';\n  }\n\n  if (tag === 'bgfore') {\n    if (scene.interactive === false) {\n      s['pointer-events'] = 'none';\n    }\n    s.display = 'none';\n    if (item.fill !== null) return s;\n  }\n\n  if (tag === 'image' && item.smooth === false) {\n    styleList = [\n      'image-rendering: optimizeSpeed;',\n      'image-rendering: pixelated;'\n    ];\n  }\n\n  if (tag === 'text') {\n    s['font-family'] = fontFamily(item);\n    s['font-size'] = fontSize(item) + 'px';\n    s['font-style'] = item.fontStyle;\n    s['font-variant'] = item.fontVariant;\n    s['font-weight'] = item.fontWeight;\n  }\n\n  for (const prop in stylesAttr) {\n    let value = item[prop];\n    const name = stylesAttr[prop];\n\n    if (value === 'transparent' && (name === 'fill' || name === 'stroke')) {\n      // transparent is not a legal SVG value\n      // we can skip it to rely on default 'none' instead\n    } else if (value != null) {\n      if (isGradient(value)) {\n        value = gradientRef(value, defs.gradient, '');\n      }\n      s[name] = value;\n    }\n  }\n\n  for (const prop in stylesCss) {\n    const value = item[prop];\n    if (value != null) {\n      styleList = styleList || [];\n      styleList.push(`${stylesCss[prop]}: ${value};`);\n    }\n  }\n  if (styleList) {\n    s.style = styleList.join(' ');\n  }\n\n  return s;\n}\n","import CanvasHandler from './CanvasHandler';\nimport CanvasRenderer from './CanvasRenderer';\nimport SVGHandler from './SVGHandler';\nimport SVGRenderer from './SVGRenderer';\nimport SVGStringRenderer from './SVGStringRenderer';\n\nconst Canvas = 'canvas';\nconst PNG = 'png';\nconst SVG = 'svg';\nconst None = 'none';\n\nexport const RenderType = {\n  Canvas: Canvas,\n  PNG:    PNG,\n  SVG:    SVG,\n  None:   None\n};\n\nconst modules = {};\n\nmodules[Canvas] = modules[PNG] = {\n  renderer: CanvasRenderer,\n  headless: CanvasRenderer,\n  handler:  CanvasHandler\n};\n\nmodules[SVG] = {\n  renderer: SVGRenderer,\n  headless: SVGStringRenderer,\n  handler:  SVGHandler\n};\n\nmodules[None] = {};\n\nexport function renderModule(name, _) {\n  name = String(name || '').toLowerCase();\n  if (arguments.length > 1) {\n    modules[name] = _;\n    return this;\n  } else {\n    return modules[name];\n  }\n}\n","import Marks from './marks/index';\nimport {error} from 'vega-util';\nimport Bounds from './Bounds';\n\nexport function intersect(scene, bounds, filter) {\n  const hits = [], // intersection results\n        box = new Bounds().union(bounds), // defensive copy\n        type = scene.marktype;\n\n  return type ? intersectMark(scene, box, filter, hits)\n    : type === 'group' ? intersectGroup(scene, box, filter, hits)\n    : error('Intersect scene must be mark node or group item.');\n}\n\nfunction intersectMark(mark, box, filter, hits) {\n  if (visitMark(mark, box, filter)) {\n    const items = mark.items,\n          type = mark.marktype,\n          n = items.length;\n\n    let i = 0;\n\n    if (type === 'group') {\n      for (; i<n; ++i) {\n        intersectGroup(items[i], box, filter, hits);\n      }\n    } else {\n      for (const test = Marks[type].isect; i<n; ++i) {\n        const item = items[i];\n        if (intersectItem(item, box, test)) hits.push(item);\n      }\n    }\n  }\n  return hits;\n}\n\nfunction visitMark(mark, box, filter) {\n  // process if bounds intersect and if\n  // (1) mark is a group mark (so we must recurse), or\n  // (2) mark is interactive and passes filter\n  return mark.bounds && box.intersects(mark.bounds) && (\n    mark.marktype === 'group' ||\n    mark.interactive !== false && (!filter || filter(mark))\n  );\n}\n\nfunction intersectGroup(group, box, filter, hits) {\n  // test intersect against group\n  // skip groups by default unless filter says otherwise\n  if ((filter && filter(group.mark)) &&\n      intersectItem(group, box, Marks.group.isect)) {\n    hits.push(group);\n  }\n\n  // recursively test children marks\n  // translate box to group coordinate space\n  const marks = group.items,\n        n = marks && marks.length;\n\n  if (n) {\n    const x = group.x || 0,\n          y = group.y || 0;\n    box.translate(-x, -y);\n    for (let i=0; i<n; ++i) {\n      intersectMark(marks[i], box, filter, hits);\n    }\n    box.translate(x, y);\n  }\n\n  return hits;\n}\n\nfunction intersectItem(item, box, test) {\n  // test bounds enclosure, bounds intersection, then detailed test\n  const bounds = item.bounds;\n  return box.encloses(bounds) || (box.intersects(bounds) && test(item, box));\n}\n\n","import Bounds from '../Bounds';\nimport boundContext from './boundContext';\nimport {isFunction} from 'vega-util';\n\nconst clipBounds = new Bounds();\n\nexport default function(mark) {\n  const clip = mark.clip;\n\n  if (isFunction(clip)) {\n    clip(boundContext(clipBounds.clear()));\n  } else if (clip) {\n    clipBounds.set(0, 0, mark.group.width, mark.group.height);\n  } else return;\n\n  mark.bounds.intersect(clipBounds);\n}\n","import pathParse from '../path/parse';\nimport {isNumber, isObject} from 'vega-util';\n\nconst TOLERANCE = 1e-9;\n\nexport function sceneEqual(a, b, key) {\n  return (a === b) ? true\n    : (key === 'path') ? pathEqual(a, b)\n    : (a instanceof Date && b instanceof Date) ? +a === +b\n    : (isNumber(a) && isNumber(b)) ? Math.abs(a - b) <= TOLERANCE\n    : (!a || !b || !isObject(a) && !isObject(b)) ? a == b\n    : objectEqual(a, b);\n}\n\nexport function pathEqual(a, b) {\n  return sceneEqual(pathParse(a), pathParse(b));\n}\n\nfunction objectEqual(a, b) {\n  var ka = Object.keys(a),\n      kb = Object.keys(b),\n      key, i;\n\n  if (ka.length !== kb.length) return false;\n\n  ka.sort();\n  kb.sort();\n\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i]) return false;\n  }\n\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!sceneEqual(a[key], b[key], key)) return false;\n  }\n\n  return typeof a === typeof b;\n}\n","import {resetSVGGradientId} from './src/Gradient';\nimport {resetSVGClipId} from './src/util/svg/clip';\n\nexport {default as Bounds} from './src/Bounds';\nexport {default as Gradient} from './src/Gradient';\nexport {default as GroupItem} from './src/GroupItem';\nexport {default as ResourceLoader} from './src/ResourceLoader';\nexport {default as Item} from './src/Item';\nexport {default as Scenegraph} from './src/Scenegraph';\n\nexport {default as Handler} from './src/Handler';\nexport {default as Renderer} from './src/Renderer';\nexport {default as CanvasHandler} from './src/CanvasHandler';\nexport {default as CanvasRenderer} from './src/CanvasRenderer';\nexport {default as SVGHandler} from './src/SVGHandler';\nexport {default as SVGRenderer} from './src/SVGRenderer';\nexport {default as SVGStringRenderer} from './src/SVGStringRenderer';\nexport {RenderType, renderModule} from './src/modules';\nexport {intersect} from './src/intersect';\n\nexport {default as Marks} from './src/marks/index';\n\nexport {default as boundClip} from './src/bound/boundClip';\nexport {default as boundContext} from './src/bound/boundContext';\nexport {default as boundStroke} from './src/bound/boundStroke';\nexport {default as boundItem} from './src/bound/boundItem';\nexport {default as boundMark} from './src/bound/boundMark';\n\nexport {default as pathCurves} from './src/path/curves';\nexport {default as pathSymbols} from './src/path/symbols';\nexport {default as pathRectangle} from './src/path/rectangle';\nexport {default as pathTrail} from './src/path/trail';\nexport {default as pathParse} from './src/path/parse';\nexport {default as pathRender} from './src/path/render';\n\nexport {default as point} from './src/util/point';\nexport {domCreate, domFind, domChild, domClear} from './src/util/dom';\nexport {markup, serializeXML} from './src/util/markup';\nexport {\n  font,\n  fontFamily,\n  fontSize,\n  lineHeight,\n  multiLineOffset,\n  textMetrics\n} from './src/util/text';\n\nexport {sceneEqual, pathEqual} from './src/util/equal';\nexport {sceneToJSON, sceneFromJSON} from './src/util/serialize';\nexport {\n  intersectPath,\n  intersectPoint,\n  intersectRule,\n  intersectBoxLine\n} from './src/util/intersect';\nexport {\n  zorder as sceneZOrder,\n  visit as sceneVisit,\n  pickVisit as scenePickVisit\n} from './src/util/visit';\n\n// for testing purposes\nexport {path} from 'd3-path';\n\n// deprecated, remove in next major version\nexport {resetSVGClipId} from './src/util/svg/clip';\n\nexport function resetSVGDefIds() {\n  resetSVGClipId();\n  resetSVGGradientId();\n}\n"],"names":["gradient_id","patternPrefix","isGradient","value","gradient","gradientRef","g","defs","base","type","id","prefix","x1","get","y1","r1","x2","y2","r2","val","def","pi","Math","PI","tau","epsilon","tauEpsilon","Path","this","_x0","_y0","_x1","_y1","_","path","constant","x","prototype","constructor","moveTo","y","closePath","lineTo","quadraticCurveTo","bezierCurveTo","arcTo","r","x0","y0","x21","y21","x01","y01","l01_2","Error","abs","x20","y20","l21_2","l20_2","l21","sqrt","l01","l","tan","acos","t01","t21","arc","a0","a1","ccw","dx","cos","dy","sin","cw","da","rect","w","h","toString","atan2","max","min","halfPi","asin","arcInnerRadius","d","innerRadius","arcOuterRadius","outerRadius","arcStartAngle","startAngle","arcEndAngle","endAngle","arcPadAngle","padAngle","intersect","x3","y3","x10","y10","x32","y32","t","cornerTangents","rc","lo","ox","oy","x11","y11","x00","y00","d2","D","cx0","cy0","cx1","cy1","dx0","dy0","dx1","dy1","cx","cy","array","Array","from","Linear","context","_context","curveLinear","p","d3_line","defined","curve","output","line","data","i","buffer","n","length","defined0","lineStart","lineEnd","point","undefined","pointX","pointY","arguments","d3_area","area","j","k","x0z","y0z","areaStart","areaEnd","arealine","lineX0","lineY0","lineY1","lineX1","_line","NaN","_point","circle","draw","size","noop","that","Basis","BasisClosed","BasisOpen","Bundle","beta","_basis","_beta","_x2","_x3","_x4","_y2","_y3","_y4","_x","_y","push","curveBundle","custom","bundle","_k","Cardinal","tension","curveCardinal","cardinal","CardinalClosed","_x5","_y5","curveCardinalClosed","CardinalOpen","curveCardinalOpen","_l01_a","a","_l01_2a","_l12_a","_l12_2a","_l23_a","b","_l23_2a","m","CatmullRom","alpha","_alpha","x23","y23","pow","curveCatmullRom","catmullRom","CatmullRomClosed","curveCatmullRomClosed","CatmullRomOpen","curveCatmullRomOpen","LinearClosed","sign","slope3","h0","h1","s0","s1","slope2","t0","t1","MonotoneX","MonotoneY","ReflectContext","Natural","controlPoints","Step","_t","_t0","Object","create","call","px","py","i0","i1","lookup","basis","linear","monotone","horizontal","vertical","natural","step","curves","orientation","entry","hasOwnProperty","paramCounts","v","z","c","s","q","commandPattern","numberPattern","spacePattern","flagPattern","parse","commands","match","forEach","str","cmd","toLowerCase","paramCount","params","segment","index","pattern","slice","ws","parseParams","trim","count","DegToRad","HalfPi","Tau","HalfSqrt3","segmentCache","bezierCache","join","bezier","key","th0","th1","rx","ry","sin_th","cos_th","a00","a01","a10","a11","cos_th0","sin_th0","cos_th1","sin_th1","th_half","sin_th_h2","temp","scale","current","sX","sY","pathRender","tempX","tempY","tempControlX","tempControlY","previous","controlX","controlY","anchorX","anchorY","beginPath","len","drawArc","coords","seg","large","sweep","rotateX","th","pl","sfactor_sq","sfactor","xc","yc","th_arc","segs","ceil","result","th2","th3","segments","bez","Tan30","builtins","cross","diamond","square","arrow","wedge","o","triangle","stroke","symbols","parsed","pathParse","customSymbol","C","rectangleX","rectangleY","rectangleWidth","width","rectangleHeight","height","number","clamp","vg_rect","crTL","crTR","crBL","crBR","rectangle","tl","tr","bl","br","cornerRadius","vg_trail","ready","w2","ux","uy","ud","trail","item","arcShape","padRadius","r0","apply","da0","da1","ap","rp","rc0","rc1","p0","p1","oc","ax","ay","bx","by","kc","lc","centroid","d3_arc","areavShape","areahShape","lineShape","rectShape","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomRight","cornerRadiusBottomLeft","symbolShape","symbol","d3_symbol","shape","trailShape","hasCornerRadius","clip_id","resetSVGClipId","clip$1","renderer","clip","_defs","clipping","isFunction","Bounds","clear","union","Item","mark","bounds","GroupItem","items","ResourceLoader","customLoader","_pending","_loader","loader","increment","decrement","boundStroke","miter","opacity","strokeOpacity","sw","strokeWidth","expand","strokeJoin","miterAdjustment","clone","Number","MAX_VALUE","empty","equals","set","add","round","floor","translate","rotate","angle","rotatedPoints","encloses","alignsWith","intersects","contains","inherits","pending","sanitizeURL","uri","sanitize","then","opt","catch","loadImage","Image","image","url","href","img","cors","crossOrigin","onload","onerror","src","e","complete","Promise","accept","poll","setTimeout","circleThreshold","lx","ly","rot","ma","mb","mc","md","addL","addX","addY","addp","addpL","boundContext","deg","px1","py1","px2","py2","quadExtrema","px3","py3","cubicExtrema","sa","ea","update","cb","cubic","s2","t2","canvas","getContext","intersectPath","brush","isPointInPath","intersectPoint","box","intersectRect","intersectRule","intersectBoxLine","u","blend","globalCompositeOperation","dflt","addStops","stops","addColorStop","offset","color","spec","createRadialGradient","ictx","fillStyle","createLinearGradient","fillRect","createPattern","fill","fillOpacity","globalAlpha","Empty","lw","strokeStyle","lineWidth","lineCap","strokeCap","lineJoin","miterLimit","strokeMiterLimit","setLineDash","strokeDash","lineDashOffset","strokeDashOffset","compare","zindex","zorder","scene","zdirty","zitems","sort","visit","visitor","pickVisit","hit","drawAll","drawPath","drawOne","pick","test","truthy","gx","gy","pixelRatio","hitPath","filled","isArray","isPointInStroke","pickPath","translateItem","markItemPath","isect","tag","nested","attr","emit","rotateItem","bound","markMultiItemPath","tip","interp","interpolate","orient","Infinity","clipGroup","group","strokeOffset","emitRectangle","off","rectanglePath","hitBackground","hitForeground","hitCorner","noBound","fore","strokeForeground","save","restore","dw","dh","ix","interactive","marktype","pickMark","content","background","foreground","metadata","xmlns","version","getImage","imageWidth","aspect","imageHeight","imageXOffset","align","imageYOffset","baseline","toDataURL","ar0","ar1","imageSmoothingEnabled","smooth","drawImage","xOffset","yOffset","sx","scaleX","sy","scaleY","cache","pathCache","path$2","transformItem","rule","widthCache","lruCache","textMetrics","fontSize","measureWidth","estimateWidth","useCanvas","use","text","_estimateWidth","textValue","currentFontHeight","_measureWidth","font","currentFont","concat","measureText","lineHeight","textLines","lineBreak","split","limit","widthGetter","mid","ellipsis","rtl","dir","hi","truncate","fontFamily","quote","String","replace","fontStyle","fontVariant","fontWeight","textAlign","left","center","right","tempBounds","anchorPoint","radius","theta","mode","reduce","lh","fillText","strokeText","Marks","boundItem","func","marks","DUMMY","boundMark","hasItems","keys","sceneToJSON","indent","JSON","stringify","sceneFromJSON","json","initialize","parent","Scenegraph","root","createMark","name","role","aria","description","domCreate","doc","ns","document","createElement","createElementNS","domFind","el","nodes","childNodes","tagName","domChild","ownerDocument","insertBefore","domClear","curr","removeChild","cssClass","event","getBoundingClientRect","clientX","clientLeft","clientY","top","clientTop","Handler","customTooltip","_active","_handlers","_tooltip","defaultTooltip","handler","element","setAttribute","Renderer","_el","_bgcolor","toJSON","markdef","origin","obj","_obj","firstChild","_origin","_scene","on","_handlerIndex","handlers","eventName","indexOf","handleHref","MouseEvent","dispatchEvent","handleTooltip","show","tooltip","mdef","resolveItem","getItemBoundingClientRect","bottom","scaleFactor","resize","bgcolor","_width","_height","_scale","dirty","render","_call","_render","renderAsync","_ready","resolve","_load","method","redraw","DragEnterEvent","DragLeaveEvent","DragOverEvent","MouseDownEvent","MouseMoveEvent","MouseOutEvent","MouseOverEvent","ClickEvent","MouseWheelEvent","TouchStartEvent","TouchMoveEvent","TouchEndEvent","Events","TooltipShowEvent","TooltipHideEvent","HrefEvent","CanvasHandler","_down","_touch","_first","_events","eventListenerCheck","eventBundle","addEventListener","evt","fire","move","moveEvent","overEvent","outEvent","pickEvent","exit","inactive","_canvas","events","DOMMouseScroll","mousemove","dragover","mouseout","dragleave","mousedown","click","touchstart","changedTouches","touchmove","touchend","touch","vegaType","splice","window","devicePixelRatio","CanvasRenderer","_options","_redraw","_dirty","_tempb","SVGHandler","_hrefHandler","listener","_tooltipHandler","options","externalContext","appendChild","inDOM","HTMLElement","parentNode","ratio","style","setTransform","ctx","error","db","vb","clipToBounds","clearRect","target","__data__","svg","_svg","removeEventListener","ARIA_HIDDEN","ARIA_LABEL","ARIA_ROLE","ARIA_ROLEDESCRIPTION","GRAPHICS_OBJECT","GRAPHICS_SYMBOL","roledesc","label","AriaIgnore","toSet","AriaGuides","axis","desc","caption","datum","title","extractTitle","scales","locale","dataflow","isDiscrete","domainCaption","legend","props","capitalize","toUpperCase","channelCaption","map","peek","titleCaption","AriaEncode","ariaRole","ariaRoleDescription","ariaItemAttributes","hide","prop","ariaMarkAttributes","err","ariaGuide","recurse","some","ariaMark","innerText","markup","buf","outer","inner","stack","open","_len","attrs","_key","close","pop","serializeXML","node","_serialize","hasAttributes","attributes","hasChildNodes","children","child","nodeType","nodeValue","stylesAttr","stylesCss","rootAttributes","svgns","SVGRenderer","_dirtyID","_root","dirtyParents","updateGradient","grad","stop","pt","setAttributes","viewBox","preserveAspectRatio","fx","fy","fr","updateClipping","mask","bind","sibling","__values__","bg","cg","fg","ownerSVGElement","previousSibling","siblingCheck","nextSibling","_clearDefs","setAttributeNS","RootIndex","setProperty","removeAttribute","_dirtyCheck","_dirtyAll","isDirty","_update","prev","isGroup","process","lastChild","idx","values","extra","mark_extras","setStyle","ts","textContent","removeAttributeNS","removeProperty","loc","location","hash","SVGStringRenderer","_text","extend","class","transform","attrList","_hrefs","object","prefixed","fn","styleList","display","Canvas","None","RenderType","PNG","SVG","modules","intersectMark","filter","hits","visitMark","intersectGroup","intersectItem","headless","clipBounds","sceneEqual","pathEqual","Date","isNumber","isObject","ka","kb","objectEqual"],"mappings":"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"}